{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@amplitude/analytics-connector/dist/analytics-connector.esm.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js","webpack:///./node_modules/tslib/tslib.es6.js","webpack:///./node_modules/@amplitude/analytics-types/lib/esm/logger.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/debug.js","webpack:///./node_modules/@amplitude/analytics-types/lib/esm/status.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/return-wrapper.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/messages.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/constants.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/result-builder.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/logger.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/config.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/plugins/destination.js","webpack:///./node_modules/@amplitude/analytics-types/lib/esm/event.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/chunk.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/valid-properties.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/browser-client-factory.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/identify.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/revenue.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/utils/event-builder.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/timeline.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/core-client.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/analytics-connector.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/plugins/identity.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/default-tracking.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/utils/snippet-helper.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/language.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/plugins/context.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/version.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/storage/memory.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/cookie-name.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/query-params.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/storage/cookie.js","webpack:///./node_modules/@amplitude/analytics-core/lib/esm/transports/base.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/transports/fetch.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/storage/browser-storage.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/storage/local-storage.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/storage/session-storage.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/transports/xhr.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/transports/send-beacon.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/cookie-migration/index.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/constants.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/config.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/constants.js","webpack:///./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/campaign-parser.js","webpack:///./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/helpers.js","webpack:///./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/web-attribution.js","webpack:///./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/utils.js","webpack:///./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/page-view-tracking.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/plugins/form-interaction-tracking.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/plugins/file-download-tracking.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/det-notification.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/browser-client.js","webpack:///./node_modules/@amplitude/analytics-browser/lib/esm/index.js","webpack:///./resources/js/analytics/Amplitude.js","webpack:///./resources/js/analytics/Tracker.js","webpack:///./resources/js/analytics/analytics-instrumentation.js","webpack:///./resources/js/analytics/Analytics.js","webpack:///(webpack)/buildin/global.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ApplicationContextProviderImpl","getApplicationContext","versionName","this","language","getLanguage","platform","os","undefined","deviceModel","navigator","languages","EventBridgeImpl","queue","logEvent","event","receiver","length","push","setEventReceiver","forEach","__assign","assign","arguments","apply","isEqual","obj1","obj2","typeA","_i","primitive_1","isArrayA","Array","isArray","isArrayB","sorted1","keys","sort","sorted2","result_1","entries","obj","ownProps","resArray","IdentityStoreImpl","identity","userProperties","listeners","Set","editIdentity","self","actingUserProperties","actingIdentity","setUserId","userId","setDeviceId","deviceId","setUserProperties","updateUserProperties","actions","actingProperties","_a","_b","action","properties","_c","_d","_e","_f","_g","commit","setIdentity","getIdentity","originalIdentity","listener","addIdentityListener","add","removeIdentityListener","delete","safeGlobal","globalThis","global","AnalyticsConnector","identityStore","eventBridge","applicationContextProvider","getInstance","instanceName","getGlobalScope","window","extendStatics","b","setPrototypeOf","__proto__","__extends","TypeError","String","__","constructor","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","iterator","v","op","pop","__values","__read","ar","error","__spreadArray","to","from","pack","slice","concat","SuppressedError","LogLevel","Status","getStacktrace","ignoreDepth","Error","stack","split","map","text","trim","getClientLogConfig","client","config","logger","loggerProvider","logLevel","getValueByStringPath","path","e_1","replace","attr","e_1_1","return","getClientStates","paths","e_2","res","paths_1","paths_1_1","e_2_1","debugWrapper","fn","fnName","getLogConfig","getStates","fnContext","args","Debug","debugContext","type","stacktrace","time","start","Date","toISOString","states","before","promise","after","end","debug","JSON","stringify","returnWrapper","awaitable","AMPLITUDE_PREFIX","STORAGE_PREFIX","buildResult","code","message","Unknown","PREFIX","Logger","None","disable","enable","Warn","log","Verbose","console","join","warn","getDefaultConfig","flushMaxRetries","flushQueueSize","flushIntervalMillis","optOut","serverUrl","serverZone","useBatch","Config","options","_optOut","defaultConfig","apiKey","minIdLength","plan","ingestionMetadata","storageProvider","transportProvider","serverConfig","createServerConfig","set","configurable","getServerUrl","_serverZone","includes","getResponseBodyString","responseBodyString","IdentifyOperation","RevenueProperty","SpecialEventType","Destination","retryTimeout","throttleTimeout","storageKey","scheduled","setup","unsent","_this","substring","saveEvents","all","execute","catch","context","attempts","callback","timeout","addToQueue","list","tryable","filter","fulfillRequest","setTimeout","schedule","flush","useRetry","later","batches","clearTimeout","arr","size","chunkSize","Math","max","reduce","chunks","element","index","chunkIndex","floor","batch","send","payload","errorMessage","api_key","events","extra","min_id_length","handleResponse","statusCode","status","Success","handleSuccessResponse","Invalid","handleInvalidResponse","PayloadTooLarge","handlePayloadTooLargeResponse","RateLimit","handleRateLimitResponse","handleOtherResponse","missingField","startsWith","dropIndex","values","eventsWithInvalidFields","eventsWithMissingFields","eventsWithInvalidIdLengths","silencedEvents","flat","dropIndexSet","retry","has","dropUserIds","exceededDailyQuotaUsers","dropDeviceIds","exceededDailyQuotaDevices","throttledIndex","throttledEvents","dropUserIdsSet","dropDeviceIdsSet","throttledIndexSet","user_id","device_id","UUID","a","random","toString","isValidObject","isValidProperties","isValid","value_1","value_1_1","valueElement","Identify","_propertySet","_properties","getUserProperties","_safeSet","SET","setOnce","SET_ONCE","append","APPEND","prepend","PREPEND","postInsert","POSTINSERT","preInsert","PREINSERT","remove","REMOVE","ADD","unset","UNSET","clearAll","CLEAR_ALL","operation","_validate","userPropertyMap","Revenue","productId","quantity","price","setProductId","setQuantity","setPrice","setRevenueType","revenueType","setRevenue","revenue","setEventProperties","getEventProperties","eventProperties","REVENUE_PRODUCT_ID","REVENUE_QUANTITY","REVENUE_PRICE","REVENUE_TYPE","REVENUE","createIdentifyEvent","identify","eventOptions","event_type","IDENTIFY","user_properties","Timeline","applying","plugins","register","plugin","deregister","pluginName","findIndex","splice","teardown","reset","scheduleApply","shift","item","before_1","before_1_1","enrichment","enrichment_1","enrichment_1_1","destination","executeDestinations","eventClone","AmplitudeCore","initializing","q","dispatchQ","track","timeline","_init","runQueuedFunctions","queueName","queuedFunctions","queuedFunctions_1","queuedFunctions_1_1","queuedFunction","eventInput","event_properties","createTrackEvent","dispatch","groupIdentify","groupType","groupName","GROUP_IDENTIFY","group_properties","groups","createGroupIdentifyEvent","setGroup","createGroupEvent","createRevenueEvent","dispatchWithCallback","process","setOptOut","Boolean","getAnalyticsConnector","IdentityEventSender","isTrackingEnabled","defaultTracking","isAttributionTrackingEnabled","isFileDownloadTrackingEnabled","isFormInteractionTrackingEnabled","isPageViewTrackingEnabled","isSessionTrackingEnabled","getPageViewTrackingConfig","eventType","trackOn","trackHistoryChanges","pageViews","convertProxyObjectToRealObject","instance","name_1","isInstanceProxy","_q","userLanguage","Context","library","userAgent","lastEventId","nextEventId","getTime","event_id","lastEventTime","session_id","sessionId","appVersion","app_version","trackingOptions","ipAddress","ip","insert_id","partner_id","partnerId","ingestion_metadata","source_name","sourceName","source_version","sourceVersion","user_agent","MemoryStorage","memoryStorage","Map","isEnabled","getRaw","clear","getCookieName","postKey","limit","getQueryParams","globalScope","location","search","acc","curr","query","tryDecodeURIComponent","decodeURIComponent","CookieStorage","testStrorage","testKey","testValue","now","atob","parse","cookie","match","document","find","expirationDays","expires","expireDate","date","str","setTime","btoa","encodeURIComponent","toUTCString","domain","secure","sameSite","BaseTransport","_serverUrl","_payload","buildResponse","responseJSON","_h","_j","_k","_l","_m","_o","_p","_r","_s","_t","_u","_v","_w","_x","buildStatus","eventsIngested","events_ingested","payloadSizeBytes","payload_size_bytes","serverUploadTime","server_upload_time","missing_field","events_with_invalid_fields","events_with_missing_fields","events_with_invalid_id_lengths","epsThreshold","eps_threshold","exceeded_daily_quota_devices","silencedDevices","silenced_devices","silenced_events","throttledDevices","throttled_devices","throttled_events","throttledUsers","throttled_users","exceeded_daily_quota_users","Timeout","Failed","_super","FetchTransport","responsePayload","fetch","headers","Accept","method","json","BrowserStorage","storage","testStorage","getItem","setItem","removeItem","LocalStorage","localStorage","SessionStorage","sessionStorage","XHRTransport","state","XMLHttpRequest","xhr","open","onreadystatechange","readyState","responseText","parsedResponsePayload","setRequestHeader","SendBeaconTransport","sendBeacon","data","parseLegacyCookies","cookieStorage","deleteLegacyCookies","cookieName","cookies","toLowerCase","getOldCookieName","decode","parseTime","num","integer","parseInt","isNaN","escape","DEFAULT_FORM_START_EVENT","DEFAULT_FORM_SUBMIT_EVENT","DEFAULT_FILE_DOWNLOAD_EVENT","FILE_EXTENSION","FILE_NAME","LINK_ID","LINK_TEXT","LINK_URL","FORM_ID","FORM_NAME","FORM_DESTINATION","BrowserConfig","cookieOptions","identityStorage","sessionTimeout","transport","expiration","upgrade","createTransport","_cookieStorage","updateStorage","_deviceId","_userId","_sessionId","_lastEventTime","_lastEventId","cache","useBrowserConfig","amplitudeInstance","legacyCookies","previousCookies","queryParams","getTopLevelDomain","createCookieStorage","previousSessionDeviceId","previousSessionUserId","url","host","parts","levels","hostname","BASE_CAMPAIGN","utm_campaign","utm_content","utm_id","utm_medium","utm_source","utm_term","referrer","referring_domain","dclid","gbraid","gclid","fbclid","ko_click_id","li_fat_id","msclkid","rtd_cid","ttclid","twclid","wbraid","CampaignParser","getUtmParam","getReferrer","getClickIds","params","domainWithoutSubdomain","isExcludedReferrer","excludeReferrers","referringDomain","some","RegExp","test","webAttributionPlugin","amplitude","pluginConfig","currentCampaign","previousCampaign","campaignEvent","initialEmptyValue","resetSessionOnNewCampaign","cookieDomain","current","previous","prevReferringDomain","hasNewCampaign","hasNewDomain","isNewCampaign","setSessionId","campaign","campaignParameters","identifyEvent","createCampaignEvent","omitUndefined","input","val","pageViewTrackingPlugin","pushState","createPageViewEvent","getCampaignParams","href","pathname","title","shouldTrackOnPageLoad","previousURL","trackHistoryPageView","newURL","shouldTrackPageView","shouldTrackHistoryPageView","trackHistoryPageViewWrapper","addEventListener","history","Proxy","target","unused","pageViewEvent","isCampaignEvent","removeEventListener","$set","$unset","userProperties_1","every","trackingOption","oldURL","formInteractionTracking","observer","eventListeners","handler","addFormInteractionListener","form","hasFormChanged","id","getElementsByTagName","MutationObserver","mutations","mutation","addedNodes","node","nodeName","querySelectorAll","observe","subtree","childList","disconnect","fileDownloadTracking","addFileDownloadListener","ext","URL","exec","fileExtension","notified","AmplitudeBrowser","init","userIdOrOptions","maybeOptions","browserOptions","connector","attributionTrackingOptions","webAttribution","enabledTracking","enabledTrackingString","detNotify","attribution","getUserId","setConnectorUserId","getDeviceId","setConnectorDeviceId","getSessionId","previousSessionId","extendSession","setTransport","currentTime","timeSinceLastEvent","Amplitude","fileDownloads","sessions","formInteractions","eventName","Analytics","el","tracker","DOM","clickableElements","eventNameAttribute","changeableElements","eventNameAttributeOnchange","urlParams","URLSearchParams","urlParamsString","replaceState","attachClickEvents","attachChangeEvents","dataEventName","getAttribute","preventDefault","handleClick","handleChange","currentScript","Function"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,IAIjBlC,EAAoBA,EAAoBmC,EAAI,G,8EClFrD,kDAAIC,EAAgD,WAChD,SAASA,KAWT,OATAA,EAA+BJ,UAAUK,sBAAwB,WAC7D,MAAO,CACHC,YAAaC,KAAKD,YAClBE,SAAUC,IACVC,SAAU,MACVC,QAAIC,EACJC,iBAAaD,IAGdR,EAZwC,GAc/CK,EAAc,WACd,MAA8B,oBAAdK,YACVA,UAAUC,WAAaD,UAAUC,UAAU,IACzCD,UAAUN,WACd,IAGJQ,EAAiC,WACjC,SAASA,IACLT,KAAKU,MAAQ,GAqBjB,OAnBAD,EAAgBhB,UAAUkB,SAAW,SAAUC,GACtCZ,KAAKa,SAMNb,KAAKa,SAASD,GALVZ,KAAKU,MAAMI,OAAS,KACpBd,KAAKU,MAAMK,KAAKH,IAO5BH,EAAgBhB,UAAUuB,iBAAmB,SAAUH,GACnDb,KAAKa,SAAWA,EACZb,KAAKU,MAAMI,OAAS,IACpBd,KAAKU,MAAMO,SAAQ,SAAUL,GACzBC,EAASD,MAEbZ,KAAKU,MAAQ,KAGdD,EAvByB,GAwChCS,EAAW,WAQb,OAPAA,EAAW3C,OAAO4C,QAAU,SAAkBpC,GAC5C,IAAK,IAAIa,EAAG/B,EAAI,EAAGyB,EAAI8B,UAAUN,OAAQjD,EAAIyB,EAAGzB,IAE9C,IAAK,IAAI8B,KADTC,EAAIwB,UAAUvD,GACOU,OAAOkB,UAAUC,eAAe1B,KAAK4B,EAAGD,KAAIZ,EAAEY,GAAKC,EAAED,IAE5E,OAAOZ,IAEOsC,MAAMrB,KAAMoB,YAI1BE,EAAU,SAAUC,EAAMC,GAC1B,IACIC,SAAeF,EAEnB,GAAIE,WADeD,EAEf,OAAO,EAEX,IAAK,IAAIE,EAAK,EAAGC,EAND,CAAC,SAAU,SAAU,UAAW,aAMND,EAAKC,EAAYb,OAAQY,IAAM,CAErE,GADQC,EAAYD,KACVD,EACN,OAAOF,IAASC,EAIxB,GAAY,MAARD,GAAwB,MAARC,EAChB,OAAO,EAEN,GAAY,MAARD,GAAwB,MAARC,EACrB,OAAO,EAGX,GAAID,EAAKT,SAAWU,EAAKV,OACrB,OAAO,EAGX,IAAIc,EAAWC,MAAMC,QAAQP,GACzBQ,EAAWF,MAAMC,QAAQN,GAC7B,GAAII,IAAaG,EACb,OAAO,EAEX,IAAIH,IAAYG,EAQX,CAED,IAAIC,EAAUzD,OAAO0D,KAAKV,GAAMW,OAC5BC,EAAU5D,OAAO0D,KAAKT,GAAMU,OAChC,IAAKZ,EAAQU,EAASG,GAClB,OAAO,EAGX,IAAIC,GAAW,EAMf,OALA7D,OAAO0D,KAAKV,GAAMN,SAAQ,SAAU7B,GAC3BkC,EAAQC,EAAKnC,GAAMoC,EAAKpC,MACzBgD,GAAW,MAGZA,EApBP,IAAK,IAAIvE,EAAI,EAAGA,EAAI0D,EAAKT,OAAQjD,IAC7B,IAAKyD,EAAQC,EAAK1D,GAAI2D,EAAK3D,IACvB,OAAO,EAoBnB,OAAO,GAONU,OAAO8D,UACR9D,OAAO8D,QAAU,SAAUC,GAIvB,IAHA,IAAIC,EAAWhE,OAAO0D,KAAKK,GACvBzE,EAAI0E,EAASzB,OACb0B,EAAW,IAAIX,MAAMhE,GAClBA,KACH2E,EAAS3E,GAAK,CAAC0E,EAAS1E,GAAIyE,EAAIC,EAAS1E,KAE7C,OAAO2E,IAGf,IAAIC,EAAmC,WACnC,SAASA,IACLzC,KAAK0C,SAAW,CAAEC,eAAgB,IAClC3C,KAAK4C,UAAY,IAAIC,IAqEzB,OAnEAJ,EAAkBhD,UAAUqD,aAAe,WAEvC,IAAIC,EAAO/C,KACPgD,EAAuB9B,EAAS,GAAIlB,KAAK0C,SAASC,gBAClDM,EAAiB/B,EAASA,EAAS,GAAIlB,KAAK0C,UAAW,CAAEC,eAAgBK,IAC7E,MAAO,CACHE,UAAW,SAAUC,GAEjB,OADAF,EAAeE,OAASA,EACjBnD,MAEXoD,YAAa,SAAUC,GAEnB,OADAJ,EAAeI,SAAWA,EACnBrD,MAEXsD,kBAAmB,SAAUX,GAEzB,OADAM,EAAeN,eAAiBA,EACzB3C,MAEXuD,qBAAsB,SAAUC,GAE5B,IADA,IAAIC,EAAmBR,EAAeN,gBAAkB,GAC/CjB,EAAK,EAAGgC,EAAKnF,OAAO8D,QAAQmB,GAAU9B,EAAKgC,EAAG5C,OAAQY,IAAM,CACjE,IAAIiC,EAAKD,EAAGhC,GAAKkC,EAASD,EAAG,GAAIE,EAAaF,EAAG,GACjD,OAAQC,GACJ,IA3CR,OA4CY,IAAK,IAAIE,EAAK,EAAGC,EAAKxF,OAAO8D,QAAQwB,GAAaC,EAAKC,EAAGjD,OAAQgD,IAAM,CACpE,IAAIE,EAAKD,EAAGD,GAAK1E,EAAM4E,EAAG,GAAIlF,EAAQkF,EAAG,GACzCP,EAAiBrE,GAAON,EAE5B,MACJ,IAhDN,SAiDU,IAAK,IAAImF,EAAK,EAAGC,EAAK3F,OAAO0D,KAAK4B,GAAaI,EAAKC,EAAGpD,OAAQmD,IAAM,QAE1DR,EADHrE,EAAM8E,EAAGD,IAGjB,MACJ,IArDF,YAsDMR,EAAmB,IAK/B,OADAR,EAAeN,eAAiBc,EACzBzD,MAEXmE,OAAQ,WAEJ,OADApB,EAAKqB,YAAYnB,GACVjD,QAInByC,EAAkBhD,UAAU4E,YAAc,WACtC,OAAOnD,EAAS,GAAIlB,KAAK0C,WAE7BD,EAAkBhD,UAAU2E,YAAc,SAAU1B,GAChD,IAAI4B,EAAmBpD,EAAS,GAAIlB,KAAK0C,UACzC1C,KAAK0C,SAAWxB,EAAS,GAAIwB,GACxBpB,EAAQgD,EAAkBtE,KAAK0C,WAChC1C,KAAK4C,UAAU3B,SAAQ,SAAUsD,GAC7BA,EAAS7B,OAIrBD,EAAkBhD,UAAU+E,oBAAsB,SAAUD,GACxDvE,KAAK4C,UAAU6B,IAAIF,IAEvB9B,EAAkBhD,UAAUiF,uBAAyB,SAAUH,GAC3DvE,KAAK4C,UAAU+B,OAAOJ,IAEnB9B,EAxE2B,GA2ElCmC,EAAmC,oBAAfC,WAClBA,gBACkB,IAAXC,EACHA,EACA/B,KAENgC,EAAoC,WACpC,SAASA,IACL/E,KAAKgF,cAAgB,IAAIvC,EACzBzC,KAAKiF,YAAc,IAAIxE,EACvBT,KAAKkF,2BAA6B,IAAIrF,EAY1C,OAVAkF,EAAmBI,YAAc,SAAUC,GAQvC,OAPKR,EAAwC,8BACzCA,EAAwC,4BAAI,IAE3CA,EAAwC,4BAAEQ,KAC3CR,EAAwC,4BAAEQ,GACtC,IAAIL,GAELH,EAAwC,4BAAEQ,IAE9CL,EAhB4B,K,2DClOvC,8CAEO,IAAIM,EAAiB,WACxB,MAA0B,oBAAfR,WACAA,WAEW,oBAAXS,OACAA,OAES,oBAATvC,KACAA,UAEW,IAAX+B,EACAA,OADX,K,+DCIJ,IAAIS,EAAgB,SAASpH,EAAGqH,GAI5B,OAHAD,EAAgBhH,OAAOkH,gBAClB,CAAEC,UAAW,cAAgB7D,OAAS,SAAU1D,EAAGqH,GAAKrH,EAAEuH,UAAYF,IACvE,SAAUrH,EAAGqH,GAAK,IAAK,IAAI7F,KAAK6F,EAAOjH,OAAOkB,UAAUC,eAAe1B,KAAKwH,EAAG7F,KAAIxB,EAAEwB,GAAK6F,EAAE7F,MAC3ExB,EAAGqH,IAGrB,SAASG,EAAUxH,EAAGqH,GACzB,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAII,UAAU,uBAAyBC,OAAOL,GAAK,iCAE7D,SAASM,IAAO9F,KAAK+F,YAAc5H,EADnCoH,EAAcpH,EAAGqH,GAEjBrH,EAAEsB,UAAkB,OAAN+F,EAAajH,OAAOY,OAAOqG,IAAMM,EAAGrG,UAAY+F,EAAE/F,UAAW,IAAIqG,GAG5E,IAAI5E,EAAW,WAQlB,OAPAA,EAAW3C,OAAO4C,QAAU,SAAkBpC,GAC1C,IAAK,IAAIa,EAAG/B,EAAI,EAAGyB,EAAI8B,UAAUN,OAAQjD,EAAIyB,EAAGzB,IAE5C,IAAK,IAAI8B,KADTC,EAAIwB,UAAUvD,GACOU,OAAOkB,UAAUC,eAAe1B,KAAK4B,EAAGD,KAAIZ,EAAEY,GAAKC,EAAED,IAE9E,OAAOZ,IAEKsC,MAAMrB,KAAMoB,YAGzB,SAAS4E,EAAOpG,EAAGqG,GACtB,IAAIlH,EAAI,GACR,IAAK,IAAIY,KAAKC,EAAOrB,OAAOkB,UAAUC,eAAe1B,KAAK4B,EAAGD,IAAMsG,EAAEC,QAAQvG,GAAK,IAC9EZ,EAAEY,GAAKC,EAAED,IACb,GAAS,MAALC,GAAqD,mBAAjCrB,OAAO4H,sBACtB,KAAItI,EAAI,EAAb,IAAgB8B,EAAIpB,OAAO4H,sBAAsBvG,GAAI/B,EAAI8B,EAAEmB,OAAQjD,IAC3DoI,EAAEC,QAAQvG,EAAE9B,IAAM,GAAKU,OAAOkB,UAAU2G,qBAAqBpI,KAAK4B,EAAGD,EAAE9B,MACvEkB,EAAEY,EAAE9B,IAAM+B,EAAED,EAAE9B,KAE1B,OAAOkB,EA+DJ,SAASsH,EAAUC,EAASC,EAAYC,EAAGC,GAE9C,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAU/H,GAAS,IAAMgI,EAAKL,EAAUM,KAAKjI,IAAW,MAAOmH,GAAKW,EAAOX,IACpF,SAASe,EAASlI,GAAS,IAAMgI,EAAKL,EAAiB,MAAE3H,IAAW,MAAOmH,GAAKW,EAAOX,IACvF,SAASa,EAAKG,GAJlB,IAAenI,EAIamI,EAAOC,KAAOP,EAAQM,EAAOnI,QAJ1CA,EAIyDmI,EAAOnI,MAJhDA,aAAiB0H,EAAI1H,EAAQ,IAAI0H,GAAE,SAAUG,GAAWA,EAAQ7H,OAITqI,KAAKN,EAAWG,GAClGF,GAAML,EAAYA,EAAUpF,MAAMiF,EAASC,GAAc,KAAKQ,WAI/D,SAASK,EAAYd,EAASe,GACjC,IAAsGC,EAAGC,EAAGxI,EAAGyI,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAP5I,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAO6I,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAET,KAAMe,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,mBAAXlJ,SAA0B4I,EAAE5I,OAAOmJ,UAAY,WAAa,OAAO/H,OAAUwH,EACvJ,SAASM,EAAKxI,GAAK,OAAO,SAAU0I,GAAK,OACzC,SAAcC,GACV,GAAIX,EAAG,MAAM,IAAI1B,UAAU,mCAC3B,KAAO4B,IAAMA,EAAI,EAAGS,EAAG,KAAOR,EAAI,IAAKA,GAAG,IACtC,GAAIH,EAAI,EAAGC,IAAMxI,EAAY,EAARkJ,EAAG,GAASV,EAAU,OAAIU,EAAG,GAAKV,EAAS,SAAOxI,EAAIwI,EAAU,SAAMxI,EAAEf,KAAKuJ,GAAI,GAAKA,EAAER,SAAWhI,EAAIA,EAAEf,KAAKuJ,EAAGU,EAAG,KAAKf,KAAM,OAAOnI,EAE3J,OADIwI,EAAI,EAAGxI,IAAGkJ,EAAK,CAAS,EAARA,EAAG,GAAQlJ,EAAED,QACzBmJ,EAAG,IACP,KAAK,EAAG,KAAK,EAAGlJ,EAAIkJ,EAAI,MACxB,KAAK,EAAc,OAAXR,EAAEC,QAAgB,CAAE5I,MAAOmJ,EAAG,GAAIf,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIU,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKR,EAAEI,IAAIK,MAAOT,EAAEG,KAAKM,MAAO,SACxC,QACI,KAAMnJ,EAAI0I,EAAEG,MAAM7I,EAAIA,EAAE+B,OAAS,GAAK/B,EAAEA,EAAE+B,OAAS,KAAkB,IAAVmH,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAER,EAAI,EAAG,SACjG,GAAc,IAAVQ,EAAG,MAAclJ,GAAMkJ,EAAG,GAAKlJ,EAAE,IAAMkJ,EAAG,GAAKlJ,EAAE,IAAM,CAAE0I,EAAEC,MAAQO,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYR,EAAEC,MAAQ3I,EAAE,GAAI,CAAE0I,EAAEC,MAAQ3I,EAAE,GAAIA,EAAIkJ,EAAI,MAC7D,GAAIlJ,GAAK0I,EAAEC,MAAQ3I,EAAE,GAAI,CAAE0I,EAAEC,MAAQ3I,EAAE,GAAI0I,EAAEI,IAAI9G,KAAKkH,GAAK,MACvDlJ,EAAE,IAAI0I,EAAEI,IAAIK,MAChBT,EAAEG,KAAKM,MAAO,SAEtBD,EAAKZ,EAAKrJ,KAAKsI,EAASmB,GAC1B,MAAOxB,GAAKgC,EAAK,CAAC,EAAGhC,GAAIsB,EAAI,EAAK,QAAUD,EAAIvI,EAAI,EACtD,GAAY,EAARkJ,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEnJ,MAAOmJ,EAAG,GAAKA,EAAG,QAAK,EAAQf,MAAM,GArB9BJ,CAAK,CAACxH,EAAG0I,MAyBhCzJ,OAAOY,OAgB7B,SAASgJ,EAAS7J,GACrB,IAAIsB,EAAsB,mBAAXhB,QAAyBA,OAAOmJ,SAAU9J,EAAI2B,GAAKtB,EAAEsB,GAAI/B,EAAI,EAC5E,GAAII,EAAG,OAAOA,EAAED,KAAKM,GACrB,GAAIA,GAAyB,iBAAbA,EAAEwC,OAAqB,MAAO,CAC1CiG,KAAM,WAEF,OADIzI,GAAKT,GAAKS,EAAEwC,SAAQxC,OAAI,GACrB,CAAEQ,MAAOR,GAAKA,EAAET,KAAMqJ,MAAO5I,KAG5C,MAAM,IAAIsH,UAAUhG,EAAI,0BAA4B,mCAGjD,SAASwI,EAAO9J,EAAGgB,GACtB,IAAIrB,EAAsB,mBAAXW,QAAyBN,EAAEM,OAAOmJ,UACjD,IAAK9J,EAAG,OAAOK,EACf,IAAmBK,EAAYsH,EAA3BpI,EAAII,EAAED,KAAKM,GAAO+J,EAAK,GAC3B,IACI,WAAc,IAAN/I,GAAgBA,KAAM,MAAQX,EAAId,EAAEkJ,QAAQG,MAAMmB,EAAGtH,KAAKpC,EAAEG,OAExE,MAAOwJ,GAASrC,EAAI,CAAEqC,MAAOA,GAC7B,QACI,IACQ3J,IAAMA,EAAEuI,OAASjJ,EAAIJ,EAAU,SAAII,EAAED,KAAKH,GAElD,QAAU,GAAIoI,EAAG,MAAMA,EAAEqC,OAE7B,OAAOD,EAmBJ,SAASE,EAAcC,EAAIC,EAAMC,GACpC,GAAIA,GAA6B,IAArBtH,UAAUN,OAAc,IAAK,IAA4BuH,EAAxBxK,EAAI,EAAGC,EAAI2K,EAAK3H,OAAYjD,EAAIC,EAAGD,KACxEwK,GAAQxK,KAAK4K,IACRJ,IAAIA,EAAKxG,MAAMpC,UAAUkJ,MAAM3K,KAAKyK,EAAM,EAAG5K,IAClDwK,EAAGxK,GAAK4K,EAAK5K,IAGrB,OAAO2K,EAAGI,OAAOP,GAAMxG,MAAMpC,UAAUkJ,MAAM3K,KAAKyK,IAsC7BlK,OAAOY,OAyDkB,mBAApB0J,iBAAiCA,gBA0BhD,ICrVJC,GACX,SAAWA,GACPA,EAASA,EAAe,KAAI,GAAK,OACjCA,EAASA,EAAgB,MAAI,GAAK,QAClCA,EAASA,EAAe,KAAI,GAAK,OACjCA,EAASA,EAAkB,QAAI,GAAK,UACpCA,EAASA,EAAgB,MAAI,GAAK,QALtC,CAMGA,IAAaA,EAAW,KCDpB,ICLIC,EDKAC,EAAgB,SAAUC,GAGjC,YAFoB,IAAhBA,IAA0BA,EAAc,KAChC,IAAIC,OAAQC,OAAS,IAE5BC,MAAM,MACNT,MAAM,EAAIM,GACVI,KAAI,SAAUC,GAAQ,OAAOA,EAAKC,WAGhCC,EAAqB,SAAUC,GAAU,OAAO,WACvD,IAAI/F,EAAKxC,EAAS,GAAIuI,EAAOC,QAC7B,MAAO,CACHC,OAF2CjG,EAAGkG,eAG9CC,SAHyEnG,EAAGmG,YAOzEC,EAAuB,SAAUxH,EAAKyH,GAC7C,IAAIC,EAAKtG,EAETqG,GADAA,EAAOA,EAAKE,QAAQ,aAAc,QACtBA,QAAQ,MAAO,IAC3B,IACI,IAAK,IAAItG,EAAKwE,EAAS4B,EAAKX,MAAM,MAAOtF,EAAKH,EAAGoD,QAASjD,EAAGoD,KAAMpD,EAAKH,EAAGoD,OAAQ,CAC/E,IAAImD,EAAOpG,EAAGhF,MACd,KAAIoL,KAAQ5H,GAIR,OAHAA,EAAMA,EAAI4H,IAOtB,MAAOC,GAASH,EAAM,CAAE1B,MAAO6B,GAC/B,QACI,IACQrG,IAAOA,EAAGoD,OAASxD,EAAKC,EAAGyG,SAAS1G,EAAG1F,KAAK2F,GAEpD,QAAU,GAAIqG,EAAK,MAAMA,EAAI1B,OAEjC,OAAOhG,GAEA+H,EAAkB,SAAUZ,EAAQa,GAAS,OAAO,WAC3D,IAAIC,EAAK7G,EACL8G,EAAM,GACV,IACI,IAAK,IAAIC,EAAUtC,EAASmC,GAAQI,EAAYD,EAAQ1D,QAAS2D,EAAUxD,KAAMwD,EAAYD,EAAQ1D,OAAQ,CACzG,IAAIgD,EAAOW,EAAU5L,MACrB0L,EAAIT,GAAQD,EAAqBL,EAAQM,IAGjD,MAAOY,GAASJ,EAAM,CAAEjC,MAAOqC,GAC/B,QACI,IACQD,IAAcA,EAAUxD,OAASxD,EAAK+G,EAAQL,SAAS1G,EAAG1F,KAAKyM,GAEvE,QAAU,GAAIF,EAAK,MAAMA,EAAIjC,OAEjC,OAAOkC,IAEAI,EAAe,SAAUC,EAAIC,EAAQC,EAAcC,EAAWC,GAErE,YADkB,IAAdA,IAAwBA,EAAY,MACjC,WAEH,IADA,IAAIC,EAAO,GACFxJ,EAAK,EAAGA,EAAKN,UAAUN,OAAQY,IACpCwJ,EAAKxJ,GAAMN,UAAUM,GAEzB,IAAIgC,EAAKqH,IAAgBpB,EAASjG,EAAGiG,OAAQE,EAAWnG,EAAGmG,SAE3D,GAAKA,GAAYA,EAAWf,EAASqC,QAAWtB,IAAaF,EACzD,OAAOkB,EAAGxJ,MAAM4J,EAAWC,GAE/B,IAAIE,EAAe,CACfC,KAAM,uBACNjN,KAAM0M,EACNI,KAAMA,EACNI,WAAYtC,EAAc,GAC1BuC,KAAM,CACFC,OAAO,IAAIC,MAAOC,eAEtBC,OAAQ,IAERX,GAAaI,EAAaO,SAC1BP,EAAaO,OAAOC,OAASZ,KAEjC,IAAI/D,EAAS4D,EAAGxJ,MAAM4J,EAAWC,GAsBjC,OArBIjE,GAAUA,EAAO4E,QAEjB5E,EAAO4E,QAAQ1E,MAAK,WACZ6D,GAAaI,EAAaO,SAC1BP,EAAaO,OAAOG,MAAQd,KAE5BI,EAAaG,OACbH,EAAaG,KAAKQ,KAAM,IAAIN,MAAOC,eAEvC/B,EAAOqC,MAAMC,KAAKC,UAAUd,EAAc,KAAM,QAIhDJ,GAAaI,EAAaO,SAC1BP,EAAaO,OAAOG,MAAQd,KAE5BI,EAAaG,OACbH,EAAaG,KAAKQ,KAAM,IAAIN,MAAOC,eAEvC/B,EAAOqC,MAAMC,KAAKC,UAAUd,EAAc,KAAM,KAE7CnE,IEhHJkF,EAAgB,SAAUC,GAAa,MAAO,CACrDP,QAASO,GAAa1F,QAAQC,aDClC,SAAWoC,GAEPA,EAAgB,QAAI,UAEpBA,EAAgB,QAAI,UAEpBA,EAAgB,QAAI,UAEpBA,EAAkB,UAAI,aAEtBA,EAAwB,gBAAI,oBAE5BA,EAAgB,QAAI,UAEpBA,EAAe,OAAI,SAEnBA,EAAgB,QAAI,UAEpBA,EAAoB,YAAI,cAlB5B,CAmBGA,IAAWA,EAAS,KErBhB,ICCIsD,EAAmB,MACnBC,EAAiB,GAAG1D,OAAOyD,EAAkB,WCD7CE,EAAc,SAAU3L,EAAO4L,EAAMC,GAG5C,YAFa,IAATD,IAAmBA,EAAO,QACd,IAAZC,IAAsBA,EAAU1D,EAAO2D,SACpC,CAAE9L,MAAOA,EAAO4L,KAAMA,EAAMC,QAASA,ICH5CE,EAAS,oBACT,EAAwB,WACxB,SAASC,IACL5M,KAAK6J,SAAWf,EAAS+D,KAkD7B,OAhDAD,EAAOnN,UAAUqN,QAAU,WACvB9M,KAAK6J,SAAWf,EAAS+D,MAE7BD,EAAOnN,UAAUsN,OAAS,SAAUlD,QACf,IAAbA,IAAuBA,EAAWf,EAASkE,MAC/ChN,KAAK6J,SAAWA,GAEpB+C,EAAOnN,UAAUwN,IAAM,WAEnB,IADA,IAAI/B,EAAO,GACFxJ,EAAK,EAAGA,EAAKN,UAAUN,OAAQY,IACpCwJ,EAAKxJ,GAAMN,UAAUM,GAErB1B,KAAK6J,SAAWf,EAASoE,SAG7BC,QAAQF,IAAI,GAAGrE,OAAO+D,EAAQ,WAAW/D,OAAOsC,EAAKkC,KAAK,QAE9DR,EAAOnN,UAAU4N,KAAO,WAEpB,IADA,IAAInC,EAAO,GACFxJ,EAAK,EAAGA,EAAKN,UAAUN,OAAQY,IACpCwJ,EAAKxJ,GAAMN,UAAUM,GAErB1B,KAAK6J,SAAWf,EAASkE,MAG7BG,QAAQE,KAAK,GAAGzE,OAAO+D,EAAQ,YAAY/D,OAAOsC,EAAKkC,KAAK,QAEhER,EAAOnN,UAAU6I,MAAQ,WAErB,IADA,IAAI4C,EAAO,GACFxJ,EAAK,EAAGA,EAAKN,UAAUN,OAAQY,IACpCwJ,EAAKxJ,GAAMN,UAAUM,GAErB1B,KAAK6J,SAAWf,EAASI,OAG7BiE,QAAQ7E,MAAM,GAAGM,OAAO+D,EAAQ,aAAa/D,OAAOsC,EAAKkC,KAAK,QAElER,EAAOnN,UAAUuM,MAAQ,WAErB,IADA,IAAId,EAAO,GACFxJ,EAAK,EAAGA,EAAKN,UAAUN,OAAQY,IACpCwJ,EAAKxJ,GAAMN,UAAUM,GAErB1B,KAAK6J,SAAWf,EAASqC,OAI7BgC,QAAQF,IAAI,GAAGrE,OAAO+D,EAAQ,aAAa/D,OAAOsC,EAAKkC,KAAK,QAEzDR,EApDgB,GCChBU,EAAmB,WAAc,MAAO,CAC/CC,gBAAiB,GACjBC,eAAgB,IAChBC,oBAAqB,IACrBrI,aAAc,oBACdyE,SAAUf,EAASkE,KACnBpD,eAAgB,IAAI,EACpB8D,QAAQ,EACRC,UHR8B,uCGS9BC,WAAY,KACZC,UAAU,IAEVC,EAAwB,WACxB,SAASA,EAAOC,GACZ,IAAIrK,EAAIC,EAAIG,EAAIC,EAChB/D,KAAKgO,SAAU,EACf,IAAIC,EAAgBX,IACpBtN,KAAKkO,OAASH,EAAQG,OACtBlO,KAAKyN,oBAA6D,QAAtC/J,EAAKqK,EAAQN,2BAAwC,IAAP/J,EAAgBA,EAAKuK,EAAcR,oBAC7GzN,KAAKuN,gBAAkBQ,EAAQR,iBAAmBU,EAAcV,gBAChEvN,KAAKwN,eAAiBO,EAAQP,gBAAkBS,EAAcT,eAC9DxN,KAAKoF,aAAe2I,EAAQ3I,cAAgB6I,EAAc7I,aAC1DpF,KAAK4J,eAAiBmE,EAAQnE,gBAAkBqE,EAAcrE,eAC9D5J,KAAK6J,SAAuC,QAA3BlG,EAAKoK,EAAQlE,gBAA6B,IAAPlG,EAAgBA,EAAKsK,EAAcpE,SACvF7J,KAAKmO,YAAcJ,EAAQI,YAC3BnO,KAAKoO,KAAOL,EAAQK,KACpBpO,KAAKqO,kBAAoBN,EAAQM,kBACjCrO,KAAK0N,OAAmC,QAAzB5J,EAAKiK,EAAQL,cAA2B,IAAP5J,EAAgBA,EAAKmK,EAAcP,OACnF1N,KAAK2N,UAAYI,EAAQJ,UACzB3N,KAAK4N,WAAaG,EAAQH,YAAcK,EAAcL,WACtD5N,KAAKsO,gBAAkBP,EAAQO,gBAC/BtO,KAAKuO,kBAAoBR,EAAQQ,kBACjCvO,KAAK6N,SAAuC,QAA3B9J,EAAKgK,EAAQF,gBAA6B,IAAP9J,EAAgBA,EAAKkK,EAAcJ,SACvF7N,KAAK4J,eAAemD,OAAO/M,KAAK6J,UAChC,IAAI2E,EAAeC,EAAmBV,EAAQJ,UAAWI,EAAQH,WAAYG,EAAQF,UACrF7N,KAAK4N,WAAaY,EAAaZ,WAC/B5N,KAAK2N,UAAYa,EAAab,UAYlC,OAVApP,OAAOC,eAAesP,EAAOrO,UAAW,SAAU,CAC9Cf,IAAK,WACD,OAAOsB,KAAKgO,SAEhBU,IAAK,SAAUhB,GACX1N,KAAKgO,QAAUN,GAEnBjP,YAAY,EACZkQ,cAAc,IAEXb,EApCgB,GAuChBc,EAAe,SAAUhB,EAAYC,GAC5C,MAAmB,OAAfD,EACOC,EHlD4B,qCAFN,yCGsD1BA,EHrD6B,mCAFN,wCGyDvBY,EAAqB,SAAUd,EAAWC,EAAYC,GAI7D,QAHkB,IAAdF,IAAwBA,EAAY,SACrB,IAAfC,IAAyBA,EAAaN,IAAmBM,iBAC5C,IAAbC,IAAuBA,EAAWP,IAAmBO,UACrDF,EACA,MAAO,CAAEA,UAAWA,EAAWC,gBAAYvN,GAE/C,IAAIwO,EAAc,CAAC,KAAM,MAAMC,SAASlB,GAAcA,EAAaN,IAAmBM,WACtF,MAAO,CACHA,WAAYiB,EACZlB,UAAWiB,EAAaC,EAAahB,KC1DtC,SAASkB,EAAsBvE,GAClC,IAAIwE,EAAqB,GACzB,IACQ,SAAUxE,IACVwE,EAAqB/C,KAAKC,UAAU1B,EAAInD,KAAM,KAAM,IAG5D,MAAO3D,IAGP,OAAOsL,EAEX,ICxBWC,EAiBAC,EAYAC,EDLP,EAA6B,WAC7B,SAASC,IACLpP,KAAK5B,KAAO,YACZ4B,KAAKqL,KAAO,cACZrL,KAAKqP,aAAe,IACpBrP,KAAKsP,gBAAkB,IACvBtP,KAAKuP,WAAa,GAClBvP,KAAKwP,UAAY,KACjBxP,KAAKU,MAAQ,GAwQjB,OAtQA0O,EAAY3P,UAAUgQ,MAAQ,SAAU/F,GACpC,IAAIhG,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI0P,EACAC,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EAGD,OAFA1H,KAAK0J,OAASA,EACd1J,KAAKuP,WAAa,GAAG3G,OAAO0D,EAAgB,KAAK1D,OAAO5I,KAAK0J,OAAOwE,OAAO0B,UAAU,EAAG,KACjF,CAAC,EAAqD,QAAtClM,EAAK1D,KAAK0J,OAAO4E,uBAAoC,IAAP5K,OAAgB,EAASA,EAAGhF,IAAIsB,KAAKuP,aAC9G,KAAK,EAMD,OALAG,EAAS/L,EAAGgE,OACZ3H,KAAK6P,aACDH,GAAUA,EAAO5O,OAAS,GACrB4F,QAAQoJ,IAAIJ,EAAOrG,KAAI,SAAUzI,GAAS,OAAO+O,EAAMI,QAAQnP,OAAYoP,QAE7E,CAAC,EAActJ,QAAQC,aAAQtG,YAK1D+O,EAAY3P,UAAUsQ,QAAU,SAAUnP,GACtC,IAAI+O,EAAQ3P,KACZ,OAAO,IAAI0G,SAAQ,SAAUC,GACzB,IAAIsJ,EAAU,CACVrP,MAAOA,EACPsP,SAAU,EACVC,SAAU,SAAUlJ,GAAU,OAAON,EAAQM,IAC7CmJ,QAAS,GAERT,EAAMU,WAAWJ,OAG9Bb,EAAY3P,UAAU4Q,WAAa,WAG/B,IAFA,IAAIV,EAAQ3P,KACRsQ,EAAO,GACF5O,EAAK,EAAGA,EAAKN,UAAUN,OAAQY,IACpC4O,EAAK5O,GAAMN,UAAUM,GAEzB,IAAI6O,EAAUD,EAAKE,QAAO,SAAUP,GAChC,OAAIA,EAAQC,SAAWP,EAAMjG,OAAO6D,iBAChC0C,EAAQC,UAAY,GACb,IAENP,EAAMc,eAAe,CAACR,GAAU,IL7EP,+CK8EvB,MAEXM,EAAQtP,SAAQ,SAAUgP,GACtBN,EAAMjP,MAAQiP,EAAMjP,MAAMkI,OAAOqH,GACT,IAApBA,EAAQG,QAIZM,YAAW,WACPT,EAAQG,QAAU,EAClBT,EAAMgB,SAAS,KAChBV,EAAQG,SANPT,EAAMgB,SAAShB,EAAMjG,OAAO+D,wBAQpCzN,KAAK6P,cAETT,EAAY3P,UAAUkR,SAAW,SAAUP,GACvC,IAAIT,EAAQ3P,KACRA,KAAKwP,YAETxP,KAAKwP,UAAYkB,YAAW,WACnBf,EAAMiB,OAAM,GAAMzJ,MAAK,WACpBwI,EAAMjP,MAAMI,OAAS,GACrB6O,EAAMgB,SAASP,QAGxBA,KAEPhB,EAAY3P,UAAUmR,MAAQ,SAAUC,GAEpC,YADiB,IAAbA,IAAuBA,GAAW,GAC/BxK,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIsQ,EAAMQ,EAAOC,EACbpB,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAUD,OATA4I,EAAO,GACPQ,EAAQ,GACR9Q,KAAKU,MAAMO,SAAQ,SAAUgP,GAAW,OAA4B,IAApBA,EAAQG,QAAgBE,EAAKvP,KAAKkP,GAAWa,EAAM/P,KAAKkP,MACxGjQ,KAAKU,MAAQoQ,EACT9Q,KAAKwP,YACLwB,aAAahR,KAAKwP,WAClBxP,KAAKwP,UAAY,MEtHhByB,EFwHWX,EExHNY,EFwHYlR,KAAK0J,OAAO8D,eEvHlD2D,EAAYC,KAAKC,IAAIH,EAAM,GFuHXH,EEtHbE,EAAIK,QAAO,SAAUC,EAAQC,EAASC,GACzC,IAAIC,EAAaN,KAAKO,MAAMF,EAAQN,GAKpC,OAJKI,EAAOG,KACRH,EAAOG,GAAc,IAEzBH,EAAOG,GAAY3Q,KAAKyQ,GACjBD,IACR,IFgHwB,CAAC,EAAa7K,QAAQoJ,IAAIiB,EAAQ1H,KAAI,SAAUuI,GAAS,OAAOjC,EAAMkC,KAAKD,EAAOf,QAC7F,KAAK,EAED,OADAnN,EAAGiE,OACI,CAAC,GE5Hb,IAAUsJ,EAAKC,EAC1BC,SFgIJ/B,EAAY3P,UAAUoS,KAAO,SAAUvB,EAAMO,GAEzC,YADiB,IAAbA,IAAuBA,GAAW,GAC/BxK,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI8R,EAASnE,EAAWnD,EAAKR,EAAK+H,EAClC,OAAO3K,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EACD,IAAK1H,KAAK0J,OAAOwE,OACb,MAAO,CAAC,EAAclO,KAAKyQ,eAAeH,EAAM,ILxIvC,0CK0IbwB,EAAU,CACNE,QAAShS,KAAK0J,OAAOwE,OACrB+D,OAAQ3B,EAAKjH,KAAI,SAAU4G,GAEvB,IAAIvM,EAAKuM,EAAQrP,MAAe8C,EAAGwO,MACnC,OAD8DlM,EAAOtC,EAAI,CAAC,aAG9EqK,QAAS,CACLoE,cAAenS,KAAK0J,OAAOyE,cAGnCzK,EAAGgE,MAAQ,EACf,KAAK,EAGD,OAFAhE,EAAGkE,KAAK7G,KAAK,CAAC,EAAG,EAAG,CAAE,IACtB4M,EAAYc,EAAmBzO,KAAK0J,OAAOiE,UAAW3N,KAAK0J,OAAOkE,WAAY5N,KAAK0J,OAAOmE,UAAUF,UAC7F,CAAC,EAAa3N,KAAK0J,OAAO6E,kBAAkBsD,KAAKlE,EAAWmE,IACvE,KAAK,EAED,OAAY,QADZtH,EAAM9G,EAAGiE,SAEL3H,KAAKyQ,eAAeH,EAAM,ELhKhB,6BKiKH,CAAC,IAEPO,GASL7Q,KAAKoS,eAAe5H,EAAK8F,GAClB,CAAC,EAAa,KATb,SAAU9F,EACVxK,KAAKyQ,eAAeH,EAAM9F,EAAI6H,WAAY,GAAGzJ,OAAO4B,EAAI8H,OAAQ,MAAM1J,OAAOmG,EAAsBvE,KAGnGxK,KAAKyQ,eAAeH,EAAM9F,EAAI6H,WAAY7H,EAAI8H,QAE3C,CAAC,IAIhB,KAAK,EAKD,OAJAtI,EAAMtG,EAAGiE,OACToK,GA1KCzJ,EA0K8B0B,aAzK9Bd,MACVZ,EAAMmE,QACV5G,OAAOyC,GAwKMtI,KAAK0J,OAAOE,eAAetB,MAAMyJ,GACjC/R,KAAKyQ,eAAeH,EAAM,EAAGyB,GACtB,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,GA9KpC,IAAyBzJ,SAmLrB8G,EAAY3P,UAAU2S,eAAiB,SAAU5H,EAAK8F,GAClD,IAAIgC,EAAS9H,EAAI8H,OACjB,OAAQA,GACJ,KAAKvJ,EAAOwJ,QACRvS,KAAKwS,sBAAsBhI,EAAK8F,GAChC,MAEJ,KAAKvH,EAAO0J,QACRzS,KAAK0S,sBAAsBlI,EAAK8F,GAChC,MAEJ,KAAKvH,EAAO4J,gBACR3S,KAAK4S,8BAA8BpI,EAAK8F,GACxC,MAEJ,KAAKvH,EAAO8J,UACR7S,KAAK8S,wBAAwBtI,EAAK8F,GAClC,MAEJ,QAEItQ,KAAK0J,OAAOE,eAAeyD,KAAK,8BAA8BzE,OAAO0J,EAAQ,mBAAmB1J,OAAO0H,EAAKxP,OAAQ,cACpHd,KAAK+S,oBAAoBzC,KAKrClB,EAAY3P,UAAU+S,sBAAwB,SAAUhI,EAAK8F,GACzDtQ,KAAKyQ,eAAeH,EAAM9F,EAAI6H,WLtNT,+BKwNzBjD,EAAY3P,UAAUiT,sBAAwB,SAAUlI,EAAK8F,GACzD,IAAIX,EAAQ3P,KACZ,GAAIwK,EAAInD,KAAK2L,cAAgBxI,EAAInD,KAAKiB,MAAM2K,WLrNvB,mBKsNjBjT,KAAKyQ,eAAeH,EAAM9F,EAAI6H,WAAY7H,EAAInD,KAAKiB,WADvD,CAIA,IAAI4K,EAAY3K,EAAcA,EAAcA,EAAcA,EAAc,GAAIH,EAAO7J,OAAO4U,OAAO3I,EAAInD,KAAK+L,2BAA2B,GAAQhL,EAAO7J,OAAO4U,OAAO3I,EAAInD,KAAKgM,2BAA2B,GAAQjL,EAAO7J,OAAO4U,OAAO3I,EAAInD,KAAKiM,8BAA8B,GAAQlL,EAAOoC,EAAInD,KAAKkM,iBAAiB,GAAOC,OACtTC,EAAe,IAAI5Q,IAAIqQ,GACvBQ,EAAQpD,EAAKE,QAAO,SAAUP,EAASwB,GACvC,IAAIgC,EAAaE,IAAIlC,GAIrB,OAAO,EAHH9B,EAAMc,eAAe,CAACR,GAAUzF,EAAI6H,WAAY7H,EAAInD,KAAKiB,UAK7DoL,EAAM5S,OAAS,GAEfd,KAAK0J,OAAOE,eAAeyD,KAAK0B,EAAsBvE,IAE1DxK,KAAKqQ,WAAWhP,MAAMrB,KAAMuI,EAAc,GAAIH,EAAOsL,IAAQ,MAEjEtE,EAAY3P,UAAUmT,8BAAgC,SAAUpI,EAAK8F,GAC7C,IAAhBA,EAAKxP,QAKTd,KAAK0J,OAAOE,eAAeyD,KAAK0B,EAAsBvE,IACtDxK,KAAK0J,OAAO8D,gBAAkB,EAC9BxN,KAAKqQ,WAAWhP,MAAMrB,KAAMuI,EAAc,GAAIH,EAAOkI,IAAO,KANxDtQ,KAAKyQ,eAAeH,EAAM9F,EAAI6H,WAAY7H,EAAInD,KAAKiB,QAQ3D8G,EAAY3P,UAAUqT,wBAA0B,SAAUtI,EAAK8F,GAC3D,IAAIX,EAAQ3P,KACR4T,EAAcrV,OAAO0D,KAAKuI,EAAInD,KAAKwM,yBACnCC,EAAgBvV,OAAO0D,KAAKuI,EAAInD,KAAK0M,2BACrCC,EAAiBxJ,EAAInD,KAAK4M,gBAC1BC,EAAiB,IAAIrR,IAAI+Q,GACzBO,EAAmB,IAAItR,IAAIiR,GAC3BM,EAAoB,IAAIvR,IAAImR,GAC5BN,EAAQpD,EAAKE,QAAO,SAAUP,EAASwB,GACvC,KAAKxB,EAAQrP,MAAMyT,SAAWH,EAAeP,IAAI1D,EAAQrP,MAAMyT,UAC1DpE,EAAQrP,MAAM0T,WAAaH,EAAiBR,IAAI1D,EAAQrP,MAAM0T,YAOnE,OAHIF,EAAkBT,IAAIlC,KACtBxB,EAAQG,QAAUT,EAAML,kBAErB,EANHK,EAAMc,eAAe,CAACR,GAAUzF,EAAI6H,WAAY7H,EAAInD,KAAKiB,UAQ7DoL,EAAM5S,OAAS,GAEfd,KAAK0J,OAAOE,eAAeyD,KAAK0B,EAAsBvE,IAE1DxK,KAAKqQ,WAAWhP,MAAMrB,KAAMuI,EAAc,GAAIH,EAAOsL,IAAQ,KAEjEtE,EAAY3P,UAAUsT,oBAAsB,SAAUzC,GAClD,IAAIX,EAAQ3P,KACZA,KAAKqQ,WAAWhP,MAAMrB,KAAMuI,EAAc,GAAIH,EAAOkI,EAAKjH,KAAI,SAAU4G,GAEpE,OADAA,EAAQG,QAAUH,EAAQC,SAAWP,EAAMN,aACpCY,OACN,KAETb,EAAY3P,UAAUgR,eAAiB,SAAUH,EAAM9D,EAAMC,GACzDzM,KAAK6P,aACLS,EAAKrP,SAAQ,SAAUgP,GAAW,OAAOA,EAAQE,SAAS5D,EAAY0D,EAAQrP,MAAO4L,EAAMC,QAQ/F2C,EAAY3P,UAAUoQ,WAAa,WAC/B,GAAK7P,KAAK0J,OAAO4E,gBAAjB,CAGA,IAAI2D,EAASpQ,MAAM4G,KAAKzI,KAAKU,MAAM2I,KAAI,SAAU4G,GAAW,OAAOA,EAAQrP,UACtEZ,KAAK0J,OAAO4E,gBAAgBI,IAAI1O,KAAKuP,WAAY0C,KAEnD7C,EAhRqB,GGhBrBmF,EAAO,SAAUC,GACxB,OAAOA,GAEEA,EAEO,GADFpD,KAAKqD,UAEFD,EAAI,GACRE,SAAS,KAEb7O,OAAO,KACJA,QAAQ,KACRA,QAAQ,KACRA,QAAQ,KACRA,QAAQ,OACPoE,QAEL,SACAsK,KFxBZ,SAAWtF,GAEPA,EAAuB,IAAI,OAC3BA,EAA4B,SAAI,WAEhCA,EAAuB,IAAI,OAC3BA,EAA0B,OAAI,UAC9BA,EAA2B,QAAI,WAC/BA,EAA0B,OAAI,UAE9BA,EAA6B,UAAI,aACjCA,EAA8B,WAAI,cAElCA,EAAyB,MAAI,SAC7BA,EAA6B,UAAI,YAdrC,CAeGA,IAAsBA,EAAoB,KAE7C,SAAWC,GACPA,EAAoC,mBAAI,aACxCA,EAAkC,iBAAI,YACtCA,EAA+B,cAAI,SACnCA,EAA8B,aAAI,eAClCA,EAAyB,QAAI,WALjC,CAMGA,IAAoBA,EAAkB,KAMzC,SAAWC,GACPA,EAA2B,SAAI,YAC/BA,EAAiC,eAAI,iBACrCA,EAA0B,QAAI,iBAHlC,CAIGA,IAAqBA,EAAmB,KGjC3C,ICEQ1F,EDDGkL,EAAgB,SAAU9Q,GACjC,GAAItF,OAAO0D,KAAK4B,GAAY/C,OAFR,IAGhB,OAAO,EAEX,IAAK,IAAI1B,KAAOyE,EAAY,CAExB,IAAI/E,EAAQ+E,EAAWzE,GACvB,IAAKwV,EAAkBxV,EAAKN,GACxB,OAAO,EAEf,OAAO,GAEA8V,EAAoB,SAAUpV,EAAUV,GAC/C,IAAIkL,EAAKtG,EACT,GAAwB,iBAAblE,EACP,OAAO,EACX,GAAIqC,MAAMC,QAAQhD,GAAQ,CACtB,IAAI+V,GAAU,EACd,IACI,IAAK,IAAIC,EAAU3M,EAASrJ,GAAQiW,EAAYD,EAAQ/N,QAASgO,EAAU7N,KAAM6N,EAAYD,EAAQ/N,OAAQ,CACzG,IAAIiO,EAAeD,EAAUjW,MAC7B,GAAI+C,MAAMC,QAAQkT,GACd,OAAO,EAEN,GAA4B,iBAAjBA,EACZH,EAAUA,GAAWF,EAAcK,QAElC,IAAK,CAAC,SAAU,UAAUlG,gBAAgBkG,GAC3C,OAAO,EAEX,IAAKH,EACD,OAAO,GAInB,MAAO1K,GAASH,EAAM,CAAE1B,MAAO6B,GAC/B,QACI,IACQ4K,IAAcA,EAAU7N,OAASxD,EAAKoR,EAAQ1K,SAAS1G,EAAG1F,KAAK8W,GAEvE,QAAU,GAAI9K,EAAK,MAAMA,EAAI1B,YAGhC,IAAIxJ,QACL,OAAO,EAEN,GAAqB,iBAAVA,EAEZ,OAAO6V,EAAc7V,GAEpB,IAAK,CAAC,SAAU,SAAU,WAAWgQ,gBAAgBhQ,GACtD,OAAO,EAEX,OAAO,GEnDP,EAA0B,WAC1B,SAASmW,IACLjV,KAAKkV,aAAe,IAAIrS,IACxB7C,KAAKmV,YAAc,GAiFvB,OA/EAF,EAASxV,UAAU2V,kBAAoB,WACnC,OAAOlU,EAAS,GAAIlB,KAAKmV,cAE7BF,EAASxV,UAAUiP,IAAM,SAAUlP,EAAUV,GAEzC,OADAkB,KAAKqV,SAASpG,EAAkBqG,IAAK9V,EAAUV,GACxCkB,MAEXiV,EAASxV,UAAU8V,QAAU,SAAU/V,EAAUV,GAE7C,OADAkB,KAAKqV,SAASpG,EAAkBuG,SAAUhW,EAAUV,GAC7CkB,MAEXiV,EAASxV,UAAUgW,OAAS,SAAUjW,EAAUV,GAE5C,OADAkB,KAAKqV,SAASpG,EAAkByG,OAAQlW,EAAUV,GAC3CkB,MAEXiV,EAASxV,UAAUkW,QAAU,SAAUnW,EAAUV,GAE7C,OADAkB,KAAKqV,SAASpG,EAAkB2G,QAASpW,EAAUV,GAC5CkB,MAEXiV,EAASxV,UAAUoW,WAAa,SAAUrW,EAAUV,GAEhD,OADAkB,KAAKqV,SAASpG,EAAkB6G,WAAYtW,EAAUV,GAC/CkB,MAEXiV,EAASxV,UAAUsW,UAAY,SAAUvW,EAAUV,GAE/C,OADAkB,KAAKqV,SAASpG,EAAkB+G,UAAWxW,EAAUV,GAC9CkB,MAEXiV,EAASxV,UAAUwW,OAAS,SAAUzW,EAAUV,GAE5C,OADAkB,KAAKqV,SAASpG,EAAkBiH,OAAQ1W,EAAUV,GAC3CkB,MAEXiV,EAASxV,UAAUgF,IAAM,SAAUjF,EAAUV,GAEzC,OADAkB,KAAKqV,SAASpG,EAAkBkH,IAAK3W,EAAUV,GACxCkB,MAEXiV,EAASxV,UAAU2W,MAAQ,SAAU5W,GAEjC,OADAQ,KAAKqV,SAASpG,EAAkBoH,MAAO7W,EV7CtB,KU8CVQ,MAEXiV,EAASxV,UAAU6W,SAAW,WAI1B,OAFAtW,KAAKmV,YAAc,GACnBnV,KAAKmV,YAAYlG,EAAkBsH,WVnDlB,IUoDVvW,MAGXiV,EAASxV,UAAU4V,SAAW,SAAUmB,EAAWhX,EAAUV,GACzD,GAAIkB,KAAKyW,UAAUD,EAAWhX,EAAUV,GAAQ,CAE5C,IAAI4X,EAAkB1W,KAAKmV,YAAYqB,GASvC,YARwBnW,IAApBqW,IACAA,EAAkB,GAElB1W,KAAKmV,YAAYqB,GAAaE,GAGlCA,EAAgBlX,GAAYV,EAC5BkB,KAAKkV,aAAazQ,IAAIjF,IACf,EAEX,OAAO,GAEXyV,EAASxV,UAAUgX,UAAY,SAAUD,EAAWhX,EAAUV,GAC1D,YAAsDuB,IAAlDL,KAAKmV,YAAYlG,EAAkBsH,cAInCvW,KAAKkV,aAAavB,IAAInU,KAItBgX,IAAcvH,EAAkBkH,IACR,iBAAVrX,EAEd0X,IAAcvH,EAAkBoH,OAASG,IAAcvH,EAAkBiH,QAClEtB,EAAkBpV,EAAUV,MAIpCmW,EApFkB,GCDzB,EAAyB,WACzB,SAAS0B,IACL3W,KAAK4W,UAAY,GACjB5W,KAAK6W,SAAW,EAChB7W,KAAK8W,MAAQ,EAuCjB,OArCAH,EAAQlX,UAAUsX,aAAe,SAAUH,GAEvC,OADA5W,KAAK4W,UAAYA,EACV5W,MAEX2W,EAAQlX,UAAUuX,YAAc,SAAUH,GAItC,OAHIA,EAAW,IACX7W,KAAK6W,SAAWA,GAEb7W,MAEX2W,EAAQlX,UAAUwX,SAAW,SAAUH,GAEnC,OADA9W,KAAK8W,MAAQA,EACN9W,MAEX2W,EAAQlX,UAAUyX,eAAiB,SAAUC,GAEzC,OADAnX,KAAKmX,YAAcA,EACZnX,MAEX2W,EAAQlX,UAAU2X,WAAa,SAAUC,GAErC,OADArX,KAAKqX,QAAUA,EACRrX,MAEX2W,EAAQlX,UAAU6X,mBAAqB,SAAUzT,GAI7C,OAHI8Q,EAAc9Q,KACd7D,KAAK6D,WAAaA,GAEf7D,MAEX2W,EAAQlX,UAAU8X,mBAAqB,WACnC,IAAIC,EAAkBxX,KAAK6D,WAAa3C,EAAS,GAAIlB,KAAK6D,YAAc,GAMxE,OALA2T,EAAgBtI,EAAgBuI,oBAAsBzX,KAAK4W,UAC3DY,EAAgBtI,EAAgBwI,kBAAoB1X,KAAK6W,SACzDW,EAAgBtI,EAAgByI,eAAiB3X,KAAK8W,MACtDU,EAAgBtI,EAAgB0I,cAAgB5X,KAAKmX,YACrDK,EAAgBtI,EAAgB2I,SAAW7X,KAAKqX,QACzCG,GAEJb,EA3CiB,GCIjBmB,EAAsB,SAAUC,EAAUC,GAEjD,OADoB9W,EAASA,EAAS,GAAI8W,GAAe,CAAEC,WAAY9I,EAAiB+I,SAAUC,gBAAiBJ,EAAS3C,uBCL5H,EAA0B,WAC1B,SAASgD,EAAS3O,GACdzJ,KAAKyJ,OAASA,EACdzJ,KAAKU,MAAQ,GAEbV,KAAKqY,UAAW,EAGhBrY,KAAKsY,QAAU,GAmMnB,OAjMAF,EAAS3Y,UAAU8Y,SAAW,SAAUC,EAAQ9O,GAC5C,IAAIhG,EAAIC,EAAIG,EACZ,OAAOuC,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU+D,GAC/B,OAAQA,EAAG2D,OACP,KAAK,EAGD,OAFA8Q,EAAOpa,KAA8B,QAAtBsF,EAAK8U,EAAOpa,YAAyB,IAAPsF,EAAgBA,EAAK6Q,IAClEiE,EAAOnN,KAA8B,QAAtB1H,EAAK6U,EAAOnN,YAAyB,IAAP1H,EAAgBA,EAAK,aAC3D,CAAC,EAAsC,QAAvBG,EAAK0U,EAAO/I,aAA0B,IAAP3L,OAAgB,EAASA,EAAG9F,KAAKwa,EAAQ9O,EAAQ1J,KAAKyJ,SAChH,KAAK,EAGD,OAFA1F,EAAG4D,OACH3H,KAAKsY,QAAQvX,KAAKyX,GACX,CAAC,WAK5BJ,EAAS3Y,UAAUgZ,WAAa,SAAUC,GACtC,IAAIhV,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIyR,EAAO+G,EACX,OAAOpR,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EAID,OAHA+J,EAAQzR,KAAKsY,QAAQK,WAAU,SAAUH,GAAU,OAAOA,EAAOpa,OAASsa,KAC1EF,EAASxY,KAAKsY,QAAQ7G,GACtBzR,KAAKsY,QAAQM,OAAOnH,EAAO,GACpB,CAAC,EAAyC,QAA1B/N,EAAK8U,EAAOK,gBAA6B,IAAPnV,OAAgB,EAASA,EAAG1F,KAAKwa,IAC9F,KAAK,EAED,OADA7U,EAAGgE,OACI,CAAC,WAK5ByQ,EAAS3Y,UAAUqZ,MAAQ,SAAUrP,GACjCzJ,KAAKqY,UAAW,EACFrY,KAAKsY,QACXjP,KAAI,SAAUmP,GAAU,IAAI9U,EAAI,OAAkC,QAA1BA,EAAK8U,EAAOK,gBAA6B,IAAPnV,OAAgB,EAASA,EAAG1F,KAAKwa,MACnHxY,KAAKsY,QAAU,GACftY,KAAKyJ,OAASA,GAElB2O,EAAS3Y,UAAUsB,KAAO,SAAUH,GAChC,IAAI+O,EAAQ3P,KACZ,OAAO,IAAI0G,SAAQ,SAAUC,GACzBgJ,EAAMjP,MAAMK,KAAK,CAACH,EAAO+F,IACzBgJ,EAAMoJ,cAAc,OAG5BX,EAAS3Y,UAAUsZ,cAAgB,SAAU3I,GACzC,IAAIT,EAAQ3P,KACRA,KAAKqY,WAETrY,KAAKqY,UAAW,EAChB3H,YAAW,WACFf,EAAMtO,MAAMsO,EAAMjP,MAAMsY,SAAS7R,MAAK,WACvCwI,EAAM0I,UAAW,EACb1I,EAAMjP,MAAMI,OAAS,GACrB6O,EAAMoJ,cAAc,QAG7B3I,KAEPgI,EAAS3Y,UAAU4B,MAAQ,SAAU4X,GACjC,OAAO5S,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI0D,EAAI9C,EAAO+C,EAAIgD,EAASiF,EAAQsN,EAAUC,EAAuBhP,EAAOiP,EAAYC,EAAcC,EAAgBd,EAAQvS,EAAG0E,EAAO4O,EAAaC,EACjJxP,EAAKlG,EAAIyG,EAAKxG,EAClB,OAAOqD,EAAYpH,MAAM,SAAUgE,GAC/B,OAAQA,EAAG0D,OACP,KAAK,EACD,IAAKuR,EACD,MAAO,CAAC,GAEZvV,EAAK0E,EAAO6Q,EAAM,GAAIrY,EAAQ8C,EAAG,GACjCC,EAAKyE,EAAO6Q,EAAM,GAAItS,EAAUhD,EAAG,GACnCiI,EAAS5L,KAAKsY,QAAQ9H,QAAO,SAAUgI,GAAU,MAAuB,WAAhBA,EAAOnN,QAC/DrH,EAAG0D,MAAQ,EACf,KAAK,EACD1D,EAAG4D,KAAK7G,KAAK,CAAC,EAAG,EAAG,EAAG,IACvBmY,EAAW/Q,EAASyD,GAASuN,EAAaD,EAASnS,OACnD/C,EAAG0D,MAAQ,EACf,KAAK,EACD,OAAMyR,EAAWjS,KAAa,CAAC,EAAa,IAC5CsR,EAASW,EAAWra,OAERiR,QAIL,CAAC,EAAayI,EAAOzI,QAAQ7O,EAAS,GAAIN,KAFtC,CAAC,EAAa,GAG7B,KAAK,EAED,GAAU,QADVqF,EAAIjC,EAAG2D,QAGH,OADAhB,EAAQ,CAAE/F,MAAOA,EAAO4L,KAAM,EAAGC,QAAS,KACnC,CAAC,GAGR7L,EAAQqF,EAEZjC,EAAG0D,MAAQ,EACf,KAAK,EAED,OADAyR,EAAaD,EAASnS,OACf,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,EAAa,GAC7B,KAAK,EAGD,OAFAoD,EAAQnG,EAAG2D,OACXqC,EAAM,CAAE1B,MAAO6B,GACR,CAAC,EAAa,GACzB,KAAK,EACD,IACQgP,IAAeA,EAAWjS,OAASpD,EAAKoV,EAAS9O,SAAStG,EAAG9F,KAAKkb,GAE1E,QAAU,GAAIlP,EAAK,MAAMA,EAAI1B,MAC7B,MAAO,CAAC,GACZ,KAAK,EACD8Q,EAAapZ,KAAKsY,QAAQ9H,QAAO,SAAUgI,GAAU,MAAuB,eAAhBA,EAAOnN,WAAyChL,IAAhBmY,EAAOnN,QACnGrH,EAAG0D,MAAQ,EACf,KAAK,EACD1D,EAAG4D,KAAK7G,KAAK,CAAC,EAAG,GAAI,GAAI,KACzBsY,EAAelR,EAASiR,GAAaE,EAAiBD,EAAatS,OACnE/C,EAAG0D,MAAQ,GACf,KAAK,GACD,OAAM4R,EAAepS,KAAa,CAAC,EAAa,KAChDsR,EAASc,EAAexa,OAEZiR,QAIL,CAAC,EAAayI,EAAOzI,QAAQ7O,EAAS,GAAIN,KAFtC,CAAC,EAAa,IAG7B,KAAK,GAED,GAAU,QADVqF,EAAIjC,EAAG2D,QAGH,OADAhB,EAAQ,CAAE/F,MAAOA,EAAO4L,KAAM,EAAGC,QAAS,KACnC,CAAC,GAGR7L,EAAQqF,EAEZjC,EAAG0D,MAAQ,GACf,KAAK,GAED,OADA4R,EAAiBD,EAAatS,OACvB,CAAC,EAAa,IACzB,KAAK,GAAI,MAAO,CAAC,EAAa,IAC9B,KAAK,GAGD,OAFA4D,EAAQ3G,EAAG2D,OACX4C,EAAM,CAAEjC,MAAOqC,GACR,CAAC,EAAa,IACzB,KAAK,GACD,IACQ2O,IAAmBA,EAAepS,OAASnD,EAAKsV,EAAajP,SAASrG,EAAG/F,KAAKqb,GAEtF,QAAU,GAAI9O,EAAK,MAAMA,EAAIjC,MAC7B,MAAO,CAAC,GACZ,KAAK,GAUD,OATAiR,EAAcvZ,KAAKsY,QAAQ9H,QAAO,SAAUgI,GAAU,MAAuB,gBAAhBA,EAAOnN,QACpEmO,EAAsBD,EAAYlQ,KAAI,SAAUmP,GAC5C,IAAIiB,EAAavY,EAAS,GAAIN,GAC9B,OAAO4X,EAAOzI,QAAQ0J,GAAYzJ,OAAM,SAAU/J,GAAK,OAAOsG,EAAYkN,EAAY,EAAG5T,OAAOI,UAE/FS,QAAQoJ,IAAI0J,GAAqBrS,MAAK,SAAUzD,GACjD,IAAwBuD,EAAfmB,EAAO1E,EAAI,GAAgB,GACpCiD,EAAQM,MAEL,CAAC,WAK5BmR,EAAS3Y,UAAUmR,MAAQ,WACvB,OAAOvK,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIU,EAAO6Y,EAAaC,EACpB7J,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAGD,OAFAhH,EAAQV,KAAKU,MACbV,KAAKU,MAAQ,GACN,CAAC,EAAagG,QAAQoJ,IAAIpP,EAAM2I,KAAI,SAAU4P,GAAQ,OAAOtJ,EAAMtO,MAAM4X,QACpF,KAAK,EAMD,OALAvV,EAAGiE,OACH4R,EAAcvZ,KAAKsY,QAAQ9H,QAAO,SAAUgI,GAAU,MAAuB,gBAAhBA,EAAOnN,QACpEmO,EAAsBD,EAAYlQ,KAAI,SAAUmP,GAC5C,OAAOA,EAAO5H,OAAS4H,EAAO5H,WAE3B,CAAC,EAAalK,QAAQoJ,IAAI0J,IACrC,KAAK,EAED,OADA9V,EAAGiE,OACI,CAAC,WAKrByQ,EA3MkB,GCGzB,EAA+B,WAC/B,SAASsB,EAActb,QACN,IAATA,IAAmBA,EAAO,YAC9B4B,KAAK2Z,cAAe,EACpB3Z,KAAK4Z,EAAI,GACT5Z,KAAK6Z,UAAY,GACjB7Z,KAAKW,SAAWX,KAAK8Z,MAAMza,KAAKW,MAChCA,KAAK+Z,SAAW,IAAI,EAAS/Z,MAC7BA,KAAK5B,KAAOA,EAqJhB,OAnJAsb,EAAcja,UAAUua,MAAQ,SAAUtQ,GACtC,OAAOrD,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAGD,OAFA1H,KAAK0J,OAASA,EACd1J,KAAK+Z,SAASjB,MAAM9Y,MACb,CAAC,EAAaA,KAAKia,mBAAmB,MACjD,KAAK,EAED,OADAvW,EAAGiE,OACI,CAAC,WAK5B+R,EAAcja,UAAUwa,mBAAqB,SAAUC,GACnD,OAAO7T,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIma,EAAiBC,EAAmBC,EAAqClQ,EACzEH,EAAKtG,EACT,OAAO0D,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EACDyS,EAAkBna,KAAKka,GACvBla,KAAKka,GAAa,GAClBvW,EAAG+D,MAAQ,EACf,KAAK,EACD/D,EAAGiE,KAAK7G,KAAK,CAAC,EAAG,EAAG,EAAG,IACvBqZ,EAAoBjS,EAASgS,GAAkBE,EAAsBD,EAAkBrT,OACvFpD,EAAG+D,MAAQ,EACf,KAAK,EACD,OAAM2S,EAAoBnT,KAAa,CAAC,EAAa,GAE9C,CAAC,GADRoT,EAAiBD,EAAoBvb,UAEzC,KAAK,EACD6E,EAAGgE,OACHhE,EAAG+D,MAAQ,EACf,KAAK,EAED,OADA2S,EAAsBD,EAAkBrT,OACjC,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,EAAa,GAC7B,KAAK,EAGD,OAFAoD,EAAQxG,EAAGgE,OACXqC,EAAM,CAAE1B,MAAO6B,GACR,CAAC,EAAa,GACzB,KAAK,EACD,IACQkQ,IAAwBA,EAAoBnT,OAASxD,EAAK0W,EAAkBhQ,SAAS1G,EAAG1F,KAAKoc,GAErG,QAAU,GAAIpQ,EAAK,MAAMA,EAAI1B,MAC7B,MAAO,CAAC,GACZ,KAAK,EAAG,MAAO,CAAC,WAKhCoR,EAAcja,UAAUqa,MAAQ,SAAUS,EAAY/C,EAAiBQ,GACnE,IAAIpX,EFrEkB,SAAU2Z,EAAY/C,EAAiBQ,GAEjE,OAAO9W,EAASA,EAASA,EAAS,GADI,iBAAfqZ,EAA0B,CAAEtC,WAAYsC,GAAeA,GAC5BvC,GAAgBR,GAAmB,CAAEgD,iBAAkBhD,IEmEzFiD,CAAiBF,EAAY/C,EAAiBQ,GAC1D,OAAO7L,EAAcnM,KAAK0a,SAAS9Z,KAEvC8Y,EAAcja,UAAUsY,SAAW,SAAUA,EAAUC,GACnD,IAAIpX,EAAQkX,EAAoBC,EAAUC,GAC1C,OAAO7L,EAAcnM,KAAK0a,SAAS9Z,KAEvC8Y,EAAcja,UAAUkb,cAAgB,SAAUC,EAAWC,EAAW9C,EAAUC,GAC9E,IAAIpX,EFrE0B,SAAUga,EAAWC,EAAW9C,EAAUC,GAC5E,IAAItU,EAIJ,OAHoBxC,EAASA,EAAS,GAAI8W,GAAe,CAAEC,WAAY9I,EAAiB2L,eAAgBC,iBAAkBhD,EAAS3C,oBAAqB4F,QAAStX,EAAK,GAC9JA,EAAGkX,GAAaC,EAChBnX,KEiEQuX,CAAyBL,EAAWC,EAAW9C,EAAUC,GACrE,OAAO7L,EAAcnM,KAAK0a,SAAS9Z,KAEvC8Y,EAAcja,UAAUyb,SAAW,SAAUN,EAAWC,EAAW7C,GAC/D,IAAIpX,EFlEkB,SAAUga,EAAWC,EAAW7C,GAC1D,IAAItU,EACAqU,EAAW,IAAI,EAKnB,OAJAA,EAASrJ,IAAIkM,EAAWC,GACP3Z,EAASA,EAAS,GAAI8W,GAAe,CAAEC,WAAY9I,EAAiB+I,SAAUC,gBAAiBJ,EAAS3C,oBAAqB4F,QAAStX,EAAK,GACpJA,EAAGkX,GAAaC,EAChBnX,KE4DQyX,CAAiBP,EAAWC,EAAW7C,GACnD,OAAO7L,EAAcnM,KAAK0a,SAAS9Z,KAEvC8Y,EAAcja,UAAU4X,QAAU,SAAUA,EAASW,GACjD,IAAIpX,EF7DoB,SAAUyW,EAASW,GAC/C,OAAO9W,EAASA,EAAS,GAAI8W,GAAe,CAAEC,WAAY9I,EAAiB0I,QAAS2C,iBAAkBnD,EAAQE,uBE4D9F6D,CAAmB/D,EAASW,GACxC,OAAO7L,EAAcnM,KAAK0a,SAAS9Z,KAEvC8Y,EAAcja,UAAUgF,IAAM,SAAU+T,GACpC,OAAKxY,KAAK0J,OAIHyC,EAAcnM,KAAK+Z,SAASxB,SAASC,EAAQxY,KAAK0J,UAHrD1J,KAAK4Z,EAAE7Y,KAAKf,KAAKyE,IAAIpF,KAAKW,KAAMwY,IACzBrM,MAIfuN,EAAcja,UAAUwW,OAAS,SAAUyC,GACvC,OAAK1Y,KAAK0J,OAIHyC,EAAcnM,KAAK+Z,SAAStB,WAAWC,KAH1C1Y,KAAK4Z,EAAE7Y,KAAKf,KAAKiW,OAAO5W,KAAKW,KAAM0Y,IAC5BvM,MAIfuN,EAAcja,UAAU4b,qBAAuB,SAAUza,EAAOuP,GAC5D,IAAKnQ,KAAK0J,OACN,OAAOyG,EAAS5D,EAAY3L,EAAO,EfrGX,2BeuGvBZ,KAAKsb,QAAQ1a,GAAOuG,KAAKgJ,IAElCuJ,EAAcja,UAAUib,SAAW,SAAU9Z,GACzC,OAAOyF,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI2P,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,OAAK1D,KAAK0J,OAKH,CAAC,EAAc1J,KAAKsb,QAAQ1a,IAJxB,CAAC,EAAc,IAAI8F,SAAQ,SAAUC,GACpCgJ,EAAMkK,UAAU9Y,KAAK4O,EAAM0L,qBAAqBhc,KAAKsQ,EAAO/O,EAAO+F,eAO3F+S,EAAcja,UAAU6b,QAAU,SAAU1a,GACxC,OAAOyF,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAYuK,EAAKkC,EAASxF,EAC1B,OAAOG,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAGD,OAFAhE,EAAGkE,KAAK7G,KAAK,CAAC,EAAG,EAAG,CAAE,IAElBf,KAAK0J,OAAOgE,OACL,CAAC,EAAcnB,EAAY3L,EAAO,EflIxC,uCeoIE,CAAC,EAAaZ,KAAK+Z,SAAShZ,KAAKH,IAC5C,KAAK,EAKD,OAHgB,OADhBqG,EAASvD,EAAGiE,QACL6E,KACDxM,KAAK0J,OAAOE,eAAeqD,IAAIhG,EAAOwF,SACtCzM,KAAK0J,OAAOE,eAAetB,MAAMrB,EAAOwF,SACvC,CAAC,EAAcxF,GAC1B,KAAK,EAKD,OAJAsD,EAAM7G,EAAGiE,OACT8E,EAAU5G,OAAO0E,GACjBvK,KAAK0J,OAAOE,eAAetB,MAAMmE,GAE1B,CAAC,EADRxF,EAASsF,EAAY3L,EAAO,EAAG6L,IAEnC,KAAK,EAAG,MAAO,CAAC,WAKhCiN,EAAcja,UAAU8b,UAAY,SAAU7N,GACrC1N,KAAK0J,OAIV1J,KAAK0J,OAAOgE,OAAS8N,QAAQ9N,GAHzB1N,KAAK4Z,EAAE7Y,KAAKf,KAAKub,UAAUlc,KAAKW,KAAMwb,QAAQ9N,MAKtDgM,EAAcja,UAAUmR,MAAQ,WAC5B,OAAOzE,EAAcnM,KAAK+Z,SAASnJ,UAEhC8I,EA7JuB,G,YCLvB+B,EAAwB,SAAUrW,GAEzC,YADqB,IAAjBA,IAA2BA,EAAe,qBACvC,IAAmBD,YAAYC,ICDtC,EAAqC,WACrC,SAASsW,IACL1b,KAAK5B,KAAO,WACZ4B,KAAKqL,KAAO,SACZrL,KAAKgF,cAAgByW,IAAwBzW,cAwBjD,OAtBA0W,EAAoBjc,UAAUsQ,QAAU,SAAUE,GAC9C,OAAO5J,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI2C,EACJ,OAAOyE,EAAYpH,MAAM,SAAU0D,GAK/B,OAJAf,EAAiBsN,EAAQkI,kBAErBnY,KAAKgF,cAAclC,eAAeS,qBAAqBZ,GAAgBwB,SAEpE,CAAC,EAAc8L,UAIlCyL,EAAoBjc,UAAUgQ,MAAQ,SAAU/F,GAC5C,OAAOrD,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAI/B,OAHIgG,EAAOtE,eACPpF,KAAKgF,cAAgByW,EAAsB/R,EAAOtE,cAAcJ,eAE7D,CAAC,UAIb0W,EA5B6B,GCGpCC,EAAoB,SAAUC,EAAiBhb,GAC/C,MAA+B,kBAApBgb,EACAA,GAEwF,KAA9FA,aAAyD,EAASA,EAAgBhb,KAKhFib,EAA+B,SAAUD,GAChD,OAAOD,EAAkBC,EAAiB,gBAEnCE,EAAgC,SAAUF,GACjD,OAAOD,EAAkBC,EAAiB,kBAEnCG,EAAmC,SAAUH,GACpD,OAAOD,EAAkBC,EAAiB,qBAEnCI,EAA4B,SAAUJ,GAC7C,OAAOD,EAAkBC,EAAiB,cAEnCK,EAA2B,SAAUL,GAC5C,OAAOD,EAAkBC,EAAiB,aAEnCM,EAA4B,SAAUxS,GAC7C,IAEIyS,EAFAC,EAAU,WAAc,OAAO,GAC/BC,OAAsBhc,EAqB1B,OAnBuC2b,EAA0BtS,EAAOkS,mBAEpEQ,OAAU/b,EACV8b,OAAY9b,EACRqJ,EAAOkS,iBAC2B,iBAA3BlS,EAAOkS,iBACdlS,EAAOkS,gBAAgBU,WACqB,iBAArC5S,EAAOkS,gBAAgBU,YAC1B,YAAa5S,EAAOkS,gBAAgBU,YACpCF,EAAU1S,EAAOkS,gBAAgBU,UAAUF,SAE3C,wBAAyB1S,EAAOkS,gBAAgBU,YAChDD,EAAsB3S,EAAOkS,gBAAgBU,UAAUD,qBAEvD,cAAe3S,EAAOkS,gBAAgBU,WAAa5S,EAAOkS,gBAAgBU,UAAUH,YACpFA,EAAYzS,EAAOkS,gBAAgBU,UAAUH,aAIlD,CACHC,QAASA,EACTC,oBAAqBA,EACrBF,UAAWA,IC5CRI,EAAiC,SAAUC,EAAU9b,GAC5D,IAAK,IAAI7C,EAAI,EAAGA,EAAI6C,EAAMI,OAAQjD,IAAK,CACnC,IAAI6F,EAAKhD,EAAM7C,GAAI4e,EAAS/Y,EAAGtF,KAAM8M,EAAOxH,EAAGwH,KAAMvE,EAAUjD,EAAGiD,QAC9DkE,EAAK2R,GAAYA,EAASC,GAC9B,GAAkB,mBAAP5R,EAAmB,CAC1B,IAAI5D,EAAS4D,EAAGxJ,MAAMmb,EAAUtR,GACT,mBAAZvE,GACPA,EAAQM,aAAuC,EAASA,EAAO4E,UAI3E,OAAO2Q,GAKAE,GAAkB,SAAUF,GAEnC,OADoBA,QACyBnc,IADzBmc,EACkBG,IC7B/Bzc,GAAc,WACrB,IAAIwD,EAAIC,EAAIG,EAAIC,EAChB,GAAyB,oBAAdxD,UACP,MAAO,GAEX,IAAIqc,EAAerc,UAAUqc,aAC7B,OAAwM,QAAhM7Y,EAAiJ,QAA3ID,EAAsF,QAAhFH,EAAoC,QAA9BD,EAAKnD,UAAUC,iBAA8B,IAAPkD,OAAgB,EAASA,EAAG,UAAuB,IAAPC,EAAgBA,EAAKpD,UAAUN,gBAA6B,IAAP6D,EAAgBA,EAAK8Y,SAAiC,IAAP7Y,EAAgBA,EAAK,ICArO,GAAyB,WACzB,SAAS8Y,IACL7c,KAAK5B,KAAO,oCACZ4B,KAAKqL,KAAO,SACZrL,KAAK8c,QAAU,gBAAgBlU,OCVlB,SDYY,oBAAdrI,YACPP,KAAK+c,UAAYxc,UAAUwc,WA6BnC,OA1BAF,EAAQpd,UAAUgQ,MAAQ,SAAU/F,GAEhC,OADA1J,KAAK0J,OAASA,EACPhD,QAAQC,aAAQtG,IAE3Bwc,EAAQpd,UAAUsQ,QAAU,SAAUE,GAClC,IAAIvM,EAAIC,EACR,OAAO0C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIuL,EAAMyR,EAAaC,EACvB,OAAO7V,EAAYpH,MAAM,SAAU8D,GAc/B,OAbAyH,GAAO,IAAIE,MAAOyR,UAClBF,EAAiD,QAAlCtZ,EAAK1D,KAAK0J,OAAOsT,mBAAgC,IAAPtZ,EAAgBA,GAAM,EAC/EuZ,EAA0C,QAA3BtZ,EAAKsM,EAAQkN,gBAA6B,IAAPxZ,EAAgBA,EAAKqZ,EAAc,EACrFhd,KAAK0J,OAAOsT,YAAcC,EACrBhN,EAAQ1E,OACTvL,KAAK0J,OAAO0T,cAAgB7R,GAQzB,CAAC,EANArK,EAASA,EAASA,EAASA,EAASA,EAASA,EAASA,EAASA,EAAS,CAAEmT,QAASrU,KAAK0J,OAAOvG,OAAQmR,UAAWtU,KAAK0J,OAAOrG,SAAUga,WAAYrd,KAAK0J,OAAO4T,UAAW/R,KAAMA,GAASvL,KAAK0J,OAAO6T,YAAc,CAAEC,YAAaxd,KAAK0J,OAAO6T,aAAiBvd,KAAK0J,OAAO+T,gBAAgBtd,UAAY,CAAEA,SA5B3S,QA4B4UH,KAAK0J,OAAO+T,gBAAgBxd,UAAY,CAAEA,SAAUC,OAAoBF,KAAK0J,OAAO+T,gBAAgBC,WAAa,CAAEC,GA3Brc,YA2Byd,CAAEC,UAAWrJ,IAAQsJ,WAAY7d,KAAK0J,OAAOoU,UAAW1P,KAAMpO,KAAK0J,OAAO0E,OAAUpO,KAAK0J,OAAO2E,mBAAqB,CAC3kB0P,mBAAoB,CAChBC,YAAahe,KAAK0J,OAAO2E,kBAAkB4P,WAC3CC,eAAgBle,KAAK0J,OAAO2E,kBAAkB8P,iBAEjDlO,GAAU,CAAEkN,SAAUF,EAAaH,QAAS9c,KAAK8c,QAASsB,WAAYpe,KAAK+c,oBAKrFF,EApCiB,GELxB,GAA+B,WAC/B,SAASwB,IACLre,KAAKse,cAAgB,IAAIC,IAqD7B,OAnDAF,EAAc5e,UAAU+e,UAAY,WAChC,OAAOnY,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,MAAO,CAAC,GAAc,UAIlC2a,EAAc5e,UAAUf,IAAM,SAAUU,GACpC,OAAOiH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,MAAO,CAAC,EAAc1D,KAAKse,cAAc5f,IAAIU,WAIzDif,EAAc5e,UAAUgf,OAAS,SAAUrf,GACvC,OAAOiH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIlB,EACJ,OAAOsI,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAAG,MAAO,CAAC,EAAa1H,KAAKtB,IAAIU,IACtC,KAAK,EAED,MAAO,CAAC,GADRN,EAAQ4E,EAAGiE,QACmBsE,KAAKC,UAAUpN,QAASuB,WAK1Ege,EAAc5e,UAAUiP,IAAM,SAAUtP,EAAKN,GACzC,OAAOuH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAE/B,OADA1D,KAAKse,cAAc5P,IAAItP,EAAKN,GACrB,CAAC,UAIpBuf,EAAc5e,UAAUwW,OAAS,SAAU7W,GACvC,OAAOiH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAE/B,OADA1D,KAAKse,cAAc3Z,OAAOvF,GACnB,CAAC,UAIpBif,EAAc5e,UAAUqZ,MAAQ,WAC5B,OAAOzS,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAE/B,OADA1D,KAAKse,cAAcI,QACZ,CAAC,UAIbL,EAvDuB,GCAvBM,GAAgB,SAAUzQ,EAAQ0Q,EAASC,GAGlD,YAFgB,IAAZD,IAAsBA,EAAU,SACtB,IAAVC,IAAoBA,EAAQ,IACzB,CAACxS,EAAkBuS,EAAS1Q,EAAO0B,UAAU,EAAGiP,IAAQrO,OAAOgL,SAASpO,KAAK,M,aCH7E0R,GAAiB,WACxB,IAAIpb,EACAqb,EAAc,eAElB,OAAgG,QAAzFrb,EAAKqb,aAAiD,EAASA,EAAYC,gBAA6B,IAAPtb,OAAgB,EAASA,EAAGub,QAGxHF,EAAYC,SAASC,OAAOrP,UAAU,GAAGxG,MAAM,KAAKoH,OAAOgL,SACpDlK,QAAO,SAAU4N,EAAKC,GACrC,IAAIC,EAAQD,EAAK/V,MAAM,IAAK,GACxBhK,EAAMigB,GAAsBD,EAAM,IAClCtgB,EAAQugB,GAAsBD,EAAM,IACxC,OAAKtgB,GAGLogB,EAAI9f,GAAON,EACJogB,GAHIA,IAIZ,IAZQ,IAeJG,GAAwB,SAAUvgB,QAC3B,IAAVA,IAAoBA,EAAQ,IAChC,IACI,OAAOwgB,mBAAmBxgB,GAE9B,MAAO4E,GACH,MAAO,KCzBX,GAA+B,WAC/B,SAAS6b,EAAcxR,GACnB/N,KAAK+N,QAAU7M,EAAS,GAAI6M,GA8IhC,OA5IAwR,EAAc9f,UAAU+e,UAAY,WAChC,OAAOnY,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIwf,EAAcC,EAClB,OAAOrY,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EAED,IAAK,eACD,MAAO,CAAC,GAAc,GAE1B6X,EAAcG,UAAY7Z,OAAO4F,KAAKkU,OACtCH,EAAe,IAAID,EAAcvf,KAAK+N,SACtC0R,EAAU,WACV9b,EAAG+D,MAAQ,EACf,KAAK,EAED,OADA/D,EAAGiE,KAAK7G,KAAK,CAAC,EAAG,EAAG,EAAG,IAChB,CAAC,EAAaye,EAAa9Q,IAAI+Q,EAASF,EAAcG,YACjE,KAAK,EAED,OADA/b,EAAGgE,OACI,CAAC,EAAa6X,EAAa9gB,IAAI+gB,IAC1C,KAAK,EAED,MAAO,CAAC,EADA9b,EAAGgE,SACqB4X,EAAcG,WAClD,KAAK,EAGD,OAFK/b,EAAGgE,OAED,CAAC,GAAc,GAC1B,KAAK,EAAG,MAAO,CAAC,EAAa6X,EAAavJ,OAAOwJ,IACjD,KAAK,EAED,OADA9b,EAAGgE,OACI,CAAC,GACZ,KAAK,EAAG,MAAO,CAAC,WAKhC4X,EAAc9f,UAAUf,IAAM,SAAUU,GACpC,OAAOiH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIlB,EACJ,OAAOsI,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAAG,MAAO,CAAC,EAAa1H,KAAKye,OAAOrf,IACzC,KAAK,EAED,KADAN,EAAQ4E,EAAGiE,QAEP,MAAO,CAAC,OAActH,GAE1B,IACI,IACIvB,EAAQwgB,mBAAmBM,KAAK9gB,IAEpC,MAAO6E,IAIP,MAAO,CAAC,EAAcsI,KAAK4T,MAAM/gB,IAErC,MAAOgF,GAEH,MAAO,CAAC,OAAczD,GAE1B,MAAO,CAAC,WAK5Bkf,EAAc9f,UAAUgf,OAAS,SAAUrf,GACvC,IAAIsE,EAAIC,EACR,OAAO0C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI+e,EAAae,EAAQC,EACzB,OAAO3Y,EAAYpH,MAAM,SAAU8D,GAI/B,OAHAib,EAAc,eACde,EAAqK,QAA3Jnc,EAA+F,QAAzFD,EAAKqb,aAAiD,EAASA,EAAYiB,gBAA6B,IAAPtc,OAAgB,EAASA,EAAGoc,OAAO1W,MAAM,aAA0B,IAAPzF,EAAgBA,EAAK,IAClMoc,EAAQD,EAAOG,MAAK,SAAU/hB,GAAK,OAAgC,IAAzBA,EAAEgI,QAAQ9G,EAAM,SAInD,CAAC,EAAc2gB,EAAMnQ,UAAUxQ,EAAI0B,OAAS,IAFxC,CAAC,OAAcT,UAMtCkf,EAAc9f,UAAUiP,IAAM,SAAUtP,EAAKN,GACzC,IAAI4E,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIkgB,EAAgBC,EAASC,EAAYC,EAAMC,EAAKvB,EACpD,OAAO3X,EAAYpH,MAAM,SAAU2D,GAC/B,IACIuc,EAAwD,QAAtCxc,EAAK1D,KAAK+N,QAAQmS,sBAAmC,IAAPxc,EAAgBA,EAAK,EAErF0c,OAAa/f,GADb8f,EAAoB,OAAVrhB,EAAiBohB,GAAkB,MAGzCG,EAAO,IAAI5U,MACN8U,QAAQF,EAAKnD,UAAsB,GAAViD,EAAe,GAAK,GAAK,KACvDC,EAAaC,GAEjBC,EAAM,GAAG1X,OAAOxJ,EAAK,KAAKwJ,OAAO4X,KAAKC,mBAAmBxU,KAAKC,UAAUpN,MACpEshB,IACAE,GAAO,aAAa1X,OAAOwX,EAAWM,gBAE1CJ,GAAO,WACHtgB,KAAK+N,QAAQ4S,SACbL,GAAO,YAAY1X,OAAO5I,KAAK+N,QAAQ4S,SAEvC3gB,KAAK+N,QAAQ6S,SACbN,GAAO,YAEPtgB,KAAK+N,QAAQ8S,WACbP,GAAO,cAAc1X,OAAO5I,KAAK+N,QAAQ8S,YAE7C9B,EAAc,kBAEVA,EAAYiB,SAASF,OAASQ,GAGtC,MAAOxc,IAGP,MAAO,CAAC,UAIpByb,EAAc9f,UAAUwW,OAAS,SAAU7W,GACvC,OAAOiH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAAG,MAAO,CAAC,EAAa1H,KAAK0O,IAAItP,EAAK,OAC3C,KAAK,EAED,OADAsE,EAAGiE,OACI,CAAC,WAK5B4X,EAAc9f,UAAUqZ,MAAQ,WAC5B,OAAOzS,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,MAAO,CAAC,UAIb6b,EAhJuB,GCE9B,GAA+B,WAC/B,SAASuB,KA4FT,OA1FAA,EAAcrhB,UAAUoS,KAAO,SAAUkP,EAAYC,GACjD,OAAOta,QAAQC,QAAQ,OAE3Bma,EAAcrhB,UAAUwhB,cAAgB,SAAUC,GAC9C,IAAIxd,EAAIC,EAAIG,EAAIC,EAAIC,EAAIC,EAAIC,EAAIid,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAI9E,EAAI+E,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EACxF,GAA4B,iBAAjBd,EACP,OAAO,KAEX,IAAI7O,EAAa6O,EAAa1U,MAAQ,EAClC8F,EAAStS,KAAKiiB,YAAY5P,GAC9B,OAAQC,GACJ,KAAKvJ,EAAOwJ,QACR,MAAO,CACHD,OAAQA,EACRD,WAAYA,EACZhL,KAAM,CACF6a,eAAwD,QAAvCxe,EAAKwd,EAAaiB,uBAAoC,IAAPze,EAAgBA,EAAK,EACrF0e,iBAA6D,QAA1Cze,EAAKud,EAAamB,0BAAuC,IAAP1e,EAAgBA,EAAK,EAC1F2e,iBAA6D,QAA1Cxe,EAAKod,EAAaqB,0BAAuC,IAAPze,EAAgBA,EAAK,IAGtG,KAAKiF,EAAO0J,QACR,MAAO,CACHH,OAAQA,EACRD,WAAYA,EACZhL,KAAM,CACFiB,MAAqC,QAA7BvE,EAAKmd,EAAa5Y,aAA0B,IAAPvE,EAAgBA,EAAK,GAClEiP,aAAoD,QAArChP,EAAKkd,EAAasB,qBAAkC,IAAPxe,EAAgBA,EAAK,GACjFoP,wBAA4E,QAAlDnP,EAAKid,EAAauB,kCAA+C,IAAPxe,EAAgBA,EAAK,GACzGoP,wBAA4E,QAAlDnP,EAAKgd,EAAawB,kCAA+C,IAAPxe,EAAgBA,EAAK,GACzGoP,2BAAmF,QAAtD6N,EAAKD,EAAayB,sCAAmD,IAAPxB,EAAgBA,EAAK,GAChHyB,aAAoD,QAArCxB,EAAKF,EAAa2B,qBAAkC,IAAPzB,EAAgBA,EAAK,EACjFrN,0BAAgF,QAApDsN,EAAKH,EAAa4B,oCAAiD,IAAPzB,EAAgBA,EAAK,GAC7G0B,gBAA0D,QAAxCzB,EAAKJ,EAAa8B,wBAAqC,IAAP1B,EAAgBA,EAAK,GACvF/N,eAAwD,QAAvCgO,EAAKL,EAAa+B,uBAAoC,IAAP1B,EAAgBA,EAAK,GACrF2B,iBAA4D,QAAzC1B,EAAKN,EAAaiC,yBAAsC,IAAP3B,EAAgBA,EAAK,GACzFvN,gBAA0D,QAAxCwN,EAAKP,EAAakC,wBAAqC,IAAP3B,EAAgBA,EAAK,KAGnG,KAAK1Y,EAAO4J,gBACR,MAAO,CACHL,OAAQA,EACRD,WAAYA,EACZhL,KAAM,CACFiB,MAAqC,QAA7BqU,EAAKuE,EAAa5Y,aAA0B,IAAPqU,EAAgBA,EAAK,KAG9E,KAAK5T,EAAO8J,UACR,MAAO,CACHP,OAAQA,EACRD,WAAYA,EACZhL,KAAM,CACFiB,MAAqC,QAA7BoZ,EAAKR,EAAa5Y,aAA0B,IAAPoZ,EAAgBA,EAAK,GAClEkB,aAAoD,QAArCjB,EAAKT,EAAa2B,qBAAkC,IAAPlB,EAAgBA,EAAK,EACjFuB,iBAA4D,QAAzCtB,EAAKV,EAAaiC,yBAAsC,IAAPvB,EAAgBA,EAAK,GACzFyB,eAAwD,QAAvCxB,EAAKX,EAAaoC,uBAAoC,IAAPzB,EAAgBA,EAAK,GACrF9N,0BAAgF,QAApD+N,EAAKZ,EAAa4B,oCAAiD,IAAPhB,EAAgBA,EAAK,GAC7GjO,wBAA4E,QAAlDkO,EAAKb,EAAaqC,kCAA+C,IAAPxB,EAAgBA,EAAK,GACzG9N,gBAA0D,QAAxC+N,EAAKd,EAAakC,wBAAqC,IAAPpB,EAAgBA,EAAK,KAGnG,KAAKjZ,EAAOya,QACZ,QACI,MAAO,CACHlR,OAAQA,EACRD,WAAYA,KAI5ByO,EAAcrhB,UAAUwiB,YAAc,SAAUzV,GAC5C,OAAIA,GAAQ,KAAOA,EAAO,IACfzD,EAAOwJ,QAEL,MAAT/F,EACOzD,EAAO8J,UAEL,MAATrG,EACOzD,EAAO4J,gBAEL,MAATnG,EACOzD,EAAOya,QAEdhX,GAAQ,KAAOA,EAAO,IACfzD,EAAO0J,QAEdjG,GAAQ,IACDzD,EAAO0a,OAEX1a,EAAO2D,SAEXoU,EA7FuB,GCF9B,GAAgC,SAAU4C,GAE1C,SAASC,IACL,OAAkB,OAAXD,GAAmBA,EAAOriB,MAAMrB,KAAMoB,YAAcpB,KA+B/D,OAjCA2F,EAAUge,EAAgBD,GAI1BC,EAAelkB,UAAUoS,KAAO,SAAUlE,EAAWmE,GACjD,OAAOzL,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI+N,EAAmB6V,EACvB,OAAOxc,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAED,GAAqB,oBAAVmc,MACP,MAAM,IAAI3a,MAAM,mCAUpB,OARA6E,EAAU,CACN+V,QAAS,CACL,eAAgB,mBAChBC,OAAQ,OAEZ1c,KAAM4E,KAAKC,UAAU4F,GACrBkS,OAAQ,QAEL,CAAC,EAAaH,MAAMlW,EAAWI,IAC1C,KAAK,EAED,MAAO,CAAC,EADGrK,EAAGiE,OACgBsc,QAClC,KAAK,EAED,OADAL,EAAkBlgB,EAAGiE,OACd,CAAC,EAAc3H,KAAKihB,cAAc2C,YAKtDD,EAlCwB,CAmCjC,ICpCE,GAAgC,WAChC,SAASO,EAAeC,GACpBnkB,KAAKmkB,QAAUA,EAgHnB,OA9GAD,EAAezkB,UAAU+e,UAAY,WACjC,OAAOnY,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIyU,EAAQ2P,EAAa3E,EACzB,OAAOrY,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EAED,IAAK1H,KAAKmkB,QACN,MAAO,CAAC,GAAc,GAE1B1P,EAAS5O,OAAO4F,KAAKkU,OACrByE,EAAc,IAAIF,EAAelkB,KAAKmkB,SACtC1E,EAAU,WACV9b,EAAG+D,MAAQ,EACf,KAAK,EAED,OADA/D,EAAGiE,KAAK7G,KAAK,CAAC,EAAG,EAAG,EAAG,IAChB,CAAC,EAAaqjB,EAAY1V,IAAI+Q,EAAShL,IAClD,KAAK,EAED,OADA9Q,EAAGgE,OACI,CAAC,EAAayc,EAAY1lB,IAAI+gB,IACzC,KAAK,EAED,MAAO,CAAC,EADA9b,EAAGgE,SACqB8M,GACpC,KAAK,EAGD,OAFK9Q,EAAGgE,OAED,CAAC,GAAc,GAC1B,KAAK,EAAG,MAAO,CAAC,EAAayc,EAAYnO,OAAOwJ,IAChD,KAAK,EAED,OADA9b,EAAGgE,OACI,CAAC,GACZ,KAAK,EAAG,MAAO,CAAC,WAKhCuc,EAAezkB,UAAUf,IAAM,SAAUU,GACrC,OAAOiH,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIlB,EACJ,OAAOsI,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EAED,OADA/D,EAAGiE,KAAK7G,KAAK,CAAC,EAAG,EAAG,CAAE,IACf,CAAC,EAAaf,KAAKye,OAAOrf,IACrC,KAAK,EAED,OADAN,EAAQ6E,EAAGgE,QAKJ,CAAC,EAAcsE,KAAK4T,MAAM/gB,IAHtB,CAAC,OAAcuB,GAI9B,KAAK,EAGD,OAFKsD,EAAGgE,OACRwF,QAAQ7E,MAAM,uDACP,CAAC,OAAcjI,GAC1B,KAAK,EAAG,MAAO,CAAC,WAKhC6jB,EAAezkB,UAAUgf,OAAS,SAAUrf,GACxC,IAAIsE,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU2D,GAC/B,MAAO,CAAC,GAAuC,QAAvBD,EAAK1D,KAAKmkB,eAA4B,IAAPzgB,OAAgB,EAASA,EAAG2gB,QAAQjlB,UAASiB,UAIhH6jB,EAAezkB,UAAUiP,IAAM,SAAUtP,EAAKN,GAC1C,IAAI4E,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU2D,GAC/B,IAC4B,QAAvBD,EAAK1D,KAAKmkB,eAA4B,IAAPzgB,GAAyBA,EAAG4gB,QAAQllB,EAAK6M,KAAKC,UAAUpN,IAE5F,MAAOgF,IAGP,MAAO,CAAC,UAIpBogB,EAAezkB,UAAUwW,OAAS,SAAU7W,GACxC,IAAIsE,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU2D,GAC/B,IAC4B,QAAvBD,EAAK1D,KAAKmkB,eAA4B,IAAPzgB,GAAyBA,EAAG6gB,WAAWnlB,GAE3E,MAAO0E,IAGP,MAAO,CAAC,UAIpBogB,EAAezkB,UAAUqZ,MAAQ,WAC7B,IAAIpV,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU2D,GAC/B,IAC4B,QAAvBD,EAAK1D,KAAKmkB,eAA4B,IAAPzgB,GAAyBA,EAAGgb,QAEhE,MAAO5a,IAGP,MAAO,CAAC,UAIbogB,EAlHwB,GCE/B,GAA8B,SAAUR,GAExC,SAASc,IACL,IAAI9gB,EACJ,OAAOggB,EAAO1lB,KAAKgC,KAAkC,QAA3B0D,EAAK,sBAAqC,IAAPA,OAAgB,EAASA,EAAG+gB,eAAiBzkB,KAE9G,OALA2F,EAAU6e,EAAcd,GAKjBc,EANsB,CAO/B,ICPE,GAAgC,SAAUd,GAE1C,SAASgB,IACL,IAAIhhB,EACJ,OAAOggB,EAAO1lB,KAAKgC,KAAkC,QAA3B0D,EAAK,sBAAqC,IAAPA,OAAgB,EAASA,EAAGihB,iBAAmB3kB,KAEhH,OALA2F,EAAU+e,EAAgBhB,GAKnBgB,EANwB,CAOjC,ICRE,GAA8B,SAAUhB,GAExC,SAASkB,IACL,IAAIjV,EAAmB,OAAX+T,GAAmBA,EAAOriB,MAAMrB,KAAMoB,YAAcpB,KAIhE,OAHA2P,EAAMkV,MAAQ,CACV3d,KAAM,GAEHyI,EAkCX,OAxCAhK,EAAUif,EAAclB,GAQxBkB,EAAanlB,UAAUoS,KAAO,SAAUlE,EAAWmE,GAC/C,OAAOzL,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI2P,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,MAAO,CAAC,EAAc,IAAIgD,SAAQ,SAAUC,EAASC,GAEf,oBAAnBke,gBACPle,EAAO,IAAIsC,MAAM,mCAErB,IAAI6b,EAAM,IAAID,eACdC,EAAIC,KAAK,OAAQrX,GAAW,GAC5BoX,EAAIE,mBAAqB,WACrB,GAAIF,EAAIG,aAAevV,EAAMkV,MAAM3d,KAC/B,IACI,IAAI0c,EAAkBmB,EAAII,aAEtBC,EAAwBnZ,KAAK4T,MAAM+D,GACnC3c,EAAS0I,EAAMsR,cAAcmE,GACjCze,EAAQM,GAEZ,MAAOhB,GACHW,EAAOX,KAInB8e,EAAIM,iBAAiB,eAAgB,oBACrCN,EAAIM,iBAAiB,SAAU,OAC/BN,EAAIlT,KAAK5F,KAAKC,UAAU4F,eAKrC8S,EAzCsB,CA0C/B,ICzCE,GAAqC,SAAUlB,GAE/C,SAAS4B,IACL,OAAkB,OAAX5B,GAAmBA,EAAOriB,MAAMrB,KAAMoB,YAAcpB,KAgC/D,OAlCA2F,EAAU2f,EAAqB5B,GAI/B4B,EAAoB7lB,UAAUoS,KAAO,SAAUlE,EAAWmE,GACtD,OAAOzL,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAI2P,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,MAAO,CAAC,EAAc,IAAIgD,SAAQ,SAAUC,EAASC,GAC7C,IAAImY,EAAc,eAElB,KAAMA,aAAiD,EAASA,EAAYxe,UAAUglB,YAClF,MAAM,IAAIrc,MAAM,wCAEpB,IACI,IAAIsc,EAAOvZ,KAAKC,UAAU4F,GAE1B,OACWnL,EAFGoY,EAAYxe,UAAUglB,WAAW5X,EAAW1B,KAAKC,UAAU4F,IAEtDnC,EAAMsR,cAAc,CAC/BzU,KAAM,IACN2V,gBAAiBrQ,EAAQG,OAAOnR,OAChCuhB,mBAAoBmD,EAAK1kB,OACzByhB,mBAAoB9W,KAAKkU,QAGlBhQ,EAAMsR,cAAc,CAAEzU,KAAM,OAE/C,MAAOvG,GACHW,EAAOX,eAMxBqf,EAnC6B,CAoCtC,ICrCSG,GAAqB,SAAUvX,EAAQwX,EAAeC,GAE7D,YAD4B,IAAxBA,IAAkCA,GAAsB,GACrDtf,OAAU,OAAQ,OAAQ,GAAQ,WACrC,IAAIuf,EAAYC,EAASniB,EAAIL,EAAUF,EAAQuK,EAAQ4P,EAAWF,EAAeJ,EACjF,OAAO5V,EAAYpH,MAAM,SAAU2D,GAC/B,OAAQA,EAAG+D,OACP,KAAK,EAED,OADAke,EVHU,SAAU1X,GACpC,MAAO,GAAGtF,OAAOyD,EAAiByZ,cAAe,KAAKld,OAAOsF,EAAO0B,UAAU,EAAG,IUEpDmW,CAAiB7X,GACvB,CAAC,EAAawX,EAAcjH,OAAOmH,IAC9C,KAAK,EAED,OADAC,EAAUliB,EAAGgE,QAMRge,EACE,CAAC,EAAaD,EAAczP,OAAO2P,IADT,CAAC,EAAa,GAJpC,CAAC,EAAc,CACdlY,QAAQ,IAKxB,KAAK,EACD/J,EAAGgE,OACHhE,EAAG+D,MAAQ,EACf,KAAK,EAED,OADAhE,EAAK0E,EAAOyd,EAAQzc,MAAM,KAAM,GAAI/F,EAAWK,EAAG,GAAIP,EAASO,EAAG,GAAIgK,EAAShK,EAAG,GAAI4Z,EAAY5Z,EAAG,GAAI0Z,EAAgB1Z,EAAG,GAAIsZ,EAActZ,EAAG,GAC1I,CAAC,EAAc,CACdL,SAAUA,EACVF,OAAQ6iB,GAAO7iB,GACfma,UAAW2I,GAAU3I,GACrBN,YAAaiJ,GAAUjJ,GACvBI,cAAe6I,GAAU7I,GACzB1P,OAAQ8N,QAAQ9N,aAMjCuY,GAAY,SAAUC,GAC7B,IAAIC,EAAUC,SAASF,EAAK,IAC5B,IAAIG,MAAMF,GAGV,OAAOA,GAEAH,GAAS,SAAUlnB,GAC1B,GAAK8gB,MAAS0G,QAAWxnB,EAGzB,IACI,OAAOwgB,mBAAmBgH,OAAO1G,KAAK9gB,KAE1C,MAAO4E,GACH,SClDG6iB,IAD0B,GAAG3d,OADN,cACmC,gBAC/B,GAAGA,OAFP,cAEoC,kBAC3D4d,GAA4B,GAAG5d,OAHR,cAGqC,mBAC5D6d,GAA8B,GAAG7d,OAJV,cAIuC,oBAG9D8d,GAAiB,GAAG9d,OAPG,cAO0B,mBACjD+d,GAAY,GAAG/d,OARQ,cAQqB,cAC5Cge,GAAU,GAAGhe,OATU,cASmB,YAC1Cie,GAAY,GAAGje,OAVQ,cAUqB,cAC5Cke,GAAW,GAAGle,OAXS,cAWoB,aAC3Cme,GAAU,GAAGne,OAZU,cAYmB,YAC1Coe,GAAY,GAAGpe,OAbQ,cAaqB,cAC5Cqe,GAAmB,GAAGre,OAdC,cAc4B,qBCH1D,GAA+B,SAAU8a,GAEzC,SAASwD,EAAchZ,EAAQqP,EAAYmI,EAAeyB,EAAevL,EAAiBvY,EAAUoK,EAAqBF,EAAiBC,EAAgB4Z,EAAiB/Y,EAAmBjJ,EAAc4X,EAAaI,EAAexT,EAAgBC,EAAUsE,EAAaT,EAAQoQ,EAAW1P,EAAMT,EAAWC,EAAY0P,EAAW+J,EAAgB/Y,EAAiBmP,EAAiB6J,EAAWzZ,EAAU1K,QACvX,IAAlBuiB,IAA4BA,EAAgB,IAAI,SAC9B,IAAlByB,IAA4BA,EAAgB,CAC5CxG,OAAQ,GACR4G,WAAY,IACZ1G,SAAU,MACVD,QAAQ,EACR4G,SAAS,SAEW,IAApB5L,IAA8BA,GAAkB,QACxB,IAAxBnO,IAAkCA,EAAsB,UACpC,IAApBF,IAA8BA,EAAkB,QAC7B,IAAnBC,IAA6BA,EAAiB,SAC1B,IAApB4Z,IAA8BA,EDXJ,eCYP,IAAnBxd,IAA6BA,EAAiB,IAAI,QACrC,IAAbC,IAAuBA,EAAWf,EAASkE,WAChC,IAAXU,IAAqBA,GAAS,QAChB,IAAdC,IAAwBA,EAAY,SACrB,IAAfC,IAAyBA,EDfJ,WCgBF,IAAnByZ,IAA6BA,EAAiB,WAC1B,IAApB/Y,IAA8BA,EAAkB,IAAI,SAChC,IAApBmP,IAA8BA,EAAkB,CAChDC,WAAW,EACXzd,UAAU,EACVE,UAAU,SAEI,IAAdmnB,IAAwBA,EAAY,cACvB,IAAbzZ,IAAuBA,GAAW,GACtC,IAAI8B,EAAQ+T,EAAO1lB,KAAKgC,KAAM,CAAEkO,OAAQA,EAAQI,gBAAiBA,EAAiBC,kBAAmBkZ,GAAgBH,MAAiBtnB,KAgCtI,OA/BA2P,EAAMzB,OAASA,EACfyB,EAAM4N,WAAaA,EACnB5N,EAAMwX,cAAgBA,EACtBxX,EAAMiM,gBAAkBA,EACxBjM,EAAMlC,oBAAsBA,EAC5BkC,EAAMpC,gBAAkBA,EACxBoC,EAAMnC,eAAiBA,EACvBmC,EAAMyX,gBAAkBA,EACxBzX,EAAMtB,kBAAoBA,EAC1BsB,EAAMvK,aAAeA,EACrBuK,EAAM/F,eAAiBA,EACvB+F,EAAM9F,SAAWA,EACjB8F,EAAMxB,YAAcA,EACpBwB,EAAMmO,UAAYA,EAClBnO,EAAMvB,KAAOA,EACbuB,EAAMhC,UAAYA,EAClBgC,EAAM/B,WAAaA,EACnB+B,EAAM0X,eAAiBA,EACvB1X,EAAMrB,gBAAkBA,EACxBqB,EAAM8N,gBAAkBA,EACxB9N,EAAM2X,UAAYA,EAClB3X,EAAM9B,SAAWA,EACjB8B,EAAM3B,SAAU,EAChB2B,EAAM+X,eAAiBhC,EACvB/V,EAAMtM,SAAWA,EACjBsM,EAAMqN,YAAcA,EACpBrN,EAAMyN,cAAgBA,EACtBzN,EAAMjC,OAASA,EACfiC,EAAM2N,UAAYA,EAClB3N,EAAMxM,OAASA,EACfwM,EAAM/F,eAAemD,OAAO4C,EAAM9F,UAC3B8F,EAwGX,OArKAhK,EAAUuhB,EAAexD,GA+DzBnlB,OAAOC,eAAe0oB,EAAcznB,UAAW,gBAAiB,CAC5Df,IAAK,WACD,OAAOsB,KAAK0nB,gBAEhBhZ,IAAK,SAAUgX,GACP1lB,KAAK0nB,iBAAmBhC,IACxB1lB,KAAK0nB,eAAiBhC,EACtB1lB,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBpQ,OAAOC,eAAe0oB,EAAcznB,UAAW,WAAY,CACvDf,IAAK,WACD,OAAOsB,KAAK4nB,WAEhBlZ,IAAK,SAAUrL,GACPrD,KAAK4nB,YAAcvkB,IACnBrD,KAAK4nB,UAAYvkB,EACjBrD,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBpQ,OAAOC,eAAe0oB,EAAcznB,UAAW,SAAU,CACrDf,IAAK,WACD,OAAOsB,KAAK6nB,SAEhBnZ,IAAK,SAAUvL,GACPnD,KAAK6nB,UAAY1kB,IACjBnD,KAAK6nB,QAAU1kB,EACfnD,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBpQ,OAAOC,eAAe0oB,EAAcznB,UAAW,YAAa,CACxDf,IAAK,WACD,OAAOsB,KAAK8nB,YAEhBpZ,IAAK,SAAU4O,GACPtd,KAAK8nB,aAAexK,IACpBtd,KAAK8nB,WAAaxK,EAClBtd,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBpQ,OAAOC,eAAe0oB,EAAcznB,UAAW,SAAU,CACrDf,IAAK,WACD,OAAOsB,KAAKgO,SAEhBU,IAAK,SAAUhB,GACP1N,KAAKgO,UAAYN,IACjB1N,KAAKgO,QAAUN,EACf1N,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBpQ,OAAOC,eAAe0oB,EAAcznB,UAAW,gBAAiB,CAC5Df,IAAK,WACD,OAAOsB,KAAK+nB,gBAEhBrZ,IAAK,SAAU0O,GACPpd,KAAK+nB,iBAAmB3K,IACxBpd,KAAK+nB,eAAiB3K,EACtBpd,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBpQ,OAAOC,eAAe0oB,EAAcznB,UAAW,cAAe,CAC1Df,IAAK,WACD,OAAOsB,KAAKgoB,cAEhBtZ,IAAK,SAAUsO,GACPhd,KAAKgoB,eAAiBhL,IACtBhd,KAAKgoB,aAAehL,EACpBhd,KAAK2nB,kBAGblpB,YAAY,EACZkQ,cAAc,IAElBuY,EAAcznB,UAAUkoB,cAAgB,WACpC,IAAIM,EAAQ,CACR5kB,SAAUrD,KAAK4nB,UACfzkB,OAAQnD,KAAK6nB,QACbvK,UAAWtd,KAAK8nB,WAChBpa,OAAQ1N,KAAKgO,QACboP,cAAepd,KAAK+nB,eACpB/K,YAAahd,KAAKgoB,cAEjBhoB,KAAK0lB,cAAchX,IAAIiQ,GAAc3e,KAAKkO,QAAS+Z,IAErDf,EAtKuB,CAuKhCpZ,GAESoa,GAAmB,SAAUha,EAAQH,EAASoa,GAErD,YADgB,IAAZpa,IAAsBA,EAAU,IAC7B1H,OAAU,OAAQ,OAAQ,GAAQ,WACrC,IAAI+gB,EAAiBD,EAAezjB,EAAIC,EAAIG,EAAI4hB,EAAe0C,EAAeC,EAAiBC,EAAajlB,EAAU2Z,EAAaI,EAAe1P,EAAQ4P,EAAWna,EAAQsa,EACzK1Z,EACAC,EAAIC,EAAIC,EAAIid,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAI9E,EAAI+E,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EACpE,OAAO3a,EAAYpH,MAAM,SAAUgiB,GAC/B,OAAQA,EAAGta,OACP,KAAK,EAID,OAHA0f,EAAkBrZ,EAAQqZ,iBD9KR,SC+KlB1jB,EAAK,CAACxC,EAAS,GAAI6M,EAAQoZ,gBAC3BpjB,EAAK,GDhLa,WCiLZqjB,EAAsD,CAAC,EAAa,IAC1EzjB,EAAK,GACE,CAAC,EAAa,IACzB,KAAK,EACD,OAA6F,QAAtFM,EAAsC,QAAhCD,EAAK+J,EAAQoZ,qBAAkC,IAAPnjB,OAAgB,EAASA,EAAG2c,cAA2B,IAAP1c,EAAuB,CAAC,EAAa,IAC1IH,EAAKG,EACE,CAAC,EAAa,IACzB,KAAK,EAAG,MAAO,CAAC,EAAaskB,MAC7B,KAAK,EACDzkB,EAAMke,EAAGra,OACTqa,EAAGta,MAAQ,EACf,KAAK,EACD/D,EAAKG,EACLke,EAAGta,MAAQ,EACf,KAAK,EAGD,OAFAyf,EAAgBjmB,EAASG,WAAM,EAAQqC,EAAGkF,OAAO,EAAE7E,EAAG4c,OAAShd,EAAII,EAAGwjB,WAAa,IAAKxjB,EAAG8c,SAAW,MAAO9c,EAAG6c,QAAS,EAAO7c,EAAGyjB,SAAU,EAAMzjB,MACnJ2hB,EAAgB8C,GAAoBza,EAAQqZ,gBAAiBD,GACtD,CAAC,EAAa1B,GAAmBvX,EAAQwX,EAAuG,QAAvFvE,EAAsC,QAAhCjd,EAAK6J,EAAQoZ,qBAAkC,IAAPjjB,OAAgB,EAASA,EAAGsjB,eAA4B,IAAPrG,GAAgBA,IACnL,KAAK,EAED,OADAiH,EAAgBpG,EAAGra,OACZ,CAAC,EAAa+d,EAAchnB,IAAIigB,GAAczQ,KACzD,KAAK,EAYD,OAXAma,EAAkBrG,EAAGra,OACrB2gB,EAAcxJ,KACdzb,EAAsS,QAA1Rke,EAAiO,QAA3ND,EAA8F,QAAxFD,EAAiC,QAA3BD,EAAKrT,EAAQ1K,gBAA6B,IAAP+d,EAAgBA,EAAKkH,EAAYjlB,gBAA6B,IAAPge,EAAgBA,EAAKgH,aAAyD,EAASA,EAAgBhlB,gBAA6B,IAAPie,EAAgBA,EAAK8G,EAAc/kB,gBAA6B,IAAPke,EAAgBA,EAAKhN,IACnUyI,EAAuH,QAAxGwE,EAAK6G,aAAyD,EAASA,EAAgBrL,mBAAgC,IAAPwE,EAAgBA,EAAK4G,EAAcpL,YAClKI,EAA2H,QAA1GqE,EAAK4G,aAAyD,EAASA,EAAgBjL,qBAAkC,IAAPqE,EAAgBA,EAAK2G,EAAchL,cACtK1P,EAAoK,QAA1JgU,EAA+B,QAAzB/E,EAAK5O,EAAQL,cAA2B,IAAPiP,EAAgBA,EAAK0L,aAAyD,EAASA,EAAgB3a,cAA2B,IAAPgU,EAAgBA,EAAK0G,EAAc1a,OAC/M4P,EAAmH,QAAtGqE,EAAK0G,aAAyD,EAASA,EAAgB/K,iBAA8B,IAAPqE,EAAgBA,EAAKyG,EAAc9K,UAC9Jna,EAAoK,QAA1J0e,EAA+B,QAAzBD,EAAK7T,EAAQ5K,cAA2B,IAAPye,EAAgBA,EAAKyG,aAAyD,EAASA,EAAgBllB,cAA2B,IAAP0e,EAAgBA,EAAKuG,EAAcjlB,OAC/MglB,EAAkBM,wBAAgI,QAArG3G,EAAKuG,aAAyD,EAASA,EAAgBhlB,gBAA6B,IAAPye,EAAgBA,EAAKsG,EAAc/kB,SAC7L8kB,EAAkBO,sBAA4H,QAAnG3G,EAAKsG,aAAyD,EAASA,EAAgBllB,cAA2B,IAAP4e,EAAgBA,EAAKqG,EAAcjlB,OACzLsa,EAAkBvc,EAASA,EAAS,GAAI6M,EAAQ0P,iBAAkB,CAAEC,WAAW,EAAMzd,UAAU,EAAME,UAAU,IACxG,CAAC,EAAc,IAAI,GAAc+N,EAAQH,EAAQwP,WAAYmI,EAAeyB,EAAepZ,EAAQ6N,gBAAiBvY,EAAU0K,EAAQN,oBAAqBM,EAAQR,gBAAiBQ,EAAQP,eAAgB4Z,EAAiBrZ,EAAQM,kBAAmBN,EAAQ3I,aAAc4X,EAAaI,EAAerP,EAAQnE,eAAgBmE,EAAQlE,SAAUkE,EAAQI,YAAaT,EAAQK,EAAQ+P,UAAW/P,EAAQK,KAAML,EAAQJ,UAAWI,EAAQH,WAAY0P,EAAWvP,EAAQsZ,eAAgBtZ,EAAQO,gBAAiBmP,EAAiB1P,EAAQuZ,UAAWvZ,EAAQF,SAAU1K,YAK3jBqlB,GAAsB,SAAUpB,EAAiBD,GAGxD,YAFwB,IAApBC,IAA8BA,EDxNA,eCyNZ,IAAlBD,IAA4BA,EAAgB,IACxCC,GACJ,IAAK,eACD,OAAO,IAAI,GACf,IAAK,iBACD,OAAO,IAAI,GACf,IAAK,OACD,OAAO,IAAI,GACf,IAAK,SACL,QACI,OAAO,IAAI,GAAclmB,EAASA,EAAS,GAAIimB,GAAgB,CAAEjH,eAAgBiH,EAAcI,gBAGhGE,GAAkB,SAAUH,GACnC,MAAkB,QAAdA,EACO,IAAI,GAEG,WAAdA,EACO,IAAI,GAER,IAAI,IAEJiB,GAAoB,SAAUI,GAAO,OAAOtiB,OAAU,OAAQ,OAAQ,GAAQ,WACrF,IAAIuiB,EAAMC,EAAOC,EAAQvZ,EAAe1R,EAAG8iB,EAAiBwD,EAC5D,OAAO/c,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EAAG,MAAO,CAAC,GAAa,IAAI,IAAgB8W,aACjD,KAAK,EACD,IAAM9a,EAAGiE,SAAaghB,GAA2B,oBAAb3J,SAChC,MAAO,CAAC,EAAc,IAM1B,IAJA4J,EAAOD,QAAiCA,EAAM3J,SAAS+J,SACvDF,EAAQD,EAAKxf,MAAM,KACnB0f,EAAS,GACTvZ,EAAa,cACR1R,EAAIgrB,EAAM/nB,OAAS,EAAGjD,GAAK,IAAKA,EACjCirB,EAAO/nB,KAAK8nB,EAAMlgB,MAAM9K,GAAGuP,KAAK,MAEpCvP,EAAI,EACJ6F,EAAGgE,MAAQ,EACf,KAAK,EACD,OAAM7J,EAAIirB,EAAOhoB,QACjB6f,EAASmI,EAAOjrB,GAGT,CAAC,GADRsmB,EAAU,IAAI,GADJ,CAAExD,OAAQ,IAAMA,KAEGjS,IAAIa,EAAY,KAJZ,CAAC,EAAa,GAKnD,KAAK,EAED,OADA7L,EAAGiE,OACI,CAAC,EAAawc,EAAQzlB,IAAI6Q,IACrC,KAAK,EAED,OADQ7L,EAAGiE,OAEJ,CAAC,EAAawc,EAAQlO,OAAO1G,IADjB,CAAC,EAAa,GAErC,KAAK,EAED,OADA7L,EAAGiE,OACI,CAAC,EAAc,IAAMgZ,GAChC,KAAK,EAED,OADA9iB,IACO,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,EAAc,YCjR/BmrB,GAAgB,CACvBC,kBAAc5oB,EACd6oB,iBAAa7oB,EACb8oB,YAAQ9oB,EACR+oB,gBAAY/oB,EACZgpB,gBAAYhpB,EACZipB,cAAUjpB,EACVkpB,cAAUlpB,EACVmpB,sBAAkBnpB,EAClBopB,WAAOppB,EACPqpB,YAAQrpB,EACRspB,WAAOtpB,EACPupB,YAAQvpB,EACRwpB,iBAAaxpB,EACbypB,eAAWzpB,EACX0pB,aAAS1pB,EACT2pB,aAAS3pB,EACT4pB,YAAQ5pB,EACR6pB,YAAQ7pB,EACR8pB,YAAQ9pB,GClCR,GAAgC,WAChC,SAAS+pB,KA0DT,OAxDAA,EAAe3qB,UAAUogB,MAAQ,WAC7B,OAAOxZ,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,OAAOoH,EAAYpH,MAAM,SAAU0D,GAC/B,MAAO,CAAC,EAAcxC,EAASA,EAASA,EAASA,EAAS,GAAI8nB,IAAgBhpB,KAAKqqB,eAAgBrqB,KAAKsqB,eAAgBtqB,KAAKuqB,uBAIzIH,EAAe3qB,UAAU4qB,YAAc,WACnC,IAAIG,EAAS1L,KAOb,MAAO,CACHmK,aAPcuB,EAAmB,aAQjCtB,YAPasB,EAAkB,YAQ/BrB,OAPQqB,EAAa,OAQrBpB,WAPYoB,EAAiB,WAQ7BnB,WAPYmB,EAAiB,WAQ7BlB,SAPUkB,EAAe,WAUjCJ,EAAe3qB,UAAU6qB,YAAc,WACnC,IAAI5mB,EAAIC,EACJ6hB,EAAO,CACP+D,cAAUlpB,EACVmpB,sBAAkBnpB,GAEtB,IACImlB,EAAK+D,SAAWvJ,SAASuJ,eAAYlpB,EACrCmlB,EAAKgE,iBAAyG,QAArF7lB,EAA8B,QAAxBD,EAAK8hB,EAAK+D,gBAA6B,IAAP7lB,OAAgB,EAASA,EAAG0F,MAAM,KAAK,UAAuB,IAAPzF,EAAgBA,OAAKtD,EAE/I,MAAOyD,IAGP,OAAO0hB,GAEX4E,EAAe3qB,UAAU8qB,YAAc,WACnC,IAAI7mB,EACA8mB,EAAS1L,KACb,OAAOpb,EAAK,IACA,MAAI8mB,EAAY,MACxB9mB,EAAS,OAAI8mB,EAAa,OAC1B9mB,EAAS,OAAI8mB,EAAa,OAC1B9mB,EAAQ,MAAI8mB,EAAY,MACxB9mB,EAAc,YAAI8mB,EAAkB,YACpC9mB,EAAY,UAAI8mB,EAAgB,UAChC9mB,EAAU,QAAI8mB,EAAc,QAC5B9mB,EAAU,QAAI8mB,EAAc,QAC5B9mB,EAAS,OAAI8mB,EAAa,OAC1B9mB,EAAS,OAAI8mB,EAAa,OAC1B9mB,EAAS,OAAI8mB,EAAa,OAC1B9mB,GAED0mB,EA3DwB,GCK/BK,GAAyB,SAAU9J,GACnC,IAAIkI,EAAQlI,EAAOvX,MAAM,KACzB,OAAIyf,EAAM/nB,QAAU,EACT6f,EAEJkI,EAAMlgB,MAAMkgB,EAAM/nB,OAAS,EAAG+nB,EAAM/nB,QAAQsM,KAAK,MAYjDsd,GAAqB,SAAUC,EAAkBC,GAGxD,YAFyB,IAArBD,IAA+BA,EAAmB,SAC9B,IAApBC,IAA8BA,EAAkB,IAC7CD,EAAiBE,MAAK,SAAU/rB,GACnC,OAAOA,aAAiBgsB,OAAShsB,EAAMisB,KAAKH,GAAmB9rB,IAAU8rB,MC1BtEI,GAAuB,SAAUjd,GACxC,IAAI4B,EAAQ3P,KAyCZ,YAxCgB,IAAZ+N,IAAsBA,EAAU,IACvB,CACT3P,KAAM,4CACNiN,KAAM,SACNoE,MAAO,SAAU/F,EAAQuhB,GACrB,IAAIvnB,EACJ,OAAO2C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIkrB,EAAc/G,EAAS5U,EAAY5L,EAAIwnB,EAAiBC,EAAkBC,EAC9E,OAAOjkB,EAAYpH,MAAM,SAAU8D,GAC/B,OAAQA,EAAG4D,OACP,KAAK,EAKD,OAJAwjB,EAAehqB,EAAS,CAAEoqB,kBAAmB,QAASC,2BAA2B,EAAOZ,kBD6BjEa,EC7B+I,QAA/B9nB,EAAKgG,EAAOyd,qBAAkC,IAAPzjB,OAAgB,EAASA,EAAGid,OD8B9NA,EAAS6K,EACT7K,GACIA,EAAO1N,WAAW,OAClB0N,EAASA,EAAO/Q,UAAU,IAEvB,CAAC,IAAIkb,OAAO,GAAGliB,OAAO+X,EAAO1W,QAAQ,IAAK,OAAQ,QAEtD,KCrCsO8D,GACrNrE,EAAOE,eAAeqD,IAAI,yDAC1BkX,EAAUza,EAAOgc,cDfRxX,ECgBkBxE,EAAOwE,YDf1C,KADyB0Q,ECgByB,UDfxCA,EAAU,SACtB,IAAVC,IAAoBA,EAAQ,ICcRtP,EDbjB,CAAClD,EAAkBuS,EAAS1Q,EAAO0B,UAAU,EAAGiP,IAAQrO,OAAOgL,SAASpO,KAAK,KCcrD,CAAC,EAAa1G,QAAQoJ,IAAI,EACzB,IAAI,IAAiB+P,QACrBsE,EAAQzlB,IAAI6Q,MAExB,KAAK,EAYD,OAXA5L,EAAKyE,EAAO/G,WAAM,EAAQ,CAACyC,EAAG6D,OAAQ,IAAKwjB,EAAkBxnB,EAAG,GAAIynB,EAAmBznB,EAAG,GDV3F,SAAU8nB,EAASC,EAAU3d,GACrC0d,EAAQlC,SAAvB,IAAiCC,EAAmBiC,EAAQjC,iBAAkB2B,EAAkBnlB,EAAOylB,EAAS,CAAC,WAAY,qBACzH/nB,EAAKgoB,GAAY,GAAsCC,GAAbjoB,EAAG6lB,SAAgC7lB,EAAG8lB,kBAAkB4B,EAAmBplB,EAAOtC,EAAI,CAAC,WAAY,qBACjJ,GAAIgnB,GAAmB3c,EAAQ4c,iBAAkBc,EAAQjC,kBACrD,OAAO,EAEX,IAAIoC,EAAiB3f,KAAKC,UAAUif,KAAqBlf,KAAKC,UAAUkf,GACpES,EAAepB,GAAuBjB,GAAoB,MAAQiB,GAAuBkB,GAAuB,IACpH,OAAQD,GAAYE,GAAkBC,ECGVC,CAAcX,EAAiBC,EAAkBF,KAC7CA,EAAaK,4BACbN,EAAUc,aAAatgB,KAAKkU,OAC5BjW,EAAOE,eAAeqD,IAAI,4CAE9BvD,EAAOE,eAAeqD,IAAI,yBAC1Boe,EDAC,SAAUW,EAAUje,GACjD,IAAIke,EAAqB/qB,EAASA,EAAS,GAAI8nB,IAAgBgD,GAC3DE,EAAgB3tB,OAAO8D,QAAQ4pB,GAAoB3a,QAAO,SAAUyG,EAAUrU,GAC9E,IAAIC,EACAG,EAAKsE,EAAO1E,EAAI,GAAItE,EAAM0E,EAAG,GAAIhF,EAAQgF,EAAG,GAEhD,OADAiU,EAASxC,QAAQ,WAAW3M,OAAOxJ,GAAwF,QAAjFuE,EAAK7E,QAAqCA,EAAQiP,EAAQud,yBAAsC,IAAP3nB,EAAgBA,EAAK,SACpJ7E,EACOiZ,EAASrJ,IAAItP,EAAKN,GAEtBiZ,EAAS3B,MAAMhX,KACvB,IAAI,GACP,OAAO0Y,EAAoBoU,GCXiBC,CAAoBhB,EAAiBD,GACrDD,EAAUnR,MAAMuR,GACXlH,EAAQzV,IAAIa,EAAY4b,IAE1B,CAAC,GDjCT,IAAUjd,EAAQ0Q,EAASC,EA0CH2M,EAC3C7K,SCLA5Q,QAAS,SAAUnP,GAAS,OAAOyF,EAAUsJ,OAAO,OAAQ,GAAQ,WAAc,OAAOvI,EAAYpH,MAAM,SAAU0D,GACjH,MAAO,CAAC,EAAc9C,YC1CvBwrB,GAAgB,SAAUC,GACjC,IAAI/pB,EAAM,GACV,IAAK,IAAIlD,KAAOitB,EAAO,CACnB,IAAIC,EAAMD,EAAMjtB,GACZktB,IACAhqB,EAAIlD,GAAOktB,GAGnB,OAAOhqB,GCHAiqB,GAAyB,SAAUxe,GAE1C,IAAIkd,OADY,IAAZld,IAAsBA,EAAU,IAEpC,IAEIye,EAFAzN,EAAc,eACdnV,OAAiBvJ,EAEjBosB,EAAsB,WAAc,OAAOpmB,OAAU,OAAQ,OAAQ,GAAQ,WAC7E,IAAI3C,EACAC,EACAG,EACJ,OAAOsD,EAAYpH,MAAM,SAAU+D,GAC/B,OAAQA,EAAG2D,OACP,KAAK,EAKD,OAJA/D,EAAK,CACDsU,WAAyC,QAA5BnU,EAAKiK,EAAQoO,iBAA8B,IAAPrY,EAAgBA,EAAK,2BAE1EJ,EAAK,CAAC,IACC,CAAC,EAAagpB,MACzB,KAAK,EAAG,MAAO,CAAC,GAAe/oB,EAAG6W,iBAAmBtZ,EAASG,WAAM,EAAQ,CAACH,EAASG,WAAM,EAAQqC,EAAGkF,OAAO,CAAE7E,EAAG4D,UAAY,CAAE,0BACrE,oBAAbqX,UAA4BA,SAAS+J,UAAa,GAAI,4BACzC,oBAAb/J,UAA4BA,SAAS2N,MAAS,GAAI,wBACrC,oBAAb3N,UAA4BA,SAAS4N,UAAa,GAAI,yBAA0E,oBAAb5M,UAA4BA,SAAS6M,OAAU,GAAI,uBACzJ,oBAAb7N,UAA4BA,SAAS2N,KAAKvjB,MAAM,KAAK,IAAO,MACnGzF,YAIhBmpB,EAAwB,WACxB,YAAkC,IAApB/e,EAAQqO,SAAuD,mBAApBrO,EAAQqO,SAA0BrO,EAAQqO,WAGnG2Q,EAAkC,oBAAb/N,SAA2BA,SAAS2N,KAAO,KAChEK,EAAuB,WAAc,OAAO3mB,OAAU,OAAQ,OAAQ,GAAQ,WAC9E,IAAI4mB,EAAQC,EAAyBvpB,EAAIG,EACzC,OAAOsD,EAAYpH,MAAM,SAAU+D,GAC/B,OAAQA,EAAG2D,OACP,KAAK,EAQD,OAPAulB,EAASjO,SAAS2N,KAClBO,EAAsBC,GAA2Bpf,EAAQsO,oBAAqB4Q,EAAQF,GAAe,KAAOD,IAK5GC,EAAcE,EACTC,GAELtjB,SAAgEA,EAAeqD,IAAI,4BAC9E,MAACge,EAAoD,CAAC,EAAa,SACnE,EACE,CAAC,EAAa,KALY,CAAC,EAAa,GAMnD,KAAK,EAED,OADAnnB,GAAMH,EAAKsnB,GAAWnR,MACf,CAAC,EAAa2S,KACzB,KAAK,EACI3oB,EAAGzC,MAAMsC,EAAI,CAACI,EAAG4D,SACtB5D,EAAG2D,MAAQ,EACf,KAAK,EAED3D,EAAG2D,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,WAKxB0lB,EAA8B,WACzBJ,KAwET,MAtEa,CACT5uB,KAAM,+CACNiN,KAAM,aACNoE,MAAO,SAAU/F,EAAQD,GAAU,OAAOpD,OAAU,OAAQ,OAAQ,GAAQ,WACxE,IAAI3C,EAAIC,EACR,OAAOyD,EAAYpH,MAAM,SAAU8D,GAC/B,OAAQA,EAAG4D,OACP,KAAK,EAsBD,OArBAujB,EAAYxhB,GACZG,EAAiBF,EAAOE,gBACTqD,IAAI,2DACf8R,IACAA,EAAYsO,iBAAiB,WAAYD,GAGzCZ,EAAYzN,EAAYuO,QAAQd,UAMhCzN,EAAYuO,QAAQd,UAAY,IAAIe,MAAMxO,EAAYuO,QAAQd,UAAW,CACrEnrB,MAAO,SAAUmsB,EAAQlnB,EAAS5C,GAC9B,IAAIC,EAAKyE,EAAO1E,EAAI,GAAImhB,EAAQlhB,EAAG,GAAI8pB,EAAS9pB,EAAG,GAAIglB,EAAMhlB,EAAG,GAChE6pB,EAAOnsB,MAAMiF,EAAS,CAACue,EAAO4I,EAAQ9E,IACjCqE,QAIZF,KACLljB,EAAeqD,IAAI,4BACnBtJ,GAAMD,EAAKunB,GAAWnR,MACf,CAAC,EAAa2S,MAHgB,CAAC,EAAa,GAIvD,KAAK,EACD9oB,EAAGtC,MAAMqC,EAAI,CAACI,EAAG6D,SACjB7D,EAAG4D,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,WAI5BqI,QAAS,SAAUnP,GAAS,OAAOyF,OAAU,OAAQ,OAAQ,GAAQ,WACjE,IAAIqnB,EACJ,OAAOtmB,EAAYpH,MAAM,SAAU0D,GAC/B,OAAQA,EAAGgE,OACP,KAAK,EACD,MAA0B,gBAApBqG,EAAQqO,SAA6BuR,GAAgB/sB,IAE3DgJ,SAAgEA,EAAeqD,IAAI,wEAC5E,CAAC,EAAawf,MAHsD,CAAC,EAAa,GAI7F,KAAK,EACDiB,EAAgBhqB,EAAGiE,OACnB/G,EAAMqX,WAAayV,EAAczV,WACjCrX,EAAM4Z,iBAAmBtZ,EAASA,EAAS,GAAIN,EAAM4Z,kBAAmBkT,EAAclT,kBACtF9W,EAAGgE,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,EAAc9G,WAI1CiY,SAAU,WAAc,OAAOxS,OAAU,OAAQ,OAAQ,GAAQ,WAC7D,OAAOe,EAAYpH,MAAM,SAAU0D,GAO/B,OANIqb,IACAA,EAAY6O,oBAAoB,WAAYR,GACxCZ,IACAzN,EAAYuO,QAAQd,UAAYA,IAGjC,CAAC,YAMpBE,GAAoB,WAAc,OAAOrmB,OAAU,OAAQ,OAAQ,GAAQ,WAAc,IAAI3C,EAAI,OAAO0D,EAAYpH,MAAM,SAAU2D,GACpI,OAAQA,EAAG+D,OACP,KAAK,EAED,OADAhE,EAAK0oB,GACE,CAAC,GAAa,IAAI,IAAiBvM,SAC9C,KAAK,EAAG,MAAO,CAAC,EAAcnc,EAAGrC,WAAM,EAAQ,CAACsC,EAAGgE,kBAGvDgmB,GAAkB,SAAU/sB,GAC5B,GAAyB,cAArBA,EAAMqX,YAA8BrX,EAAMuX,gBAAiB,CAC3D,IAAItU,EAAajD,EAAMuX,gBACnB0V,EAAOhqB,EAAWoL,EAAkBqG,MAAQ,GAC5CwY,EAASjqB,EAAWoL,EAAkBoH,QAAU,GAChD0X,EAAmBxlB,EAAcA,EAAc,GAAIH,EAAO7J,OAAO0D,KAAK4rB,KAAQ,GAAQzlB,EAAO7J,OAAO0D,KAAK6rB,KAAU,GACvH,OAAOvvB,OAAO0D,KAAK+mB,IAAegF,OAAM,SAAUlvB,GAAS,OAAOivB,EAAiBjf,SAAShQ,MAEhG,OAAO,GAEAquB,GAA6B,SAAUc,EAAgBhB,EAAQiB,GACtE,OAAQD,GACJ,IAAK,WACD,OAAOhB,EAAO7jB,MAAM,KAAK,KAAO8kB,EAAO9kB,MAAM,KAAK,GACtD,QACI,OAAO6jB,IAAWiB,ICrKnBC,GAA0B,WACjC,IAAIC,EACAC,EAAiB,GACjBhB,EAAmB,SAAU7b,EAASnG,EAAMijB,GAC5C9c,EAAQ6b,iBAAiBhiB,EAAMijB,GAC/BD,EAAettB,KAAK,CAChByQ,QAASA,EACTnG,KAAMA,EACNijB,QAASA,KA2FjB,MAAO,CACHlwB,KAjFO,sDAkFPiN,KAjFO,aAkFPoE,MAjFQ,SAAU/F,EAAQuhB,GAAa,OAAO5kB,OAAU,OAAQ,OAAQ,GAAQ,WAChF,IAAIkoB,EACJ,OAAOnnB,EAAYpH,MAAM,SAAU0D,GAE/B,OAAKunB,GAMmB,oBAAbjL,WAGXuO,EAA6B,SAAUC,GACnC,IAAIC,GAAiB,EACrBpB,EAAiBmB,EAAM,UAAU,WAC7B,IAAI9qB,EACC+qB,GACDxD,EAAUnR,MAAMyM,KAA2B7iB,EAAK,IACzCqjB,IAAWyH,EAAKE,GACnBhrB,EAAGsjB,IAAawH,EAAKpwB,KACrBsF,EAAGujB,IAAoBuH,EAAK5qB,OAC5BF,IAER+qB,GAAiB,KAErBpB,EAAiBmB,EAAM,UAAU,WAC7B,IAAI9qB,EAAIC,EACH8qB,GACDxD,EAAUnR,MAAMyM,KAA2B7iB,EAAK,IACzCqjB,IAAWyH,EAAKE,GACnBhrB,EAAGsjB,IAAawH,EAAKpwB,KACrBsF,EAAGujB,IAAoBuH,EAAK5qB,OAC5BF,IAERunB,EAAUnR,MAAM0M,KAA4B7iB,EAAK,IAC1CojB,IAAWyH,EAAKE,GACnB/qB,EAAGqjB,IAAawH,EAAKpwB,KACrBuF,EAAGsjB,IAAoBuH,EAAK5qB,OAC5BD,IACJ8qB,GAAiB,MAGjB5sB,MAAM4G,KAAKuX,SAAS2O,qBAAqB,SAC3C1tB,QAAQstB,GAGkB,oBAArBK,mBACPR,EAAW,IAAIQ,kBAAiB,SAAUC,GACtCA,EAAU5tB,SAAQ,SAAU6tB,GACxBA,EAASC,WAAW9tB,SAAQ,SAAU+tB,GACZ,SAAlBA,EAAKC,UACLV,EAA2BS,GAE3B,qBAAsBA,GAAyC,mBAA1BA,EAAKE,kBAC1CrtB,MAAM4G,KAAKumB,EAAKE,iBAAiB,SAAS7lB,IAAIklB,aAKrDY,QAAQnP,SAAS3Y,KAAM,CAC5B+nB,SAAS,EACTC,WAAW,KAnDR,CAAC,KALR3lB,EAAOE,eAAeyD,KAAK,gIACpB,CAAC,WA2EhB0C,QAdU,SAAUnP,GAAS,OAAOyF,OAAU,OAAQ,OAAQ,GAAQ,WAAc,OAAOe,EAAYpH,MAAM,SAAU0D,GACvH,MAAO,CAAC,EAAc9C,UActBiY,SAZW,WAAc,OAAOxS,OAAU,OAAQ,OAAQ,GAAQ,WAClE,OAAOe,EAAYpH,MAAM,SAAU0D,GAG/B,OAFA0qB,SAAoDA,EAASkB,aAlFjEjB,EAAeptB,SAAQ,SAAUyC,GAC7B,IAAI8N,EAAU9N,EAAG8N,QAASnG,EAAO3H,EAAG2H,KAAMijB,EAAU5qB,EAAG4qB,QAEvD9c,SAAkDA,EAAQoc,oBAAoBviB,EAAMijB,MAExFD,EAAiB,GA+EN,CAAC,YChGTkB,GAAuB,WAC9B,IAAInB,EACAC,EAAiB,GA+FrB,MAAO,CACHjwB,KA/EO,mDAgFPiN,KA/EO,aAgFPoE,MA/EQ,SAAU/F,EAAQuhB,GAAa,OAAO5kB,OAAU,OAAQ,OAAQ,GAAQ,WAChF,IAAImpB,EAAyBC,EAC7B,OAAOroB,EAAYpH,MAAM,SAAU0D,GAE/B,OAAKunB,GAMmB,oBAAbjL,WAGXwP,EAA0B,SAAUhb,GAChC,IAAImU,EACJ,IAEIA,EAAM,IAAI+G,IAAIlb,EAAEmY,KAAMrnB,OAAO0Z,SAAS2N,MAE1C,MAAOjpB,GAEH,OAEJ,IAAIuD,EAASwoB,EAAIE,KAAKhH,EAAIgE,MACtBiD,EAAgB3oB,aAAuC,EAASA,EAAO,GACvE2oB,GA3CO,SAAUpe,EAASnG,EAAMijB,GAC5C9c,EAAQ6b,iBAAiBhiB,EAAMijB,GAC/BD,EAAettB,KAAK,CAChByQ,QAASA,EACTnG,KAAMA,EACNijB,QAASA,IAuCDjB,CAAiB7Y,EAAG,SAAS,WACzB,IAAI9Q,EACAksB,GACA3E,EAAUnR,MAAM2M,KAA8B/iB,EAAK,IAC5CgjB,IAAkBkJ,EACrBlsB,EAAGijB,IAAagC,EAAIiE,SACpBlpB,EAAGkjB,IAAWpS,EAAEka,GAChBhrB,EAAGmjB,IAAarS,EAAElL,KAClB5F,EAAGojB,IAAYtS,EAAEmY,KACjBjpB,QAKpB+rB,EAAM,gHACE5tB,MAAM4G,KAAKuX,SAAS2O,qBAAqB,MAC3C1tB,QAAQuuB,GAGkB,oBAArBZ,mBACPR,EAAW,IAAIQ,kBAAiB,SAAUC,GACtCA,EAAU5tB,SAAQ,SAAU6tB,GACxBA,EAASC,WAAW9tB,SAAQ,SAAU+tB,GACZ,MAAlBA,EAAKC,UACLO,EAAwBR,GAExB,qBAAsBA,GAAyC,mBAA1BA,EAAKE,kBAC1CrtB,MAAM4G,KAAKumB,EAAKE,iBAAiB,MAAM7lB,IAAImmB,aAKlDL,QAAQnP,SAAS3Y,KAAM,CAC5B+nB,SAAS,EACTC,WAAW,KAjDR,CAAC,KALR3lB,EAAOE,eAAeyD,KAAK,0HACpB,CAAC,WAyEhB0C,QAdU,SAAUnP,GAAS,OAAOyF,OAAU,OAAQ,OAAQ,GAAQ,WAAc,OAAOe,EAAYpH,MAAM,SAAU0D,GACvH,MAAO,CAAC,EAAc9C,UActBiY,SAZW,WAAc,OAAOxS,OAAU,OAAQ,OAAQ,GAAQ,WAClE,OAAOe,EAAYpH,MAAM,SAAU0D,GAG/B,OAFA0qB,SAAoDA,EAASkB,aAhFjEjB,EAAeptB,SAAQ,SAAUyC,GAC7B,IAAI8N,EAAU9N,EAAG8N,QAASnG,EAAO3H,EAAG2H,KAAMijB,EAAU5qB,EAAG4qB,QAEvD9c,SAAkDA,EAAQoc,oBAAoBviB,EAAMijB,MAExFD,EAAiB,GA6EN,CAAC,YC9FhBwB,IAAW,ECUX,GAAkC,SAAUnM,GAE5C,SAASoM,IACL,OAAkB,OAAXpM,GAAmBA,EAAOriB,MAAMrB,KAAMoB,YAAcpB,KA6O/D,OA/OA2F,EAAUmqB,EAAkBpM,GAI5BoM,EAAiBrwB,UAAUswB,KAAO,SAAU7hB,EAAQ8hB,EAAiBC,GAEjE,IAAI9sB,EACA4K,EAeJ,YAjBe,IAAXG,IAAqBA,EAAS,IAG9B9M,UAAUN,OAAS,GACnBqC,EAAS6sB,EACTjiB,EAAUkiB,GAGqB,iBAApBD,GACP7sB,EAAS6sB,EACTjiB,OAAU1N,IAGV8C,EAAS6sB,aAAyD,EAASA,EAAgB7sB,OAC3F4K,EAAUiiB,GAGX7jB,EAAcnM,KAAKga,MAAM9Y,EAASA,EAAS,GAAI6M,GAAU,CAAE5K,OAAQA,EAAQ+K,OAAQA,OAE9F4hB,EAAiBrwB,UAAUua,MAAQ,SAAUjM,GACzC,IAAIrK,EAAIC,EACR,OAAO0C,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIkwB,EAAgBC,EAAWC,EAA4BC,EACvD1gB,EAAQ3P,KACZ,OAAOoH,EAAYpH,MAAM,SAAU8D,GAC/B,OAAQA,EAAG4D,OACP,KAAK,EAED,OAAI1H,KAAK2Z,aACE,CAAC,IAEZ3Z,KAAK2Z,cAAe,EACb,CAAC,EAAauO,GAAiBna,EAAQG,OAAQH,EAAS/N,QACnE,KAAK,EAED,OADAkwB,EAAiBpsB,EAAG6D,OACb,CAAC,EAAa+b,EAAOjkB,UAAUua,MAAMhc,KAAKgC,KAAMkwB,IAC3D,KAAK,EAeD,OAdApsB,EAAG6D,OAMH3H,KAAK+rB,aAAwG,QAA1FpoB,EAAkC,QAA5BD,EAAKqK,EAAQuP,iBAA8B,IAAP5Z,EAAgBA,EAAK1D,KAAK0J,OAAO4T,iBAA8B,IAAP3Z,EAAgBA,EAAK8H,KAAKkU,QAC/IwQ,EAAY1U,EAAsB1N,EAAQ3I,eAChCJ,cAAcZ,YAAY,CAChCjB,OAAQnD,KAAK0J,OAAOvG,OACpBE,SAAUrD,KAAK0J,OAAOrG,WAInB,CAAC,EAAarD,KAAKyE,IAAI,IAAI,GAAeoH,SACrD,KAAK,EAID,OADA/H,EAAG6D,OACI,CAAC,EAAa3H,KAAKyE,IAAI,IAAI,IAAWoH,SACjD,KAAK,EAED,OADA/H,EAAG6D,OACI,CAAC,EAAa3H,KAAKyE,IAAI,IAAI,GAAuBoH,SAC7D,KAAK,EAID,OAHA/H,EAAG6D,OD5EJ,SAAU+B,GAC7B,IAAImmB,GAAJ,CAGA,IAAIS,EAAkB,CAClBtU,EAA0BtS,EAAOkS,iBAAmB,aAAe,GACnEK,EAAyBvS,EAAOkS,iBAAmB,WAAa,GAChEE,EAA8BpS,EAAOkS,iBAAmB,iBAAmB,GAC3EG,EAAiCrS,EAAOkS,iBAAmB,oBAAsB,IACnFpL,OAAOgL,SACL+U,EAAwBD,EAAgBljB,KAAK,MACjD,GAAIkjB,EAAgBxvB,OAAQ,CACxB,IAAI2L,EAAU,kDAAkD7D,OAAO2nB,EAAuB,oHAC9F7mB,EAAOE,eAAeqD,IAAIR,GAEtB/C,EAAOG,SAAWf,EAASoE,SAC3BC,QAAQF,IAAIR,GAGpBojB,IAAW,GC2DSW,CAAUxwB,KAAK0J,QACVoS,EAA8B9b,KAAK0J,OAAOkS,iBACxC,CAAC,EAAa5b,KAAKyE,IAAI8qB,MAAwB1jB,SADkB,CAAC,EAAa,GAE1F,KAAK,EACD/H,EAAG6D,OACH7D,EAAG4D,MAAQ,EACf,KAAK,EACD,OAAKqU,EAAiC/b,KAAK0J,OAAOkS,iBAC3C,CAAC,EAAa5b,KAAKyE,IAAI0pB,MAA2BtiB,SADkB,CAAC,EAAa,GAE7F,KAAK,EACD/H,EAAG6D,OACH7D,EAAG4D,MAAQ,EACf,KAAK,EACD,OAAKmU,EAA6B7b,KAAK0J,OAAOkS,kB5BpClBlS,E4BqC8B1J,KAAK0J,OAA/D0mB,E5BpChBvU,EAA6BnS,EAAOkS,kBACpClS,EAAOkS,iBAC2B,iBAA3BlS,EAAOkS,iBACdlS,EAAOkS,gBAAgB6U,aACuB,iBAAvC/mB,EAAOkS,gBAAgB6U,YACvBvvB,EAAS,GAAIwI,EAAOkS,gBAAgB6U,aAExC,G4B8BaJ,EAAiBrF,GAAqBoF,GAC/B,CAAC,EAAapwB,KAAKyE,IAAI4rB,GAAgBxkB,UAHyB,CAAC,EAAa,IAIzF,KAAK,GACD/H,EAAG6D,OACH7D,EAAG4D,MAAQ,GACf,KAAK,GAEL,MAAO,CAAC,EAAa1H,KAAKyE,IAAI8nB,GAAuBrQ,EAA0Blc,KAAK0J,UAAUmC,SAC9F,KAAK,GAKD,OAHA/H,EAAG6D,OACH3H,KAAK2Z,cAAe,EAEb,CAAC,EAAa3Z,KAAKia,mBAAmB,cACjD,KAAK,GAOD,OALAnW,EAAG6D,OAEHwoB,EAAUlrB,YAAYjE,kBAAiB,SAAUJ,GACxC+O,EAAMmK,MAAMlZ,EAAMub,UAAWvb,EAAM4W,oBAErC,CAAC,G5B3DU,IAAU9N,S4BgEhDomB,EAAiBrwB,UAAUixB,UAAY,WACnC,IAAIhtB,EACJ,OAA8B,QAAtBA,EAAK1D,KAAK0J,cAA2B,IAAPhG,OAAgB,EAASA,EAAGP,QAEtE2sB,EAAiBrwB,UAAUyD,UAAY,SAAUC,GACxCnD,KAAK0J,OAINvG,IAAWnD,KAAK0J,OAAOvG,aAAqB9C,IAAX8C,IACjCnD,KAAK0J,OAAOvG,OAASA,E9B/HD,SAAUA,EAAQiC,GAG9CqW,EAAsBrW,GAAcJ,cAAclC,eAAeI,UAAUC,GAAQgB,S8B6H3EwsB,CAAmBxtB,EAAQnD,KAAK0J,OAAOtE,eALvCpF,KAAK4Z,EAAE7Y,KAAKf,KAAKkD,UAAU7D,KAAKW,KAAMmD,KAQ9C2sB,EAAiBrwB,UAAUmxB,YAAc,WACrC,IAAIltB,EACJ,OAA8B,QAAtBA,EAAK1D,KAAK0J,cAA2B,IAAPhG,OAAgB,EAASA,EAAGL,UAEtEysB,EAAiBrwB,UAAU2D,YAAc,SAAUC,GAC1CrD,KAAK0J,QAIV1J,KAAK0J,OAAOrG,SAAWA,E9BvIG,SAAUA,EAAU+B,GAClDqW,EAAsBrW,GAAcJ,cAAclC,eAAeM,YAAYC,GAAUc,S8BuInF0sB,CAAqBxtB,EAAUrD,KAAK0J,OAAOtE,eAJvCpF,KAAK4Z,EAAE7Y,KAAKf,KAAKoD,YAAY/D,KAAKW,KAAMqD,KAMhDysB,EAAiBrwB,UAAUqZ,MAAQ,WAC/B9Y,KAAKoD,YAAYmR,KACjBvU,KAAKkD,eAAU7C,IAEnByvB,EAAiBrwB,UAAUqxB,aAAe,WACtC,IAAIptB,EACJ,OAA8B,QAAtBA,EAAK1D,KAAK0J,cAA2B,IAAPhG,OAAgB,EAASA,EAAG4Z,WAEtEwS,EAAiBrwB,UAAUssB,aAAe,SAAUzO,GAChD,IAAI5Z,EACJ,GAAK1D,KAAK0J,QAKV,GAAI4T,IAActd,KAAK0J,OAAO4T,UAA9B,CAGA,IAAIyT,EAAoB/wB,KAAK8wB,eACzB1T,EAAgBpd,KAAK0J,OAAO0T,cAC5BJ,EAAiD,QAAlCtZ,EAAK1D,KAAK0J,OAAOsT,mBAAgC,IAAPtZ,EAAgBA,GAAM,EACnF1D,KAAK0J,OAAO4T,UAAYA,EACxBtd,KAAK0J,OAAO0T,mBAAgB/c,EACxB4b,EAAyBjc,KAAK0J,OAAOkS,mBACjCmV,GAAqB3T,GACrBpd,KAAK8Z,MXvKkB,mBWuKezZ,EAAW,CAC7CiU,UAAWtU,KAAKyoB,wBAChBtL,WAAYH,EACZK,WAAY0T,EACZxlB,KAAM6R,EAAgB,EACtB/I,QAASrU,KAAK0oB,wBAGtB1oB,KAAK0J,OAAO0T,cAAgBpd,KAAK0J,OAAO4T,UACxCtd,KAAK8Z,MXjLwB,qBWiLWzZ,EAAW,CAC/C8c,WAAYH,EACZK,WAAYrd,KAAK0J,OAAO4T,UACxB/R,KAAMvL,KAAK0J,OAAO0T,iBAG1Bpd,KAAKyoB,wBAA0BzoB,KAAK0J,OAAOrG,SAC3CrD,KAAK0oB,sBAAwB1oB,KAAK0J,OAAOvG,aA9BrCnD,KAAK4Z,EAAE7Y,KAAKf,KAAK+rB,aAAa1sB,KAAKW,KAAMsd,KAgCjDwS,EAAiBrwB,UAAUuxB,cAAgB,WAClChxB,KAAK0J,OAIV1J,KAAK0J,OAAO0T,cAAgB3R,KAAKkU,MAH7B3f,KAAK4Z,EAAE7Y,KAAKf,KAAKgxB,cAAc3xB,KAAKW,QAK5C8vB,EAAiBrwB,UAAUwxB,aAAe,SAAU3J,GAC3CtnB,KAAK0J,OAIV1J,KAAK0J,OAAO6E,kBAAoBkZ,GAAgBH,GAH5CtnB,KAAK4Z,EAAE7Y,KAAKf,KAAKixB,aAAa5xB,KAAKW,KAAMsnB,KAKjDwI,EAAiBrwB,UAAUsY,SAAW,SAAUA,EAAUC,GACtD,GAAI0E,GAAgB3E,GAAW,CAC3B,IAAIrX,EAAQqX,EAAS4E,GACrB5E,EAAS4E,GAAK,GACd5E,EAAWwE,EAA+B,IAAI,EAAY7b,GAQ9D,OANIsX,aAAmD,EAASA,EAAa3D,UACzErU,KAAKkD,UAAU8U,EAAa3D,UAE5B2D,aAAmD,EAASA,EAAa1D,YACzEtU,KAAKoD,YAAY4U,EAAa1D,WAE3BoP,EAAOjkB,UAAUsY,SAAS/Z,KAAKgC,KAAM+X,EAAUC,IAE1D8X,EAAiBrwB,UAAUkb,cAAgB,SAAUC,EAAWC,EAAW9C,EAAUC,GACjF,GAAI0E,GAAgB3E,GAAW,CAC3B,IAAIrX,EAAQqX,EAAS4E,GACrB5E,EAAS4E,GAAK,GACd5E,EAAWwE,EAA+B,IAAI,EAAY7b,GAE9D,OAAOgjB,EAAOjkB,UAAUkb,cAAc3c,KAAKgC,KAAM4a,EAAWC,EAAW9C,EAAUC,IAErF8X,EAAiBrwB,UAAU4X,QAAU,SAAUA,EAASW,GACpD,GAAI0E,GAAgBrF,GAAU,CAC1B,IAAI3W,EAAQ2W,EAAQsF,GACpBtF,EAAQsF,GAAK,GACbtF,EAAUkF,EAA+B,IAAI,EAAW7b,GAE5D,OAAOgjB,EAAOjkB,UAAU4X,QAAQrZ,KAAKgC,KAAMqX,EAASW,IAExD8X,EAAiBrwB,UAAU6b,QAAU,SAAU1a,GAC3C,OAAOyF,EAAUrG,UAAM,OAAQ,GAAQ,WACnC,IAAIkxB,EAAa9T,EAAe+T,EAChC,OAAO/pB,EAAYpH,MAAM,SAAU0D,GAU/B,OATAwtB,EAAczlB,KAAKkU,MACnBvC,EAAgBpd,KAAK0J,OAAO0T,eAAiB3R,KAAKkU,MAClDwR,EAAqBD,EAAc9T,EX5OV,kBW6OrBxc,EAAMqX,YX5Oa,gBW6OnBrX,EAAMqX,cACJrX,EAAMyc,YAAczc,EAAMyc,aAAerd,KAAK8wB,iBAChDK,EAAqBnxB,KAAK0J,OAAO2d,gBACjCrnB,KAAK+rB,aAAamF,GAEf,CAAC,EAAcxN,EAAOjkB,UAAU6b,QAAQtd,KAAKgC,KAAMY,WAI/DkvB,EAhP0B,CAiPnC,GpClOa,IAxBPrmB,EAAS,IAAI,GACV,CACHsmB,KAAMnlB,EAAanB,EAAOsmB,KAAK1wB,KAAKoK,GAAS,OAAQD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,YAC1GhF,IAAKmG,EAAanB,EAAOhF,IAAIpF,KAAKoK,GAAS,MAAOD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,sBACxHwM,OAAQrL,EAAanB,EAAOwM,OAAO5W,KAAKoK,GAAS,SAAUD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,sBACjIqQ,MAAOlP,EAAanB,EAAOqQ,MAAMza,KAAKoK,GAAS,QAASD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BAC9H9I,SAAUiK,EAAanB,EAAO9I,SAAStB,KAAKoK,GAAS,WAAYD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BACvIsO,SAAUnN,EAAanB,EAAOsO,SAAS1Y,KAAKoK,GAAS,WAAYD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BACvIkR,cAAe/P,EAAanB,EAAOkR,cAActb,KAAKoK,GAAS,gBAAiBD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BACtJyR,SAAUtQ,EAAanB,EAAOyR,SAAS7b,KAAKoK,GAAS,WAAYD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BACvI4N,QAASzM,EAAanB,EAAO4N,QAAQhY,KAAKoK,GAAS,UAAWD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BACpImH,MAAOhG,EAAanB,EAAOmH,MAAMvR,KAAKoK,GAAS,QAASD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,gBAAiB,2BAC9HinB,UAAW9lB,EAAanB,EAAOinB,UAAUrxB,KAAKoK,GAAS,YAAaD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,SAAU,mBACnIvG,UAAW0H,EAAanB,EAAOvG,UAAU7D,KAAKoK,GAAS,YAAaD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,SAAU,mBACnImnB,YAAahmB,EAAanB,EAAOmnB,YAAYvxB,KAAKoK,GAAS,cAAeD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,SAAU,qBACzIrG,YAAawH,EAAanB,EAAOrG,YAAY/D,KAAKoK,GAAS,cAAeD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,SAAU,qBACzIqP,MAAOlO,EAAanB,EAAOqP,MAAMzZ,KAAKoK,GAAS,QAASD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,SAAU,gBAAiB,qBACxIqnB,aAAclmB,EAAanB,EAAOqnB,aAAazxB,KAAKoK,GAAS,eAAgBD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,YAClIsiB,aAAcnhB,EAAanB,EAAOsiB,aAAa1sB,KAAKoK,GAAS,eAAgBD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,YAClIunB,cAAepmB,EAAanB,EAAOunB,cAAc3xB,KAAKoK,GAAS,gBAAiBD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,YACrI8R,UAAW3Q,EAAanB,EAAO8R,UAAUlc,KAAKoK,GAAS,YAAaD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,YACzHwnB,aAAcrmB,EAAanB,EAAOwnB,aAAa5xB,KAAKoK,GAAS,eAAgBD,EAAmBC,GAASY,EAAgBZ,EAAQ,CAAC,cqCrBqHsmB,GAAO,GAAOA,KAA4S,GAAQ,GAAOjW,M,s4CCAnjBsX,G,wQACjB,WAAYljB,GAAQ,O,4FAAA,SAChB+c,GAAe/c,EAAQ,KAAM,CACzBN,WAAY,KACZgO,gBAAiB,CACbyV,eAAe,EACf/U,WAAW,EACXgV,UAAU,EAGVC,kBAAkB,KATV,a,kCAkBpB,SAAMC,GAA4B,IAAjB3tB,EAAiB,uDAAJ,GAC1B,OAAOonB,GAAgBuG,EAAW3tB,GAAYgI,a,2CCtBlD,c,4FAAc,S,4CAKd,SAAM2lB,S,uUCFAtjB,GCuFKujB,G,WA5EX,WAAYC,EAAIC,I,4FAAS,sCAbJ,mBAaI,qCAZI,4BAYJ,gDACrB3xB,KAAK4xB,IAAM,CAAEF,GAAIA,GACjB1xB,KAAK2xB,QAAUA,EAEf3xB,KAAK+vB,O,2CAGT,WAAO,WACH/vB,KAAK4xB,IAAIC,kBAAoB7xB,KAAK4xB,IAAIF,GAAGxC,iBAAZ,WAAiClvB,KAAK8xB,mBAAtC,MAC7B9xB,KAAK4xB,IAAIG,mBAAqB/xB,KAAK4xB,IAAIF,GAAGxC,iBAAZ,WAAiClvB,KAAKgyB,2BAAtC,MAE9B,IAAMC,EAAY,IAAIC,gBAAgB5sB,OAAO0Z,SAASC,QAEtD,GAAIgT,EAAUte,IAAI,cAAe,CAC7B3T,KAAK8Z,MAAMmY,EAAUvzB,IAAI,eAGzBuzB,EAAS,OAAQ,cAEjB,IAAME,EAAkBF,EAAUvd,WAAWnL,OAC7CjE,OAAOgoB,QAAQ8E,aAAa,KAAM,GAChC9sB,OAAO0Z,SAAS4N,SAAShkB,OAAOupB,EAAgBrxB,OAAS,IAAI8H,OAAOqpB,EAAUvd,YAAc,KAIlG1U,KAAK4xB,IAAIC,kBAAkB5wB,SAAQ,SAACuQ,GAChC,EAAK6gB,kBAAkB7gB,MAE3BxR,KAAK4xB,IAAIG,mBAAmB9wB,SAAQ,SAACuQ,GACjC,EAAK8gB,mBAAmB9gB,Q,mBAIhC,SAAMggB,GAA4B,IAAjB3tB,EAAiB,uDAAJ,GAC1B,OAAO7D,KAAK2xB,QAAQ7X,MAAM0X,EAAW3tB,K,yBAGzC,SAAYjD,EAAO4Q,GACf,IAAM+gB,EAAgB/gB,EAAQghB,aAAaxyB,KAAK8xB,oBAC1CtE,EAAShc,EAAQghB,aAAa,UAC9B7F,EAAOnb,EAAQghB,aAAa,QAGnB,OAAXhF,GAAmBb,GAAQA,EAAK7d,SAAS,MACzClO,EAAM6xB,iBAENzyB,KAAK8Z,MAAMyY,GACNprB,MAAK,WACF6Y,SAAShB,SAAS2N,KAAOA,KAIjCjc,YAAW,WAAOsP,SAAShB,SAAS2N,KAAOA,IAAO,MAElD3sB,KAAK8Z,MAAMyY,K,0BAInB,SAAa3xB,EAAO4Q,GAChB,IAAM+gB,EAAgB/gB,EAAQghB,aAAaxyB,KAAKgyB,4BAChDhyB,KAAK8Z,MAAMyY,K,+BAGf,SAAkB/gB,GAAS,WACvBA,EAAQ6b,iBAAiB,SAAS,SAACzsB,GAC/B,EAAK8xB,YAAY9xB,EAAO4Q,Q,gCAIhC,SAAmBA,GAAS,WACxBA,EAAQ6b,iBAAiB,UAAU,SAACzsB,GAChC,EAAK+xB,aAAa/xB,EAAO4Q,W,kCDlF3BtD,GAAS8R,SAAS4S,cAAcJ,aAAa,gBAEnDxS,SAASqN,iBAAiB,oBAAoB,WAC1CrN,SAAS2R,QAAU,IAAIF,GAAUzR,SAAU,IAAIoR,GAAUljB,S,mBEPjE,IAAI1G,EAGJA,EAAI,WACH,OAAOxH,KADJ,GAIJ,IAECwH,EAAIA,GAAK,IAAIqrB,SAAS,cAAb,GACR,MAAO5sB,GAEc,iBAAXX,SAAqBkC,EAAIlC,QAOrC1H,EAAOD,QAAU6J","file":"/js/analytics-instrumentation.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","var ApplicationContextProviderImpl = /** @class */ (function () {\n    function ApplicationContextProviderImpl() {\n    }\n    ApplicationContextProviderImpl.prototype.getApplicationContext = function () {\n        return {\n            versionName: this.versionName,\n            language: getLanguage(),\n            platform: 'Web',\n            os: undefined,\n            deviceModel: undefined,\n        };\n    };\n    return ApplicationContextProviderImpl;\n}());\nvar getLanguage = function () {\n    return ((typeof navigator !== 'undefined' &&\n        ((navigator.languages && navigator.languages[0]) ||\n            navigator.language)) ||\n        '');\n};\n\nvar EventBridgeImpl = /** @class */ (function () {\n    function EventBridgeImpl() {\n        this.queue = [];\n    }\n    EventBridgeImpl.prototype.logEvent = function (event) {\n        if (!this.receiver) {\n            if (this.queue.length < 512) {\n                this.queue.push(event);\n            }\n        }\n        else {\n            this.receiver(event);\n        }\n    };\n    EventBridgeImpl.prototype.setEventReceiver = function (receiver) {\n        this.receiver = receiver;\n        if (this.queue.length > 0) {\n            this.queue.forEach(function (event) {\n                receiver(event);\n            });\n            this.queue = [];\n        }\n    };\n    return EventBridgeImpl;\n}());\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar isEqual = function (obj1, obj2) {\n    var primitive = ['string', 'number', 'boolean', 'undefined'];\n    var typeA = typeof obj1;\n    var typeB = typeof obj2;\n    if (typeA !== typeB) {\n        return false;\n    }\n    for (var _i = 0, primitive_1 = primitive; _i < primitive_1.length; _i++) {\n        var p = primitive_1[_i];\n        if (p === typeA) {\n            return obj1 === obj2;\n        }\n    }\n    // check null\n    if (obj1 == null && obj2 == null) {\n        return true;\n    }\n    else if (obj1 == null || obj2 == null) {\n        return false;\n    }\n    // if got here - objects\n    if (obj1.length !== obj2.length) {\n        return false;\n    }\n    //check if arrays\n    var isArrayA = Array.isArray(obj1);\n    var isArrayB = Array.isArray(obj2);\n    if (isArrayA !== isArrayB) {\n        return false;\n    }\n    if (isArrayA && isArrayB) {\n        //arrays\n        for (var i = 0; i < obj1.length; i++) {\n            if (!isEqual(obj1[i], obj2[i])) {\n                return false;\n            }\n        }\n    }\n    else {\n        //objects\n        var sorted1 = Object.keys(obj1).sort();\n        var sorted2 = Object.keys(obj2).sort();\n        if (!isEqual(sorted1, sorted2)) {\n            return false;\n        }\n        //compare object values\n        var result_1 = true;\n        Object.keys(obj1).forEach(function (key) {\n            if (!isEqual(obj1[key], obj2[key])) {\n                result_1 = false;\n            }\n        });\n        return result_1;\n    }\n    return true;\n};\n\nvar ID_OP_SET = '$set';\nvar ID_OP_UNSET = '$unset';\nvar ID_OP_CLEAR_ALL = '$clearAll';\n// Polyfill for Object.entries\nif (!Object.entries) {\n    Object.entries = function (obj) {\n        var ownProps = Object.keys(obj);\n        var i = ownProps.length;\n        var resArray = new Array(i);\n        while (i--) {\n            resArray[i] = [ownProps[i], obj[ownProps[i]]];\n        }\n        return resArray;\n    };\n}\nvar IdentityStoreImpl = /** @class */ (function () {\n    function IdentityStoreImpl() {\n        this.identity = { userProperties: {} };\n        this.listeners = new Set();\n    }\n    IdentityStoreImpl.prototype.editIdentity = function () {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var self = this;\n        var actingUserProperties = __assign({}, this.identity.userProperties);\n        var actingIdentity = __assign(__assign({}, this.identity), { userProperties: actingUserProperties });\n        return {\n            setUserId: function (userId) {\n                actingIdentity.userId = userId;\n                return this;\n            },\n            setDeviceId: function (deviceId) {\n                actingIdentity.deviceId = deviceId;\n                return this;\n            },\n            setUserProperties: function (userProperties) {\n                actingIdentity.userProperties = userProperties;\n                return this;\n            },\n            updateUserProperties: function (actions) {\n                var actingProperties = actingIdentity.userProperties || {};\n                for (var _i = 0, _a = Object.entries(actions); _i < _a.length; _i++) {\n                    var _b = _a[_i], action = _b[0], properties = _b[1];\n                    switch (action) {\n                        case ID_OP_SET:\n                            for (var _c = 0, _d = Object.entries(properties); _c < _d.length; _c++) {\n                                var _e = _d[_c], key = _e[0], value = _e[1];\n                                actingProperties[key] = value;\n                            }\n                            break;\n                        case ID_OP_UNSET:\n                            for (var _f = 0, _g = Object.keys(properties); _f < _g.length; _f++) {\n                                var key = _g[_f];\n                                delete actingProperties[key];\n                            }\n                            break;\n                        case ID_OP_CLEAR_ALL:\n                            actingProperties = {};\n                            break;\n                    }\n                }\n                actingIdentity.userProperties = actingProperties;\n                return this;\n            },\n            commit: function () {\n                self.setIdentity(actingIdentity);\n                return this;\n            },\n        };\n    };\n    IdentityStoreImpl.prototype.getIdentity = function () {\n        return __assign({}, this.identity);\n    };\n    IdentityStoreImpl.prototype.setIdentity = function (identity) {\n        var originalIdentity = __assign({}, this.identity);\n        this.identity = __assign({}, identity);\n        if (!isEqual(originalIdentity, this.identity)) {\n            this.listeners.forEach(function (listener) {\n                listener(identity);\n            });\n        }\n    };\n    IdentityStoreImpl.prototype.addIdentityListener = function (listener) {\n        this.listeners.add(listener);\n    };\n    IdentityStoreImpl.prototype.removeIdentityListener = function (listener) {\n        this.listeners.delete(listener);\n    };\n    return IdentityStoreImpl;\n}());\n\nvar safeGlobal = typeof globalThis !== 'undefined'\n    ? globalThis\n    : typeof global !== 'undefined'\n        ? global\n        : self;\n\nvar AnalyticsConnector = /** @class */ (function () {\n    function AnalyticsConnector() {\n        this.identityStore = new IdentityStoreImpl();\n        this.eventBridge = new EventBridgeImpl();\n        this.applicationContextProvider = new ApplicationContextProviderImpl();\n    }\n    AnalyticsConnector.getInstance = function (instanceName) {\n        if (!safeGlobal['analyticsConnectorInstances']) {\n            safeGlobal['analyticsConnectorInstances'] = {};\n        }\n        if (!safeGlobal['analyticsConnectorInstances'][instanceName]) {\n            safeGlobal['analyticsConnectorInstances'][instanceName] =\n                new AnalyticsConnector();\n        }\n        return safeGlobal['analyticsConnectorInstances'][instanceName];\n    };\n    return AnalyticsConnector;\n}());\n\nexport { AnalyticsConnector };\n","/* eslint-disable no-restricted-globals */\n/* Only file allowed to access to globalThis, window, self */\nexport var getGlobalScope = function () {\n    if (typeof globalThis !== 'undefined') {\n        return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    return undefined;\n};\n//# sourceMappingURL=global-scope.js.map","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\") throw new TypeError(\"Object expected.\");\r\n        var dispose;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    function next() {\r\n        while (env.stack.length) {\r\n            var rec = env.stack.pop();\r\n            try {\r\n                var result = rec.dispose && rec.dispose.call(rec.value);\r\n                if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport default {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __createBinding,\r\n    __exportStar,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n    __classPrivateFieldIn,\r\n    __addDisposableResource,\r\n    __disposeResources,\r\n};\r\n","export var LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"None\"] = 0] = \"None\";\n    LogLevel[LogLevel[\"Error\"] = 1] = \"Error\";\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\n    LogLevel[LogLevel[\"Verbose\"] = 3] = \"Verbose\";\n    LogLevel[LogLevel[\"Debug\"] = 4] = \"Debug\";\n})(LogLevel || (LogLevel = {}));\n//# sourceMappingURL=logger.js.map","import { __assign, __values } from \"tslib\";\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { LogLevel } from '@amplitude/analytics-types';\nexport var getStacktrace = function (ignoreDepth) {\n    if (ignoreDepth === void 0) { ignoreDepth = 0; }\n    var trace = new Error().stack || '';\n    return trace\n        .split('\\n')\n        .slice(2 + ignoreDepth)\n        .map(function (text) { return text.trim(); });\n};\n// This hook makes sure we always get the latest logger and logLevel.\nexport var getClientLogConfig = function (client) { return function () {\n    var _a = __assign({}, client.config), logger = _a.loggerProvider, logLevel = _a.logLevel;\n    return {\n        logger: logger,\n        logLevel: logLevel,\n    };\n}; };\n// This is a convenient function to get the attribute from object with string path, similar to lodash '#get'.\nexport var getValueByStringPath = function (obj, path) {\n    var e_1, _a;\n    path = path.replace(/\\[(\\w+)\\]/g, '.$1'); // convert indexes to properties\n    path = path.replace(/^\\./, ''); // strip a leading dot\n    try {\n        for (var _b = __values(path.split('.')), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var attr = _c.value;\n            if (attr in obj) {\n                obj = obj[attr];\n            }\n            else {\n                return;\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return obj;\n};\nexport var getClientStates = function (client, paths) { return function () {\n    var e_2, _a;\n    var res = {};\n    try {\n        for (var paths_1 = __values(paths), paths_1_1 = paths_1.next(); !paths_1_1.done; paths_1_1 = paths_1.next()) {\n            var path = paths_1_1.value;\n            res[path] = getValueByStringPath(client, path);\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (paths_1_1 && !paths_1_1.done && (_a = paths_1.return)) _a.call(paths_1);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return res;\n}; };\nexport var debugWrapper = function (fn, fnName, getLogConfig, getStates, fnContext) {\n    if (fnContext === void 0) { fnContext = null; }\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var _a = getLogConfig(), logger = _a.logger, logLevel = _a.logLevel;\n        // return early if possible to reduce overhead\n        if ((logLevel && logLevel < LogLevel.Debug) || !logLevel || !logger) {\n            return fn.apply(fnContext, args);\n        }\n        var debugContext = {\n            type: 'invoke public method',\n            name: fnName,\n            args: args,\n            stacktrace: getStacktrace(1),\n            time: {\n                start: new Date().toISOString(),\n            },\n            states: {},\n        };\n        if (getStates && debugContext.states) {\n            debugContext.states.before = getStates();\n        }\n        var result = fn.apply(fnContext, args);\n        if (result && result.promise) {\n            // if result is a promise, add the callback\n            result.promise.then(function () {\n                if (getStates && debugContext.states) {\n                    debugContext.states.after = getStates();\n                }\n                if (debugContext.time) {\n                    debugContext.time.end = new Date().toISOString();\n                }\n                logger.debug(JSON.stringify(debugContext, null, 2));\n            });\n        }\n        else {\n            if (getStates && debugContext.states) {\n                debugContext.states.after = getStates();\n            }\n            if (debugContext.time) {\n                debugContext.time.end = new Date().toISOString();\n            }\n            logger.debug(JSON.stringify(debugContext, null, 2));\n        }\n        return result;\n    };\n};\n//# sourceMappingURL=debug.js.map","/** The status of an event. */\nexport var Status;\n(function (Status) {\n    /** The status could not be determined. */\n    Status[\"Unknown\"] = \"unknown\";\n    /** The event was skipped due to configuration or callbacks. */\n    Status[\"Skipped\"] = \"skipped\";\n    /** The event was sent successfully. */\n    Status[\"Success\"] = \"success\";\n    /** A user or device in the payload is currently rate limited and should try again later. */\n    Status[\"RateLimit\"] = \"rate_limit\";\n    /** The sent payload was too large to be processed. */\n    Status[\"PayloadTooLarge\"] = \"payload_too_large\";\n    /** The event could not be processed. */\n    Status[\"Invalid\"] = \"invalid\";\n    /** A server-side error ocurred during submission. */\n    Status[\"Failed\"] = \"failed\";\n    /** a server or client side error occuring when a request takes too long and is cancelled */\n    Status[\"Timeout\"] = \"Timeout\";\n    /** NodeJS runtime environment error.. E.g. disconnected from network */\n    Status[\"SystemError\"] = \"SystemError\";\n})(Status || (Status = {}));\n//# sourceMappingURL=status.js.map","export var returnWrapper = function (awaitable) { return ({\n    promise: awaitable || Promise.resolve(),\n}); };\n//# sourceMappingURL=return-wrapper.js.map","export var SUCCESS_MESSAGE = 'Event tracked successfully';\nexport var UNEXPECTED_ERROR_MESSAGE = 'Unexpected error occurred';\nexport var MAX_RETRIES_EXCEEDED_MESSAGE = 'Event rejected due to exceeded retry count';\nexport var OPT_OUT_MESSAGE = 'Event skipped due to optOut config';\nexport var MISSING_API_KEY_MESSAGE = 'Event rejected due to missing API key';\nexport var INVALID_API_KEY = 'Invalid API key';\nexport var CLIENT_NOT_INITIALIZED = 'Client not initialized';\n//# sourceMappingURL=messages.js.map","export var UNSET_VALUE = '-';\nexport var AMPLITUDE_PREFIX = 'AMP';\nexport var STORAGE_PREFIX = \"\".concat(AMPLITUDE_PREFIX, \"_unsent\");\nexport var AMPLITUDE_SERVER_URL = 'https://api2.amplitude.com/2/httpapi';\nexport var EU_AMPLITUDE_SERVER_URL = 'https://api.eu.amplitude.com/2/httpapi';\nexport var AMPLITUDE_BATCH_SERVER_URL = 'https://api2.amplitude.com/batch';\nexport var EU_AMPLITUDE_BATCH_SERVER_URL = 'https://api.eu.amplitude.com/batch';\n//# sourceMappingURL=constants.js.map","import { Status } from '@amplitude/analytics-types';\nexport var buildResult = function (event, code, message) {\n    if (code === void 0) { code = 0; }\n    if (message === void 0) { message = Status.Unknown; }\n    return { event: event, code: code, message: message };\n};\n//# sourceMappingURL=result-builder.js.map","import { LogLevel } from '@amplitude/analytics-types';\nvar PREFIX = 'Amplitude Logger ';\nvar Logger = /** @class */ (function () {\n    function Logger() {\n        this.logLevel = LogLevel.None;\n    }\n    Logger.prototype.disable = function () {\n        this.logLevel = LogLevel.None;\n    };\n    Logger.prototype.enable = function (logLevel) {\n        if (logLevel === void 0) { logLevel = LogLevel.Warn; }\n        this.logLevel = logLevel;\n    };\n    Logger.prototype.log = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Verbose) {\n            return;\n        }\n        console.log(\"\".concat(PREFIX, \"[Log]: \").concat(args.join(' ')));\n    };\n    Logger.prototype.warn = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Warn) {\n            return;\n        }\n        console.warn(\"\".concat(PREFIX, \"[Warn]: \").concat(args.join(' ')));\n    };\n    Logger.prototype.error = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Error) {\n            return;\n        }\n        console.error(\"\".concat(PREFIX, \"[Error]: \").concat(args.join(' ')));\n    };\n    Logger.prototype.debug = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (this.logLevel < LogLevel.Debug) {\n            return;\n        }\n        // console.debug output is hidden by default in chrome\n        console.log(\"\".concat(PREFIX, \"[Debug]: \").concat(args.join(' ')));\n    };\n    return Logger;\n}());\nexport { Logger };\n//# sourceMappingURL=logger.js.map","import { LogLevel, } from '@amplitude/analytics-types';\nimport { AMPLITUDE_SERVER_URL, AMPLITUDE_BATCH_SERVER_URL, EU_AMPLITUDE_SERVER_URL, EU_AMPLITUDE_BATCH_SERVER_URL, } from './constants';\nimport { Logger } from './logger';\nexport var getDefaultConfig = function () { return ({\n    flushMaxRetries: 12,\n    flushQueueSize: 200,\n    flushIntervalMillis: 10000,\n    instanceName: '$default_instance',\n    logLevel: LogLevel.Warn,\n    loggerProvider: new Logger(),\n    optOut: false,\n    serverUrl: AMPLITUDE_SERVER_URL,\n    serverZone: 'US',\n    useBatch: false,\n}); };\nvar Config = /** @class */ (function () {\n    function Config(options) {\n        var _a, _b, _c, _d;\n        this._optOut = false;\n        var defaultConfig = getDefaultConfig();\n        this.apiKey = options.apiKey;\n        this.flushIntervalMillis = (_a = options.flushIntervalMillis) !== null && _a !== void 0 ? _a : defaultConfig.flushIntervalMillis;\n        this.flushMaxRetries = options.flushMaxRetries || defaultConfig.flushMaxRetries;\n        this.flushQueueSize = options.flushQueueSize || defaultConfig.flushQueueSize;\n        this.instanceName = options.instanceName || defaultConfig.instanceName;\n        this.loggerProvider = options.loggerProvider || defaultConfig.loggerProvider;\n        this.logLevel = (_b = options.logLevel) !== null && _b !== void 0 ? _b : defaultConfig.logLevel;\n        this.minIdLength = options.minIdLength;\n        this.plan = options.plan;\n        this.ingestionMetadata = options.ingestionMetadata;\n        this.optOut = (_c = options.optOut) !== null && _c !== void 0 ? _c : defaultConfig.optOut;\n        this.serverUrl = options.serverUrl;\n        this.serverZone = options.serverZone || defaultConfig.serverZone;\n        this.storageProvider = options.storageProvider;\n        this.transportProvider = options.transportProvider;\n        this.useBatch = (_d = options.useBatch) !== null && _d !== void 0 ? _d : defaultConfig.useBatch;\n        this.loggerProvider.enable(this.logLevel);\n        var serverConfig = createServerConfig(options.serverUrl, options.serverZone, options.useBatch);\n        this.serverZone = serverConfig.serverZone;\n        this.serverUrl = serverConfig.serverUrl;\n    }\n    Object.defineProperty(Config.prototype, \"optOut\", {\n        get: function () {\n            return this._optOut;\n        },\n        set: function (optOut) {\n            this._optOut = optOut;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Config;\n}());\nexport { Config };\nexport var getServerUrl = function (serverZone, useBatch) {\n    if (serverZone === 'EU') {\n        return useBatch ? EU_AMPLITUDE_BATCH_SERVER_URL : EU_AMPLITUDE_SERVER_URL;\n    }\n    return useBatch ? AMPLITUDE_BATCH_SERVER_URL : AMPLITUDE_SERVER_URL;\n};\nexport var createServerConfig = function (serverUrl, serverZone, useBatch) {\n    if (serverUrl === void 0) { serverUrl = ''; }\n    if (serverZone === void 0) { serverZone = getDefaultConfig().serverZone; }\n    if (useBatch === void 0) { useBatch = getDefaultConfig().useBatch; }\n    if (serverUrl) {\n        return { serverUrl: serverUrl, serverZone: undefined };\n    }\n    var _serverZone = ['US', 'EU'].includes(serverZone) ? serverZone : getDefaultConfig().serverZone;\n    return {\n        serverZone: _serverZone,\n        serverUrl: getServerUrl(_serverZone, useBatch),\n    };\n};\n//# sourceMappingURL=config.js.map","import { __awaiter, __generator, __read, __rest, __spreadArray } from \"tslib\";\nimport { Status, } from '@amplitude/analytics-types';\nimport { INVALID_API_KEY, MAX_RETRIES_EXCEEDED_MESSAGE, MISSING_API_KEY_MESSAGE, SUCCESS_MESSAGE, UNEXPECTED_ERROR_MESSAGE, } from '../messages';\nimport { STORAGE_PREFIX } from '../constants';\nimport { chunk } from '../utils/chunk';\nimport { buildResult } from '../utils/result-builder';\nimport { createServerConfig } from '../config';\nfunction getErrorMessage(error) {\n    if (error instanceof Error)\n        return error.message;\n    return String(error);\n}\nexport function getResponseBodyString(res) {\n    var responseBodyString = '';\n    try {\n        if ('body' in res) {\n            responseBodyString = JSON.stringify(res.body, null, 2);\n        }\n    }\n    catch (_a) {\n        // to avoid crash, but don't care about the error, add comment to avoid empty block lint error\n    }\n    return responseBodyString;\n}\nvar Destination = /** @class */ (function () {\n    function Destination() {\n        this.name = 'amplitude';\n        this.type = 'destination';\n        this.retryTimeout = 1000;\n        this.throttleTimeout = 30000;\n        this.storageKey = '';\n        this.scheduled = null;\n        this.queue = [];\n    }\n    Destination.prototype.setup = function (config) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var unsent;\n            var _this = this;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.config = config;\n                        this.storageKey = \"\".concat(STORAGE_PREFIX, \"_\").concat(this.config.apiKey.substring(0, 10));\n                        return [4 /*yield*/, ((_a = this.config.storageProvider) === null || _a === void 0 ? void 0 : _a.get(this.storageKey))];\n                    case 1:\n                        unsent = _b.sent();\n                        this.saveEvents(); // sets storage to '[]'\n                        if (unsent && unsent.length > 0) {\n                            void Promise.all(unsent.map(function (event) { return _this.execute(event); })).catch();\n                        }\n                        return [2 /*return*/, Promise.resolve(undefined)];\n                }\n            });\n        });\n    };\n    Destination.prototype.execute = function (event) {\n        var _this = this;\n        return new Promise(function (resolve) {\n            var context = {\n                event: event,\n                attempts: 0,\n                callback: function (result) { return resolve(result); },\n                timeout: 0,\n            };\n            void _this.addToQueue(context);\n        });\n    };\n    Destination.prototype.addToQueue = function () {\n        var _this = this;\n        var list = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            list[_i] = arguments[_i];\n        }\n        var tryable = list.filter(function (context) {\n            if (context.attempts < _this.config.flushMaxRetries) {\n                context.attempts += 1;\n                return true;\n            }\n            void _this.fulfillRequest([context], 500, MAX_RETRIES_EXCEEDED_MESSAGE);\n            return false;\n        });\n        tryable.forEach(function (context) {\n            _this.queue = _this.queue.concat(context);\n            if (context.timeout === 0) {\n                _this.schedule(_this.config.flushIntervalMillis);\n                return;\n            }\n            setTimeout(function () {\n                context.timeout = 0;\n                _this.schedule(0);\n            }, context.timeout);\n        });\n        this.saveEvents();\n    };\n    Destination.prototype.schedule = function (timeout) {\n        var _this = this;\n        if (this.scheduled)\n            return;\n        this.scheduled = setTimeout(function () {\n            void _this.flush(true).then(function () {\n                if (_this.queue.length > 0) {\n                    _this.schedule(timeout);\n                }\n            });\n        }, timeout);\n    };\n    Destination.prototype.flush = function (useRetry) {\n        if (useRetry === void 0) { useRetry = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var list, later, batches;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        list = [];\n                        later = [];\n                        this.queue.forEach(function (context) { return (context.timeout === 0 ? list.push(context) : later.push(context)); });\n                        this.queue = later;\n                        if (this.scheduled) {\n                            clearTimeout(this.scheduled);\n                            this.scheduled = null;\n                        }\n                        batches = chunk(list, this.config.flushQueueSize);\n                        return [4 /*yield*/, Promise.all(batches.map(function (batch) { return _this.send(batch, useRetry); }))];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Destination.prototype.send = function (list, useRetry) {\n        if (useRetry === void 0) { useRetry = true; }\n        return __awaiter(this, void 0, void 0, function () {\n            var payload, serverUrl, res, e_1, errorMessage;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.config.apiKey) {\n                            return [2 /*return*/, this.fulfillRequest(list, 400, MISSING_API_KEY_MESSAGE)];\n                        }\n                        payload = {\n                            api_key: this.config.apiKey,\n                            events: list.map(function (context) {\n                                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                                var _a = context.event, extra = _a.extra, eventWithoutExtra = __rest(_a, [\"extra\"]);\n                                return eventWithoutExtra;\n                            }),\n                            options: {\n                                min_id_length: this.config.minIdLength,\n                            },\n                        };\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        serverUrl = createServerConfig(this.config.serverUrl, this.config.serverZone, this.config.useBatch).serverUrl;\n                        return [4 /*yield*/, this.config.transportProvider.send(serverUrl, payload)];\n                    case 2:\n                        res = _a.sent();\n                        if (res === null) {\n                            this.fulfillRequest(list, 0, UNEXPECTED_ERROR_MESSAGE);\n                            return [2 /*return*/];\n                        }\n                        if (!useRetry) {\n                            if ('body' in res) {\n                                this.fulfillRequest(list, res.statusCode, \"\".concat(res.status, \": \").concat(getResponseBodyString(res)));\n                            }\n                            else {\n                                this.fulfillRequest(list, res.statusCode, res.status);\n                            }\n                            return [2 /*return*/];\n                        }\n                        this.handleResponse(res, list);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        errorMessage = getErrorMessage(e_1);\n                        this.config.loggerProvider.error(errorMessage);\n                        this.fulfillRequest(list, 0, errorMessage);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Destination.prototype.handleResponse = function (res, list) {\n        var status = res.status;\n        switch (status) {\n            case Status.Success: {\n                this.handleSuccessResponse(res, list);\n                break;\n            }\n            case Status.Invalid: {\n                this.handleInvalidResponse(res, list);\n                break;\n            }\n            case Status.PayloadTooLarge: {\n                this.handlePayloadTooLargeResponse(res, list);\n                break;\n            }\n            case Status.RateLimit: {\n                this.handleRateLimitResponse(res, list);\n                break;\n            }\n            default: {\n                // log intermediate event status before retry\n                this.config.loggerProvider.warn(\"{code: 0, error: \\\"Status '\".concat(status, \"' provided for \").concat(list.length, \" events\\\"}\"));\n                this.handleOtherResponse(list);\n                break;\n            }\n        }\n    };\n    Destination.prototype.handleSuccessResponse = function (res, list) {\n        this.fulfillRequest(list, res.statusCode, SUCCESS_MESSAGE);\n    };\n    Destination.prototype.handleInvalidResponse = function (res, list) {\n        var _this = this;\n        if (res.body.missingField || res.body.error.startsWith(INVALID_API_KEY)) {\n            this.fulfillRequest(list, res.statusCode, res.body.error);\n            return;\n        }\n        var dropIndex = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(Object.values(res.body.eventsWithInvalidFields)), false), __read(Object.values(res.body.eventsWithMissingFields)), false), __read(Object.values(res.body.eventsWithInvalidIdLengths)), false), __read(res.body.silencedEvents), false).flat();\n        var dropIndexSet = new Set(dropIndex);\n        var retry = list.filter(function (context, index) {\n            if (dropIndexSet.has(index)) {\n                _this.fulfillRequest([context], res.statusCode, res.body.error);\n                return;\n            }\n            return true;\n        });\n        if (retry.length > 0) {\n            // log intermediate event status before retry\n            this.config.loggerProvider.warn(getResponseBodyString(res));\n        }\n        this.addToQueue.apply(this, __spreadArray([], __read(retry), false));\n    };\n    Destination.prototype.handlePayloadTooLargeResponse = function (res, list) {\n        if (list.length === 1) {\n            this.fulfillRequest(list, res.statusCode, res.body.error);\n            return;\n        }\n        // log intermediate event status before retry\n        this.config.loggerProvider.warn(getResponseBodyString(res));\n        this.config.flushQueueSize /= 2;\n        this.addToQueue.apply(this, __spreadArray([], __read(list), false));\n    };\n    Destination.prototype.handleRateLimitResponse = function (res, list) {\n        var _this = this;\n        var dropUserIds = Object.keys(res.body.exceededDailyQuotaUsers);\n        var dropDeviceIds = Object.keys(res.body.exceededDailyQuotaDevices);\n        var throttledIndex = res.body.throttledEvents;\n        var dropUserIdsSet = new Set(dropUserIds);\n        var dropDeviceIdsSet = new Set(dropDeviceIds);\n        var throttledIndexSet = new Set(throttledIndex);\n        var retry = list.filter(function (context, index) {\n            if ((context.event.user_id && dropUserIdsSet.has(context.event.user_id)) ||\n                (context.event.device_id && dropDeviceIdsSet.has(context.event.device_id))) {\n                _this.fulfillRequest([context], res.statusCode, res.body.error);\n                return;\n            }\n            if (throttledIndexSet.has(index)) {\n                context.timeout = _this.throttleTimeout;\n            }\n            return true;\n        });\n        if (retry.length > 0) {\n            // log intermediate event status before retry\n            this.config.loggerProvider.warn(getResponseBodyString(res));\n        }\n        this.addToQueue.apply(this, __spreadArray([], __read(retry), false));\n    };\n    Destination.prototype.handleOtherResponse = function (list) {\n        var _this = this;\n        this.addToQueue.apply(this, __spreadArray([], __read(list.map(function (context) {\n            context.timeout = context.attempts * _this.retryTimeout;\n            return context;\n        })), false));\n    };\n    Destination.prototype.fulfillRequest = function (list, code, message) {\n        this.saveEvents();\n        list.forEach(function (context) { return context.callback(buildResult(context.event, code, message)); });\n    };\n    /**\n     * Saves events to storage\n     * This is called on\n     * 1) new events are added to queue; or\n     * 2) response comes back for a request\n     */\n    Destination.prototype.saveEvents = function () {\n        if (!this.config.storageProvider) {\n            return;\n        }\n        var events = Array.from(this.queue.map(function (context) { return context.event; }));\n        void this.config.storageProvider.set(this.storageKey, events);\n    };\n    return Destination;\n}());\nexport { Destination };\n//# sourceMappingURL=destination.js.map","export var IdentifyOperation;\n(function (IdentifyOperation) {\n    // Base Operations to set values\n    IdentifyOperation[\"SET\"] = \"$set\";\n    IdentifyOperation[\"SET_ONCE\"] = \"$setOnce\";\n    // Operations around modifying existing values\n    IdentifyOperation[\"ADD\"] = \"$add\";\n    IdentifyOperation[\"APPEND\"] = \"$append\";\n    IdentifyOperation[\"PREPEND\"] = \"$prepend\";\n    IdentifyOperation[\"REMOVE\"] = \"$remove\";\n    // Operations around appending values *if* they aren't present\n    IdentifyOperation[\"PREINSERT\"] = \"$preInsert\";\n    IdentifyOperation[\"POSTINSERT\"] = \"$postInsert\";\n    // Operations around removing properties/values\n    IdentifyOperation[\"UNSET\"] = \"$unset\";\n    IdentifyOperation[\"CLEAR_ALL\"] = \"$clearAll\";\n})(IdentifyOperation || (IdentifyOperation = {}));\nexport var RevenueProperty;\n(function (RevenueProperty) {\n    RevenueProperty[\"REVENUE_PRODUCT_ID\"] = \"$productId\";\n    RevenueProperty[\"REVENUE_QUANTITY\"] = \"$quantity\";\n    RevenueProperty[\"REVENUE_PRICE\"] = \"$price\";\n    RevenueProperty[\"REVENUE_TYPE\"] = \"$revenueType\";\n    RevenueProperty[\"REVENUE\"] = \"$revenue\";\n})(RevenueProperty || (RevenueProperty = {}));\n/**\n * Strings that have special meaning when used as an event's type\n * and have different specifications.\n */\nexport var SpecialEventType;\n(function (SpecialEventType) {\n    SpecialEventType[\"IDENTIFY\"] = \"$identify\";\n    SpecialEventType[\"GROUP_IDENTIFY\"] = \"$groupidentify\";\n    SpecialEventType[\"REVENUE\"] = \"revenue_amount\";\n})(SpecialEventType || (SpecialEventType = {}));\n//# sourceMappingURL=event.js.map","// Creates an array of elements split into groups the length of size.\n// If array can't be split evenly, the final chunk will be the remaining elements.\n// Works similary as https://lodash.com/docs/4.17.15#chunk\nexport var chunk = function (arr, size) {\n    var chunkSize = Math.max(size, 1);\n    return arr.reduce(function (chunks, element, index) {\n        var chunkIndex = Math.floor(index / chunkSize);\n        if (!chunks[chunkIndex]) {\n            chunks[chunkIndex] = [];\n        }\n        chunks[chunkIndex].push(element);\n        return chunks;\n    }, []);\n};\n//# sourceMappingURL=chunk.js.map","/**\n * Source: [jed's gist]{@link https://gist.github.com/982883}.\n * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n * where each x is replaced with a random hexadecimal digit from 0 to f, and\n * y is replaced with a random hexadecimal digit from 8 to b.\n * Used to generate UUIDs for deviceIds.\n * @private\n */\nexport var UUID = function (a) {\n    return a // if the placeholder was passed, return\n        ? // a random number from 0 to 15\n            (a ^ // unless b is 8,\n                ((Math.random() * // in which case\n                    16) >> // a random number from\n                    (a / 4))) // 8 to 11\n                .toString(16) // in hexadecimal\n        : // or otherwise a concatenated string:\n            (String(1e7) + // 10000000 +\n                String(-1e3) + // -1000 +\n                String(-4e3) + // -4000 +\n                String(-8e3) + // -80000000 +\n                String(-1e11)) // -100000000000,\n                .replace(\n            // replacing\n            /[018]/g, // zeroes, ones, and eights with\n            UUID);\n};\n//# sourceMappingURL=uuid.js.map","import { __values } from \"tslib\";\nvar MAX_PROPERTY_KEYS = 1000;\nexport var isValidObject = function (properties) {\n    if (Object.keys(properties).length > MAX_PROPERTY_KEYS) {\n        return false;\n    }\n    for (var key in properties) {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n        var value = properties[key];\n        if (!isValidProperties(key, value))\n            return false;\n    }\n    return true;\n};\nexport var isValidProperties = function (property, value) {\n    var e_1, _a;\n    if (typeof property !== 'string')\n        return false;\n    if (Array.isArray(value)) {\n        var isValid = true;\n        try {\n            for (var value_1 = __values(value), value_1_1 = value_1.next(); !value_1_1.done; value_1_1 = value_1.next()) {\n                var valueElement = value_1_1.value;\n                if (Array.isArray(valueElement)) {\n                    return false;\n                }\n                else if (typeof valueElement === 'object') {\n                    isValid = isValid && isValidObject(valueElement);\n                }\n                else if (!['number', 'string'].includes(typeof valueElement)) {\n                    return false;\n                }\n                if (!isValid) {\n                    return false;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (value_1_1 && !value_1_1.done && (_a = value_1.return)) _a.call(value_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    }\n    else if (value === null || value === undefined) {\n        return false;\n    }\n    else if (typeof value === 'object') {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n        return isValidObject(value);\n    }\n    else if (!['number', 'string', 'boolean'].includes(typeof value)) {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=valid-properties.js.map","import { debugWrapper, getClientLogConfig, getClientStates } from '@amplitude/analytics-core';\nimport { AmplitudeBrowser } from './browser-client';\nexport var createInstance = function () {\n    var client = new AmplitudeBrowser();\n    return {\n        init: debugWrapper(client.init.bind(client), 'init', getClientLogConfig(client), getClientStates(client, ['config'])),\n        add: debugWrapper(client.add.bind(client), 'add', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.plugins'])),\n        remove: debugWrapper(client.remove.bind(client), 'remove', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.plugins'])),\n        track: debugWrapper(client.track.bind(client), 'track', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        logEvent: debugWrapper(client.logEvent.bind(client), 'logEvent', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        identify: debugWrapper(client.identify.bind(client), 'identify', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        groupIdentify: debugWrapper(client.groupIdentify.bind(client), 'groupIdentify', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        setGroup: debugWrapper(client.setGroup.bind(client), 'setGroup', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        revenue: debugWrapper(client.revenue.bind(client), 'revenue', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        flush: debugWrapper(client.flush.bind(client), 'flush', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        getUserId: debugWrapper(client.getUserId.bind(client), 'getUserId', getClientLogConfig(client), getClientStates(client, ['config', 'config.userId'])),\n        setUserId: debugWrapper(client.setUserId.bind(client), 'setUserId', getClientLogConfig(client), getClientStates(client, ['config', 'config.userId'])),\n        getDeviceId: debugWrapper(client.getDeviceId.bind(client), 'getDeviceId', getClientLogConfig(client), getClientStates(client, ['config', 'config.deviceId'])),\n        setDeviceId: debugWrapper(client.setDeviceId.bind(client), 'setDeviceId', getClientLogConfig(client), getClientStates(client, ['config', 'config.deviceId'])),\n        reset: debugWrapper(client.reset.bind(client), 'reset', getClientLogConfig(client), getClientStates(client, ['config', 'config.userId', 'config.deviceId'])),\n        getSessionId: debugWrapper(client.getSessionId.bind(client), 'getSessionId', getClientLogConfig(client), getClientStates(client, ['config'])),\n        setSessionId: debugWrapper(client.setSessionId.bind(client), 'setSessionId', getClientLogConfig(client), getClientStates(client, ['config'])),\n        extendSession: debugWrapper(client.extendSession.bind(client), 'extendSession', getClientLogConfig(client), getClientStates(client, ['config'])),\n        setOptOut: debugWrapper(client.setOptOut.bind(client), 'setOptOut', getClientLogConfig(client), getClientStates(client, ['config'])),\n        setTransport: debugWrapper(client.setTransport.bind(client), 'setTransport', getClientLogConfig(client), getClientStates(client, ['config'])),\n    };\n};\nexport default createInstance();\n//# sourceMappingURL=browser-client-factory.js.map","import { __assign } from \"tslib\";\nimport { IdentifyOperation, } from '@amplitude/analytics-types';\nimport { UNSET_VALUE } from './constants';\nimport { isValidProperties } from './utils/valid-properties';\nvar Identify = /** @class */ (function () {\n    function Identify() {\n        this._propertySet = new Set();\n        this._properties = {};\n    }\n    Identify.prototype.getUserProperties = function () {\n        return __assign({}, this._properties);\n    };\n    Identify.prototype.set = function (property, value) {\n        this._safeSet(IdentifyOperation.SET, property, value);\n        return this;\n    };\n    Identify.prototype.setOnce = function (property, value) {\n        this._safeSet(IdentifyOperation.SET_ONCE, property, value);\n        return this;\n    };\n    Identify.prototype.append = function (property, value) {\n        this._safeSet(IdentifyOperation.APPEND, property, value);\n        return this;\n    };\n    Identify.prototype.prepend = function (property, value) {\n        this._safeSet(IdentifyOperation.PREPEND, property, value);\n        return this;\n    };\n    Identify.prototype.postInsert = function (property, value) {\n        this._safeSet(IdentifyOperation.POSTINSERT, property, value);\n        return this;\n    };\n    Identify.prototype.preInsert = function (property, value) {\n        this._safeSet(IdentifyOperation.PREINSERT, property, value);\n        return this;\n    };\n    Identify.prototype.remove = function (property, value) {\n        this._safeSet(IdentifyOperation.REMOVE, property, value);\n        return this;\n    };\n    Identify.prototype.add = function (property, value) {\n        this._safeSet(IdentifyOperation.ADD, property, value);\n        return this;\n    };\n    Identify.prototype.unset = function (property) {\n        this._safeSet(IdentifyOperation.UNSET, property, UNSET_VALUE);\n        return this;\n    };\n    Identify.prototype.clearAll = function () {\n        // When clear all happens, all properties are unset. Reset the entire object.\n        this._properties = {};\n        this._properties[IdentifyOperation.CLEAR_ALL] = UNSET_VALUE;\n        return this;\n    };\n    // Returns whether or not this set actually worked.\n    Identify.prototype._safeSet = function (operation, property, value) {\n        if (this._validate(operation, property, value)) {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            var userPropertyMap = this._properties[operation];\n            if (userPropertyMap === undefined) {\n                userPropertyMap = {};\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this._properties[operation] = userPropertyMap;\n            }\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n            userPropertyMap[property] = value;\n            this._propertySet.add(property);\n            return true;\n        }\n        return false;\n    };\n    Identify.prototype._validate = function (operation, property, value) {\n        if (this._properties[IdentifyOperation.CLEAR_ALL] !== undefined) {\n            // clear all already set. Skipping operation;\n            return false;\n        }\n        if (this._propertySet.has(property)) {\n            // Property already used. Skipping operation\n            return false;\n        }\n        if (operation === IdentifyOperation.ADD) {\n            return typeof value === 'number';\n        }\n        if (operation !== IdentifyOperation.UNSET && operation !== IdentifyOperation.REMOVE) {\n            return isValidProperties(property, value);\n        }\n        return true;\n    };\n    return Identify;\n}());\nexport { Identify };\n//# sourceMappingURL=identify.js.map","import { __assign } from \"tslib\";\nimport { RevenueProperty, } from '@amplitude/analytics-types';\nimport { isValidObject } from './utils/valid-properties';\nvar Revenue = /** @class */ (function () {\n    function Revenue() {\n        this.productId = '';\n        this.quantity = 1;\n        this.price = 0.0;\n    }\n    Revenue.prototype.setProductId = function (productId) {\n        this.productId = productId;\n        return this;\n    };\n    Revenue.prototype.setQuantity = function (quantity) {\n        if (quantity > 0) {\n            this.quantity = quantity;\n        }\n        return this;\n    };\n    Revenue.prototype.setPrice = function (price) {\n        this.price = price;\n        return this;\n    };\n    Revenue.prototype.setRevenueType = function (revenueType) {\n        this.revenueType = revenueType;\n        return this;\n    };\n    Revenue.prototype.setRevenue = function (revenue) {\n        this.revenue = revenue;\n        return this;\n    };\n    Revenue.prototype.setEventProperties = function (properties) {\n        if (isValidObject(properties)) {\n            this.properties = properties;\n        }\n        return this;\n    };\n    Revenue.prototype.getEventProperties = function () {\n        var eventProperties = this.properties ? __assign({}, this.properties) : {};\n        eventProperties[RevenueProperty.REVENUE_PRODUCT_ID] = this.productId;\n        eventProperties[RevenueProperty.REVENUE_QUANTITY] = this.quantity;\n        eventProperties[RevenueProperty.REVENUE_PRICE] = this.price;\n        eventProperties[RevenueProperty.REVENUE_TYPE] = this.revenueType;\n        eventProperties[RevenueProperty.REVENUE] = this.revenue;\n        return eventProperties;\n    };\n    return Revenue;\n}());\nexport { Revenue };\n//# sourceMappingURL=revenue.js.map","import { __assign } from \"tslib\";\nimport { SpecialEventType, } from '@amplitude/analytics-types';\nimport { Identify } from '../identify';\nexport var createTrackEvent = function (eventInput, eventProperties, eventOptions) {\n    var baseEvent = typeof eventInput === 'string' ? { event_type: eventInput } : eventInput;\n    return __assign(__assign(__assign({}, baseEvent), eventOptions), (eventProperties && { event_properties: eventProperties }));\n};\nexport var createIdentifyEvent = function (identify, eventOptions) {\n    var identifyEvent = __assign(__assign({}, eventOptions), { event_type: SpecialEventType.IDENTIFY, user_properties: identify.getUserProperties() });\n    return identifyEvent;\n};\nexport var createGroupIdentifyEvent = function (groupType, groupName, identify, eventOptions) {\n    var _a;\n    var groupIdentify = __assign(__assign({}, eventOptions), { event_type: SpecialEventType.GROUP_IDENTIFY, group_properties: identify.getUserProperties(), groups: (_a = {},\n            _a[groupType] = groupName,\n            _a) });\n    return groupIdentify;\n};\nexport var createGroupEvent = function (groupType, groupName, eventOptions) {\n    var _a;\n    var identify = new Identify();\n    identify.set(groupType, groupName);\n    var groupEvent = __assign(__assign({}, eventOptions), { event_type: SpecialEventType.IDENTIFY, user_properties: identify.getUserProperties(), groups: (_a = {},\n            _a[groupType] = groupName,\n            _a) });\n    return groupEvent;\n};\nexport var createRevenueEvent = function (revenue, eventOptions) {\n    return __assign(__assign({}, eventOptions), { event_type: SpecialEventType.REVENUE, event_properties: revenue.getEventProperties() });\n};\n//# sourceMappingURL=event-builder.js.map","import { __assign, __awaiter, __generator, __read, __values } from \"tslib\";\nimport { buildResult } from './utils/result-builder';\nimport { UUID } from './utils/uuid';\nvar Timeline = /** @class */ (function () {\n    function Timeline(client) {\n        this.client = client;\n        this.queue = [];\n        // Flag to guarantee one schedule apply is running\n        this.applying = false;\n        // Flag indicates whether timeline is ready to process event\n        // Events collected before timeline is ready will stay in the queue to be processed later\n        this.plugins = [];\n    }\n    Timeline.prototype.register = function (plugin, config) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        plugin.name = (_a = plugin.name) !== null && _a !== void 0 ? _a : UUID();\n                        plugin.type = (_b = plugin.type) !== null && _b !== void 0 ? _b : 'enrichment';\n                        return [4 /*yield*/, ((_c = plugin.setup) === null || _c === void 0 ? void 0 : _c.call(plugin, config, this.client))];\n                    case 1:\n                        _d.sent();\n                        this.plugins.push(plugin);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.deregister = function (pluginName) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var index, plugin;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        index = this.plugins.findIndex(function (plugin) { return plugin.name === pluginName; });\n                        plugin = this.plugins[index];\n                        this.plugins.splice(index, 1);\n                        return [4 /*yield*/, ((_a = plugin.teardown) === null || _a === void 0 ? void 0 : _a.call(plugin))];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.reset = function (client) {\n        this.applying = false;\n        var plugins = this.plugins;\n        plugins.map(function (plugin) { var _a; return (_a = plugin.teardown) === null || _a === void 0 ? void 0 : _a.call(plugin); });\n        this.plugins = [];\n        this.client = client;\n    };\n    Timeline.prototype.push = function (event) {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.queue.push([event, resolve]);\n            _this.scheduleApply(0);\n        });\n    };\n    Timeline.prototype.scheduleApply = function (timeout) {\n        var _this = this;\n        if (this.applying)\n            return;\n        this.applying = true;\n        setTimeout(function () {\n            void _this.apply(_this.queue.shift()).then(function () {\n                _this.applying = false;\n                if (_this.queue.length > 0) {\n                    _this.scheduleApply(0);\n                }\n            });\n        }, timeout);\n    };\n    Timeline.prototype.apply = function (item) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, event, _b, resolve, before, before_1, before_1_1, plugin, e, e_1_1, enrichment, enrichment_1, enrichment_1_1, plugin, e, e_2_1, destination, executeDestinations;\n            var e_1, _c, e_2, _d;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0:\n                        if (!item) {\n                            return [2 /*return*/];\n                        }\n                        _a = __read(item, 1), event = _a[0];\n                        _b = __read(item, 2), resolve = _b[1];\n                        before = this.plugins.filter(function (plugin) { return plugin.type === 'before'; });\n                        _e.label = 1;\n                    case 1:\n                        _e.trys.push([1, 6, 7, 8]);\n                        before_1 = __values(before), before_1_1 = before_1.next();\n                        _e.label = 2;\n                    case 2:\n                        if (!!before_1_1.done) return [3 /*break*/, 5];\n                        plugin = before_1_1.value;\n                        /* istanbul ignore if */\n                        if (!plugin.execute) {\n                            // do nothing\n                            return [3 /*break*/, 4];\n                        }\n                        return [4 /*yield*/, plugin.execute(__assign({}, event))];\n                    case 3:\n                        e = _e.sent();\n                        if (e === null) {\n                            resolve({ event: event, code: 0, message: '' });\n                            return [2 /*return*/];\n                        }\n                        else {\n                            event = e;\n                        }\n                        _e.label = 4;\n                    case 4:\n                        before_1_1 = before_1.next();\n                        return [3 /*break*/, 2];\n                    case 5: return [3 /*break*/, 8];\n                    case 6:\n                        e_1_1 = _e.sent();\n                        e_1 = { error: e_1_1 };\n                        return [3 /*break*/, 8];\n                    case 7:\n                        try {\n                            if (before_1_1 && !before_1_1.done && (_c = before_1.return)) _c.call(before_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                        return [7 /*endfinally*/];\n                    case 8:\n                        enrichment = this.plugins.filter(function (plugin) { return plugin.type === 'enrichment' || plugin.type === undefined; });\n                        _e.label = 9;\n                    case 9:\n                        _e.trys.push([9, 14, 15, 16]);\n                        enrichment_1 = __values(enrichment), enrichment_1_1 = enrichment_1.next();\n                        _e.label = 10;\n                    case 10:\n                        if (!!enrichment_1_1.done) return [3 /*break*/, 13];\n                        plugin = enrichment_1_1.value;\n                        /* istanbul ignore if */\n                        if (!plugin.execute) {\n                            // do nothing\n                            return [3 /*break*/, 12];\n                        }\n                        return [4 /*yield*/, plugin.execute(__assign({}, event))];\n                    case 11:\n                        e = _e.sent();\n                        if (e === null) {\n                            resolve({ event: event, code: 0, message: '' });\n                            return [2 /*return*/];\n                        }\n                        else {\n                            event = e;\n                        }\n                        _e.label = 12;\n                    case 12:\n                        enrichment_1_1 = enrichment_1.next();\n                        return [3 /*break*/, 10];\n                    case 13: return [3 /*break*/, 16];\n                    case 14:\n                        e_2_1 = _e.sent();\n                        e_2 = { error: e_2_1 };\n                        return [3 /*break*/, 16];\n                    case 15:\n                        try {\n                            if (enrichment_1_1 && !enrichment_1_1.done && (_d = enrichment_1.return)) _d.call(enrichment_1);\n                        }\n                        finally { if (e_2) throw e_2.error; }\n                        return [7 /*endfinally*/];\n                    case 16:\n                        destination = this.plugins.filter(function (plugin) { return plugin.type === 'destination'; });\n                        executeDestinations = destination.map(function (plugin) {\n                            var eventClone = __assign({}, event);\n                            return plugin.execute(eventClone).catch(function (e) { return buildResult(eventClone, 0, String(e)); });\n                        });\n                        void Promise.all(executeDestinations).then(function (_a) {\n                            var _b = __read(_a, 1), result = _b[0];\n                            resolve(result);\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Timeline.prototype.flush = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var queue, destination, executeDestinations;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        queue = this.queue;\n                        this.queue = [];\n                        return [4 /*yield*/, Promise.all(queue.map(function (item) { return _this.apply(item); }))];\n                    case 1:\n                        _a.sent();\n                        destination = this.plugins.filter(function (plugin) { return plugin.type === 'destination'; });\n                        executeDestinations = destination.map(function (plugin) {\n                            return plugin.flush && plugin.flush();\n                        });\n                        return [4 /*yield*/, Promise.all(executeDestinations)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return Timeline;\n}());\nexport { Timeline };\n//# sourceMappingURL=timeline.js.map","import { __awaiter, __generator, __values } from \"tslib\";\nimport { createGroupIdentifyEvent, createIdentifyEvent, createTrackEvent, createRevenueEvent, createGroupEvent, } from './utils/event-builder';\nimport { Timeline } from './timeline';\nimport { buildResult } from './utils/result-builder';\nimport { CLIENT_NOT_INITIALIZED, OPT_OUT_MESSAGE } from './messages';\nimport { returnWrapper } from './utils/return-wrapper';\nvar AmplitudeCore = /** @class */ (function () {\n    function AmplitudeCore(name) {\n        if (name === void 0) { name = '$default'; }\n        this.initializing = false;\n        this.q = [];\n        this.dispatchQ = [];\n        this.logEvent = this.track.bind(this);\n        this.timeline = new Timeline(this);\n        this.name = name;\n    }\n    AmplitudeCore.prototype._init = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.config = config;\n                        this.timeline.reset(this);\n                        return [4 /*yield*/, this.runQueuedFunctions('q')];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeCore.prototype.runQueuedFunctions = function (queueName) {\n        return __awaiter(this, void 0, void 0, function () {\n            var queuedFunctions, queuedFunctions_1, queuedFunctions_1_1, queuedFunction, e_1_1;\n            var e_1, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        queuedFunctions = this[queueName];\n                        this[queueName] = [];\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 6, 7, 8]);\n                        queuedFunctions_1 = __values(queuedFunctions), queuedFunctions_1_1 = queuedFunctions_1.next();\n                        _b.label = 2;\n                    case 2:\n                        if (!!queuedFunctions_1_1.done) return [3 /*break*/, 5];\n                        queuedFunction = queuedFunctions_1_1.value;\n                        return [4 /*yield*/, queuedFunction()];\n                    case 3:\n                        _b.sent();\n                        _b.label = 4;\n                    case 4:\n                        queuedFunctions_1_1 = queuedFunctions_1.next();\n                        return [3 /*break*/, 2];\n                    case 5: return [3 /*break*/, 8];\n                    case 6:\n                        e_1_1 = _b.sent();\n                        e_1 = { error: e_1_1 };\n                        return [3 /*break*/, 8];\n                    case 7:\n                        try {\n                            if (queuedFunctions_1_1 && !queuedFunctions_1_1.done && (_a = queuedFunctions_1.return)) _a.call(queuedFunctions_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                        return [7 /*endfinally*/];\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeCore.prototype.track = function (eventInput, eventProperties, eventOptions) {\n        var event = createTrackEvent(eventInput, eventProperties, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.identify = function (identify, eventOptions) {\n        var event = createIdentifyEvent(identify, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.groupIdentify = function (groupType, groupName, identify, eventOptions) {\n        var event = createGroupIdentifyEvent(groupType, groupName, identify, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.setGroup = function (groupType, groupName, eventOptions) {\n        var event = createGroupEvent(groupType, groupName, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.revenue = function (revenue, eventOptions) {\n        var event = createRevenueEvent(revenue, eventOptions);\n        return returnWrapper(this.dispatch(event));\n    };\n    AmplitudeCore.prototype.add = function (plugin) {\n        if (!this.config) {\n            this.q.push(this.add.bind(this, plugin));\n            return returnWrapper();\n        }\n        return returnWrapper(this.timeline.register(plugin, this.config));\n    };\n    AmplitudeCore.prototype.remove = function (pluginName) {\n        if (!this.config) {\n            this.q.push(this.remove.bind(this, pluginName));\n            return returnWrapper();\n        }\n        return returnWrapper(this.timeline.deregister(pluginName));\n    };\n    AmplitudeCore.prototype.dispatchWithCallback = function (event, callback) {\n        if (!this.config) {\n            return callback(buildResult(event, 0, CLIENT_NOT_INITIALIZED));\n        }\n        void this.process(event).then(callback);\n    };\n    AmplitudeCore.prototype.dispatch = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                if (!this.config) {\n                    return [2 /*return*/, new Promise(function (resolve) {\n                            _this.dispatchQ.push(_this.dispatchWithCallback.bind(_this, event, resolve));\n                        })];\n                }\n                return [2 /*return*/, this.process(event)];\n            });\n        });\n    };\n    AmplitudeCore.prototype.process = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var result, e_2, message, result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        // skip event processing if opt out\n                        if (this.config.optOut) {\n                            return [2 /*return*/, buildResult(event, 0, OPT_OUT_MESSAGE)];\n                        }\n                        return [4 /*yield*/, this.timeline.push(event)];\n                    case 1:\n                        result = _a.sent();\n                        result.code === 200\n                            ? this.config.loggerProvider.log(result.message)\n                            : this.config.loggerProvider.error(result.message);\n                        return [2 /*return*/, result];\n                    case 2:\n                        e_2 = _a.sent();\n                        message = String(e_2);\n                        this.config.loggerProvider.error(message);\n                        result = buildResult(event, 0, message);\n                        return [2 /*return*/, result];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeCore.prototype.setOptOut = function (optOut) {\n        if (!this.config) {\n            this.q.push(this.setOptOut.bind(this, Boolean(optOut)));\n            return;\n        }\n        this.config.optOut = Boolean(optOut);\n    };\n    AmplitudeCore.prototype.flush = function () {\n        return returnWrapper(this.timeline.flush());\n    };\n    return AmplitudeCore;\n}());\nexport { AmplitudeCore };\n//# sourceMappingURL=core-client.js.map","import { AnalyticsConnector } from '@amplitude/analytics-connector';\nexport var getAnalyticsConnector = function (instanceName) {\n    if (instanceName === void 0) { instanceName = '$default_instance'; }\n    return AnalyticsConnector.getInstance(instanceName);\n};\nexport var setConnectorUserId = function (userId, instanceName) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    getAnalyticsConnector(instanceName).identityStore.editIdentity().setUserId(userId).commit();\n};\nexport var setConnectorDeviceId = function (deviceId, instanceName) {\n    getAnalyticsConnector(instanceName).identityStore.editIdentity().setDeviceId(deviceId).commit();\n};\n//# sourceMappingURL=analytics-connector.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { getAnalyticsConnector } from '../analytics-connector';\nvar IdentityEventSender = /** @class */ (function () {\n    function IdentityEventSender() {\n        this.name = 'identity';\n        this.type = 'before';\n        this.identityStore = getAnalyticsConnector().identityStore;\n    }\n    IdentityEventSender.prototype.execute = function (context) {\n        return __awaiter(this, void 0, void 0, function () {\n            var userProperties;\n            return __generator(this, function (_a) {\n                userProperties = context.user_properties;\n                if (userProperties) {\n                    this.identityStore.editIdentity().updateUserProperties(userProperties).commit();\n                }\n                return [2 /*return*/, context];\n            });\n        });\n    };\n    IdentityEventSender.prototype.setup = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (config.instanceName) {\n                    this.identityStore = getAnalyticsConnector(config.instanceName).identityStore;\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    return IdentityEventSender;\n}());\nexport { IdentityEventSender };\n//# sourceMappingURL=identity.js.map","import { __assign } from \"tslib\";\n/**\n * Returns false if defaultTracking === false or if defaultTracking[event],\n * otherwise returns true\n */\nvar isTrackingEnabled = function (defaultTracking, event) {\n    if (typeof defaultTracking === 'boolean') {\n        return defaultTracking;\n    }\n    if ((defaultTracking === null || defaultTracking === void 0 ? void 0 : defaultTracking[event]) === false) {\n        return false;\n    }\n    return true;\n};\nexport var isAttributionTrackingEnabled = function (defaultTracking) {\n    return isTrackingEnabled(defaultTracking, 'attribution');\n};\nexport var isFileDownloadTrackingEnabled = function (defaultTracking) {\n    return isTrackingEnabled(defaultTracking, 'fileDownloads');\n};\nexport var isFormInteractionTrackingEnabled = function (defaultTracking) {\n    return isTrackingEnabled(defaultTracking, 'formInteractions');\n};\nexport var isPageViewTrackingEnabled = function (defaultTracking) {\n    return isTrackingEnabled(defaultTracking, 'pageViews');\n};\nexport var isSessionTrackingEnabled = function (defaultTracking) {\n    return isTrackingEnabled(defaultTracking, 'sessions');\n};\nexport var getPageViewTrackingConfig = function (config) {\n    var trackOn = function () { return false; };\n    var trackHistoryChanges = undefined;\n    var eventType;\n    var isDefaultPageViewTrackingEnabled = isPageViewTrackingEnabled(config.defaultTracking);\n    if (isDefaultPageViewTrackingEnabled) {\n        trackOn = undefined;\n        eventType = undefined;\n        if (config.defaultTracking &&\n            typeof config.defaultTracking === 'object' &&\n            config.defaultTracking.pageViews &&\n            typeof config.defaultTracking.pageViews === 'object') {\n            if ('trackOn' in config.defaultTracking.pageViews) {\n                trackOn = config.defaultTracking.pageViews.trackOn;\n            }\n            if ('trackHistoryChanges' in config.defaultTracking.pageViews) {\n                trackHistoryChanges = config.defaultTracking.pageViews.trackHistoryChanges;\n            }\n            if ('eventType' in config.defaultTracking.pageViews && config.defaultTracking.pageViews.eventType) {\n                eventType = config.defaultTracking.pageViews.eventType;\n            }\n        }\n    }\n    return {\n        trackOn: trackOn,\n        trackHistoryChanges: trackHistoryChanges,\n        eventType: eventType,\n    };\n};\nexport var getAttributionTrackingConfig = function (config) {\n    if (isAttributionTrackingEnabled(config.defaultTracking) &&\n        config.defaultTracking &&\n        typeof config.defaultTracking === 'object' &&\n        config.defaultTracking.attribution &&\n        typeof config.defaultTracking.attribution === 'object') {\n        return __assign({}, config.defaultTracking.attribution);\n    }\n    return {};\n};\n//# sourceMappingURL=default-tracking.js.map","/**\n * Applies the proxied functions on the proxied amplitude snippet to an instance of the real object.\n * @ignore\n */\nexport var runQueuedFunctions = function (instance, queue) {\n    convertProxyObjectToRealObject(instance, queue);\n};\n/**\n * Applies the proxied functions on the proxied object to an instance of the real object.\n * Used to convert proxied Identify and Revenue objects.\n */\nexport var convertProxyObjectToRealObject = function (instance, queue) {\n    for (var i = 0; i < queue.length; i++) {\n        var _a = queue[i], name_1 = _a.name, args = _a.args, resolve = _a.resolve;\n        var fn = instance && instance[name_1];\n        if (typeof fn === 'function') {\n            var result = fn.apply(instance, args);\n            if (typeof resolve === 'function') {\n                resolve(result === null || result === void 0 ? void 0 : result.promise);\n            }\n        }\n    }\n    return instance;\n};\n/**\n * Check if the param is snippet proxy\n */\nexport var isInstanceProxy = function (instance) {\n    var instanceProxy = instance;\n    return instanceProxy && instanceProxy._q !== undefined;\n};\n//# sourceMappingURL=snippet-helper.js.map","export var getLanguage = function () {\n    var _a, _b, _c, _d;\n    if (typeof navigator === 'undefined')\n        return '';\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    var userLanguage = navigator.userLanguage;\n    return (_d = (_c = (_b = (_a = navigator.languages) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : navigator.language) !== null && _c !== void 0 ? _c : userLanguage) !== null && _d !== void 0 ? _d : '';\n};\n//# sourceMappingURL=language.js.map","import { __assign, __awaiter, __generator } from \"tslib\";\nimport { UUID } from '@amplitude/analytics-core';\nimport { getLanguage } from '@amplitude/analytics-client-common';\nimport { VERSION } from '../version';\nvar BROWSER_PLATFORM = 'Web';\nvar IP_ADDRESS = '$remote';\nvar Context = /** @class */ (function () {\n    function Context() {\n        this.name = '@amplitude/plugin-context-browser';\n        this.type = 'before';\n        this.library = \"amplitude-ts/\".concat(VERSION);\n        /* istanbul ignore else */\n        if (typeof navigator !== 'undefined') {\n            this.userAgent = navigator.userAgent;\n        }\n    }\n    Context.prototype.setup = function (config) {\n        this.config = config;\n        return Promise.resolve(undefined);\n    };\n    Context.prototype.execute = function (context) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var time, lastEventId, nextEventId, event;\n            return __generator(this, function (_c) {\n                time = new Date().getTime();\n                lastEventId = (_a = this.config.lastEventId) !== null && _a !== void 0 ? _a : -1;\n                nextEventId = (_b = context.event_id) !== null && _b !== void 0 ? _b : lastEventId + 1;\n                this.config.lastEventId = nextEventId;\n                if (!context.time) {\n                    this.config.lastEventTime = time;\n                }\n                event = __assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign({ user_id: this.config.userId, device_id: this.config.deviceId, session_id: this.config.sessionId, time: time }, (this.config.appVersion && { app_version: this.config.appVersion })), (this.config.trackingOptions.platform && { platform: BROWSER_PLATFORM })), (this.config.trackingOptions.language && { language: getLanguage() })), (this.config.trackingOptions.ipAddress && { ip: IP_ADDRESS })), { insert_id: UUID(), partner_id: this.config.partnerId, plan: this.config.plan }), (this.config.ingestionMetadata && {\n                    ingestion_metadata: {\n                        source_name: this.config.ingestionMetadata.sourceName,\n                        source_version: this.config.ingestionMetadata.sourceVersion,\n                    },\n                })), context), { event_id: nextEventId, library: this.library, user_agent: this.userAgent });\n                return [2 /*return*/, event];\n            });\n        });\n    };\n    return Context;\n}());\nexport { Context };\n//# sourceMappingURL=context.js.map","export var VERSION = '2.1.2';\n//# sourceMappingURL=version.js.map","import { __awaiter, __generator } from \"tslib\";\nvar MemoryStorage = /** @class */ (function () {\n    function MemoryStorage() {\n        this.memoryStorage = new Map();\n    }\n    MemoryStorage.prototype.isEnabled = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, true];\n            });\n        });\n    };\n    MemoryStorage.prototype.get = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.memoryStorage.get(key)];\n            });\n        });\n    };\n    MemoryStorage.prototype.getRaw = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            var value;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.get(key)];\n                    case 1:\n                        value = _a.sent();\n                        return [2 /*return*/, value ? JSON.stringify(value) : undefined];\n                }\n            });\n        });\n    };\n    MemoryStorage.prototype.set = function (key, value) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.memoryStorage.set(key, value);\n                return [2 /*return*/];\n            });\n        });\n    };\n    MemoryStorage.prototype.remove = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.memoryStorage.delete(key);\n                return [2 /*return*/];\n            });\n        });\n    };\n    MemoryStorage.prototype.reset = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.memoryStorage.clear();\n                return [2 /*return*/];\n            });\n        });\n    };\n    return MemoryStorage;\n}());\nexport { MemoryStorage };\n//# sourceMappingURL=memory.js.map","import { AMPLITUDE_PREFIX } from '@amplitude/analytics-core';\nexport var getCookieName = function (apiKey, postKey, limit) {\n    if (postKey === void 0) { postKey = ''; }\n    if (limit === void 0) { limit = 10; }\n    return [AMPLITUDE_PREFIX, postKey, apiKey.substring(0, limit)].filter(Boolean).join('_');\n};\nexport var getOldCookieName = function (apiKey) {\n    return \"\".concat(AMPLITUDE_PREFIX.toLowerCase(), \"_\").concat(apiKey.substring(0, 6));\n};\n//# sourceMappingURL=cookie-name.js.map","import { getGlobalScope } from './global-scope';\nexport var getQueryParams = function () {\n    var _a;\n    var globalScope = getGlobalScope();\n    /* istanbul ignore if */\n    if (!((_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.location) === null || _a === void 0 ? void 0 : _a.search)) {\n        return {};\n    }\n    var pairs = globalScope.location.search.substring(1).split('&').filter(Boolean);\n    var params = pairs.reduce(function (acc, curr) {\n        var query = curr.split('=', 2);\n        var key = tryDecodeURIComponent(query[0]);\n        var value = tryDecodeURIComponent(query[1]);\n        if (!value) {\n            return acc;\n        }\n        acc[key] = value;\n        return acc;\n    }, {});\n    return params;\n};\nexport var tryDecodeURIComponent = function (value) {\n    if (value === void 0) { value = ''; }\n    try {\n        return decodeURIComponent(value);\n    }\n    catch (_a) {\n        return '';\n    }\n};\n//# sourceMappingURL=query-params.js.map","import { __assign, __awaiter, __generator } from \"tslib\";\nimport { getGlobalScope } from '../global-scope';\nvar CookieStorage = /** @class */ (function () {\n    function CookieStorage(options) {\n        this.options = __assign({}, options);\n    }\n    CookieStorage.prototype.isEnabled = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var testStrorage, testKey, value, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        /* istanbul ignore if */\n                        if (!getGlobalScope()) {\n                            return [2 /*return*/, false];\n                        }\n                        CookieStorage.testValue = String(Date.now());\n                        testStrorage = new CookieStorage(this.options);\n                        testKey = 'AMP_TEST';\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, 5, 7]);\n                        return [4 /*yield*/, testStrorage.set(testKey, CookieStorage.testValue)];\n                    case 2:\n                        _b.sent();\n                        return [4 /*yield*/, testStrorage.get(testKey)];\n                    case 3:\n                        value = _b.sent();\n                        return [2 /*return*/, value === CookieStorage.testValue];\n                    case 4:\n                        _a = _b.sent();\n                        /* istanbul ignore next */\n                        return [2 /*return*/, false];\n                    case 5: return [4 /*yield*/, testStrorage.remove(testKey)];\n                    case 6:\n                        _b.sent();\n                        return [7 /*endfinally*/];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CookieStorage.prototype.get = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            var value;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getRaw(key)];\n                    case 1:\n                        value = _a.sent();\n                        if (!value) {\n                            return [2 /*return*/, undefined];\n                        }\n                        try {\n                            try {\n                                value = decodeURIComponent(atob(value));\n                            }\n                            catch (_b) {\n                                // value not encoded\n                            }\n                            // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n                            return [2 /*return*/, JSON.parse(value)];\n                        }\n                        catch (_c) {\n                            /* istanbul ignore next */\n                            return [2 /*return*/, undefined];\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CookieStorage.prototype.getRaw = function (key) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var globalScope, cookie, match;\n            return __generator(this, function (_c) {\n                globalScope = getGlobalScope();\n                cookie = (_b = (_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.document) === null || _a === void 0 ? void 0 : _a.cookie.split('; ')) !== null && _b !== void 0 ? _b : [];\n                match = cookie.find(function (c) { return c.indexOf(key + '=') === 0; });\n                if (!match) {\n                    return [2 /*return*/, undefined];\n                }\n                return [2 /*return*/, match.substring(key.length + 1)];\n            });\n        });\n    };\n    CookieStorage.prototype.set = function (key, value) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var expirationDays, expires, expireDate, date, str, globalScope;\n            return __generator(this, function (_b) {\n                try {\n                    expirationDays = (_a = this.options.expirationDays) !== null && _a !== void 0 ? _a : 0;\n                    expires = value !== null ? expirationDays : -1;\n                    expireDate = undefined;\n                    if (expires) {\n                        date = new Date();\n                        date.setTime(date.getTime() + expires * 24 * 60 * 60 * 1000);\n                        expireDate = date;\n                    }\n                    str = \"\".concat(key, \"=\").concat(btoa(encodeURIComponent(JSON.stringify(value))));\n                    if (expireDate) {\n                        str += \"; expires=\".concat(expireDate.toUTCString());\n                    }\n                    str += '; path=/';\n                    if (this.options.domain) {\n                        str += \"; domain=\".concat(this.options.domain);\n                    }\n                    if (this.options.secure) {\n                        str += '; Secure';\n                    }\n                    if (this.options.sameSite) {\n                        str += \"; SameSite=\".concat(this.options.sameSite);\n                    }\n                    globalScope = getGlobalScope();\n                    if (globalScope) {\n                        globalScope.document.cookie = str;\n                    }\n                }\n                catch (_c) {\n                    //\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    CookieStorage.prototype.remove = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.set(key, null)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    CookieStorage.prototype.reset = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/];\n            });\n        });\n    };\n    return CookieStorage;\n}());\nexport { CookieStorage };\n//# sourceMappingURL=cookie.js.map","/* eslint-disable @typescript-eslint/no-unsafe-argument */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport { Status } from '@amplitude/analytics-types';\nvar BaseTransport = /** @class */ (function () {\n    function BaseTransport() {\n    }\n    BaseTransport.prototype.send = function (_serverUrl, _payload) {\n        return Promise.resolve(null);\n    };\n    BaseTransport.prototype.buildResponse = function (responseJSON) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x;\n        if (typeof responseJSON !== 'object') {\n            return null;\n        }\n        var statusCode = responseJSON.code || 0;\n        var status = this.buildStatus(statusCode);\n        switch (status) {\n            case Status.Success:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        eventsIngested: (_a = responseJSON.events_ingested) !== null && _a !== void 0 ? _a : 0,\n                        payloadSizeBytes: (_b = responseJSON.payload_size_bytes) !== null && _b !== void 0 ? _b : 0,\n                        serverUploadTime: (_c = responseJSON.server_upload_time) !== null && _c !== void 0 ? _c : 0,\n                    },\n                };\n            case Status.Invalid:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        error: (_d = responseJSON.error) !== null && _d !== void 0 ? _d : '',\n                        missingField: (_e = responseJSON.missing_field) !== null && _e !== void 0 ? _e : '',\n                        eventsWithInvalidFields: (_f = responseJSON.events_with_invalid_fields) !== null && _f !== void 0 ? _f : {},\n                        eventsWithMissingFields: (_g = responseJSON.events_with_missing_fields) !== null && _g !== void 0 ? _g : {},\n                        eventsWithInvalidIdLengths: (_h = responseJSON.events_with_invalid_id_lengths) !== null && _h !== void 0 ? _h : {},\n                        epsThreshold: (_j = responseJSON.eps_threshold) !== null && _j !== void 0 ? _j : 0,\n                        exceededDailyQuotaDevices: (_k = responseJSON.exceeded_daily_quota_devices) !== null && _k !== void 0 ? _k : {},\n                        silencedDevices: (_l = responseJSON.silenced_devices) !== null && _l !== void 0 ? _l : [],\n                        silencedEvents: (_m = responseJSON.silenced_events) !== null && _m !== void 0 ? _m : [],\n                        throttledDevices: (_o = responseJSON.throttled_devices) !== null && _o !== void 0 ? _o : {},\n                        throttledEvents: (_p = responseJSON.throttled_events) !== null && _p !== void 0 ? _p : [],\n                    },\n                };\n            case Status.PayloadTooLarge:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        error: (_q = responseJSON.error) !== null && _q !== void 0 ? _q : '',\n                    },\n                };\n            case Status.RateLimit:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                    body: {\n                        error: (_r = responseJSON.error) !== null && _r !== void 0 ? _r : '',\n                        epsThreshold: (_s = responseJSON.eps_threshold) !== null && _s !== void 0 ? _s : 0,\n                        throttledDevices: (_t = responseJSON.throttled_devices) !== null && _t !== void 0 ? _t : {},\n                        throttledUsers: (_u = responseJSON.throttled_users) !== null && _u !== void 0 ? _u : {},\n                        exceededDailyQuotaDevices: (_v = responseJSON.exceeded_daily_quota_devices) !== null && _v !== void 0 ? _v : {},\n                        exceededDailyQuotaUsers: (_w = responseJSON.exceeded_daily_quota_users) !== null && _w !== void 0 ? _w : {},\n                        throttledEvents: (_x = responseJSON.throttled_events) !== null && _x !== void 0 ? _x : [],\n                    },\n                };\n            case Status.Timeout:\n            default:\n                return {\n                    status: status,\n                    statusCode: statusCode,\n                };\n        }\n    };\n    BaseTransport.prototype.buildStatus = function (code) {\n        if (code >= 200 && code < 300) {\n            return Status.Success;\n        }\n        if (code === 429) {\n            return Status.RateLimit;\n        }\n        if (code === 413) {\n            return Status.PayloadTooLarge;\n        }\n        if (code === 408) {\n            return Status.Timeout;\n        }\n        if (code >= 400 && code < 500) {\n            return Status.Invalid;\n        }\n        if (code >= 500) {\n            return Status.Failed;\n        }\n        return Status.Unknown;\n    };\n    return BaseTransport;\n}());\nexport { BaseTransport };\n//# sourceMappingURL=base.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\nimport { BaseTransport } from '@amplitude/analytics-core';\nvar FetchTransport = /** @class */ (function (_super) {\n    __extends(FetchTransport, _super);\n    function FetchTransport() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FetchTransport.prototype.send = function (serverUrl, payload) {\n        return __awaiter(this, void 0, void 0, function () {\n            var options, response, responsePayload;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        /* istanbul ignore if */\n                        if (typeof fetch === 'undefined') {\n                            throw new Error('FetchTransport is not supported');\n                        }\n                        options = {\n                            headers: {\n                                'Content-Type': 'application/json',\n                                Accept: '*/*',\n                            },\n                            body: JSON.stringify(payload),\n                            method: 'POST',\n                        };\n                        return [4 /*yield*/, fetch(serverUrl, options)];\n                    case 1:\n                        response = _a.sent();\n                        return [4 /*yield*/, response.json()];\n                    case 2:\n                        responsePayload = _a.sent();\n                        return [2 /*return*/, this.buildResponse(responsePayload)];\n                }\n            });\n        });\n    };\n    return FetchTransport;\n}(BaseTransport));\nexport { FetchTransport };\n//# sourceMappingURL=fetch.js.map","import { __awaiter, __generator } from \"tslib\";\nvar BrowserStorage = /** @class */ (function () {\n    function BrowserStorage(storage) {\n        this.storage = storage;\n    }\n    BrowserStorage.prototype.isEnabled = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var random, testStorage, testKey, value, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        /* istanbul ignore if */\n                        if (!this.storage) {\n                            return [2 /*return*/, false];\n                        }\n                        random = String(Date.now());\n                        testStorage = new BrowserStorage(this.storage);\n                        testKey = 'AMP_TEST';\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 4, 5, 7]);\n                        return [4 /*yield*/, testStorage.set(testKey, random)];\n                    case 2:\n                        _b.sent();\n                        return [4 /*yield*/, testStorage.get(testKey)];\n                    case 3:\n                        value = _b.sent();\n                        return [2 /*return*/, value === random];\n                    case 4:\n                        _a = _b.sent();\n                        /* istanbul ignore next */\n                        return [2 /*return*/, false];\n                    case 5: return [4 /*yield*/, testStorage.remove(testKey)];\n                    case 6:\n                        _b.sent();\n                        return [7 /*endfinally*/];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BrowserStorage.prototype.get = function (key) {\n        return __awaiter(this, void 0, void 0, function () {\n            var value, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _b.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, this.getRaw(key)];\n                    case 1:\n                        value = _b.sent();\n                        if (!value) {\n                            return [2 /*return*/, undefined];\n                        }\n                        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n                        return [2 /*return*/, JSON.parse(value)];\n                    case 2:\n                        _a = _b.sent();\n                        console.error(\"[Amplitude] Error: Could not get value from storage\");\n                        return [2 /*return*/, undefined];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    BrowserStorage.prototype.getRaw = function (key) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                return [2 /*return*/, ((_a = this.storage) === null || _a === void 0 ? void 0 : _a.getItem(key)) || undefined];\n            });\n        });\n    };\n    BrowserStorage.prototype.set = function (key, value) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                try {\n                    (_a = this.storage) === null || _a === void 0 ? void 0 : _a.setItem(key, JSON.stringify(value));\n                }\n                catch (_c) {\n                    //\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    BrowserStorage.prototype.remove = function (key) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                try {\n                    (_a = this.storage) === null || _a === void 0 ? void 0 : _a.removeItem(key);\n                }\n                catch (_c) {\n                    //\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    BrowserStorage.prototype.reset = function () {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_b) {\n                try {\n                    (_a = this.storage) === null || _a === void 0 ? void 0 : _a.clear();\n                }\n                catch (_c) {\n                    //\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    return BrowserStorage;\n}());\nexport { BrowserStorage };\n//# sourceMappingURL=browser-storage.js.map","import { __extends } from \"tslib\";\nimport { getGlobalScope } from '@amplitude/analytics-client-common';\nimport { BrowserStorage } from './browser-storage';\nvar LocalStorage = /** @class */ (function (_super) {\n    __extends(LocalStorage, _super);\n    function LocalStorage() {\n        var _a;\n        return _super.call(this, (_a = getGlobalScope()) === null || _a === void 0 ? void 0 : _a.localStorage) || this;\n    }\n    return LocalStorage;\n}(BrowserStorage));\nexport { LocalStorage };\n//# sourceMappingURL=local-storage.js.map","import { __extends } from \"tslib\";\nimport { getGlobalScope } from '@amplitude/analytics-client-common';\nimport { BrowserStorage } from './browser-storage';\nvar SessionStorage = /** @class */ (function (_super) {\n    __extends(SessionStorage, _super);\n    function SessionStorage() {\n        var _a;\n        return _super.call(this, (_a = getGlobalScope()) === null || _a === void 0 ? void 0 : _a.sessionStorage) || this;\n    }\n    return SessionStorage;\n}(BrowserStorage));\nexport { SessionStorage };\n//# sourceMappingURL=session-storage.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\nimport { BaseTransport } from '@amplitude/analytics-core';\nvar XHRTransport = /** @class */ (function (_super) {\n    __extends(XHRTransport, _super);\n    function XHRTransport() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            done: 4,\n        };\n        return _this;\n    }\n    XHRTransport.prototype.send = function (serverUrl, payload) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        /* istanbul ignore if */\n                        if (typeof XMLHttpRequest === 'undefined') {\n                            reject(new Error('XHRTransport is not supported.'));\n                        }\n                        var xhr = new XMLHttpRequest();\n                        xhr.open('POST', serverUrl, true);\n                        xhr.onreadystatechange = function () {\n                            if (xhr.readyState === _this.state.done) {\n                                try {\n                                    var responsePayload = xhr.responseText;\n                                    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                                    var parsedResponsePayload = JSON.parse(responsePayload);\n                                    var result = _this.buildResponse(parsedResponsePayload);\n                                    resolve(result);\n                                }\n                                catch (e) {\n                                    reject(e);\n                                }\n                            }\n                        };\n                        xhr.setRequestHeader('Content-Type', 'application/json');\n                        xhr.setRequestHeader('Accept', '*/*');\n                        xhr.send(JSON.stringify(payload));\n                    })];\n            });\n        });\n    };\n    return XHRTransport;\n}(BaseTransport));\nexport { XHRTransport };\n//# sourceMappingURL=xhr.js.map","import { __awaiter, __extends, __generator } from \"tslib\";\nimport { getGlobalScope } from '@amplitude/analytics-client-common';\nimport { BaseTransport } from '@amplitude/analytics-core';\nvar SendBeaconTransport = /** @class */ (function (_super) {\n    __extends(SendBeaconTransport, _super);\n    function SendBeaconTransport() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SendBeaconTransport.prototype.send = function (serverUrl, payload) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Promise(function (resolve, reject) {\n                        var globalScope = getGlobalScope();\n                        /* istanbul ignore if */\n                        if (!(globalScope === null || globalScope === void 0 ? void 0 : globalScope.navigator.sendBeacon)) {\n                            throw new Error('SendBeaconTransport is not supported');\n                        }\n                        try {\n                            var data = JSON.stringify(payload);\n                            var success = globalScope.navigator.sendBeacon(serverUrl, JSON.stringify(payload));\n                            if (success) {\n                                return resolve(_this.buildResponse({\n                                    code: 200,\n                                    events_ingested: payload.events.length,\n                                    payload_size_bytes: data.length,\n                                    server_upload_time: Date.now(),\n                                }));\n                            }\n                            return resolve(_this.buildResponse({ code: 500 }));\n                        }\n                        catch (e) {\n                            reject(e);\n                        }\n                    })];\n            });\n        });\n    };\n    return SendBeaconTransport;\n}(BaseTransport));\nexport { SendBeaconTransport };\n//# sourceMappingURL=send-beacon.js.map","import { __awaiter, __generator, __read } from \"tslib\";\nimport { getOldCookieName } from '@amplitude/analytics-client-common';\nexport var parseLegacyCookies = function (apiKey, cookieStorage, deleteLegacyCookies) {\n    if (deleteLegacyCookies === void 0) { deleteLegacyCookies = true; }\n    return __awaiter(void 0, void 0, void 0, function () {\n        var cookieName, cookies, _a, deviceId, userId, optOut, sessionId, lastEventTime, lastEventId;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    cookieName = getOldCookieName(apiKey);\n                    return [4 /*yield*/, cookieStorage.getRaw(cookieName)];\n                case 1:\n                    cookies = _b.sent();\n                    if (!cookies) {\n                        return [2 /*return*/, {\n                                optOut: false,\n                            }];\n                    }\n                    if (!deleteLegacyCookies) return [3 /*break*/, 3];\n                    return [4 /*yield*/, cookieStorage.remove(cookieName)];\n                case 2:\n                    _b.sent();\n                    _b.label = 3;\n                case 3:\n                    _a = __read(cookies.split('.'), 6), deviceId = _a[0], userId = _a[1], optOut = _a[2], sessionId = _a[3], lastEventTime = _a[4], lastEventId = _a[5];\n                    return [2 /*return*/, {\n                            deviceId: deviceId,\n                            userId: decode(userId),\n                            sessionId: parseTime(sessionId),\n                            lastEventId: parseTime(lastEventId),\n                            lastEventTime: parseTime(lastEventTime),\n                            optOut: Boolean(optOut),\n                        }];\n            }\n        });\n    });\n};\nexport var parseTime = function (num) {\n    var integer = parseInt(num, 32);\n    if (isNaN(integer)) {\n        return undefined;\n    }\n    return integer;\n};\nexport var decode = function (value) {\n    if (!atob || !escape || !value) {\n        return undefined;\n    }\n    try {\n        return decodeURIComponent(escape(atob(value)));\n    }\n    catch (_a) {\n        return undefined;\n    }\n};\n//# sourceMappingURL=index.js.map","export var DEFAULT_EVENT_PREFIX = '[Amplitude]';\nexport var DEFAULT_PAGE_VIEW_EVENT = \"\".concat(DEFAULT_EVENT_PREFIX, \" Page Viewed\");\nexport var DEFAULT_FORM_START_EVENT = \"\".concat(DEFAULT_EVENT_PREFIX, \" Form Started\");\nexport var DEFAULT_FORM_SUBMIT_EVENT = \"\".concat(DEFAULT_EVENT_PREFIX, \" Form Submitted\");\nexport var DEFAULT_FILE_DOWNLOAD_EVENT = \"\".concat(DEFAULT_EVENT_PREFIX, \" File Downloaded\");\nexport var DEFAULT_SESSION_START_EVENT = 'session_start';\nexport var DEFAULT_SESSION_END_EVENT = 'session_end';\nexport var FILE_EXTENSION = \"\".concat(DEFAULT_EVENT_PREFIX, \" File Extension\");\nexport var FILE_NAME = \"\".concat(DEFAULT_EVENT_PREFIX, \" File Name\");\nexport var LINK_ID = \"\".concat(DEFAULT_EVENT_PREFIX, \" Link ID\");\nexport var LINK_TEXT = \"\".concat(DEFAULT_EVENT_PREFIX, \" Link Text\");\nexport var LINK_URL = \"\".concat(DEFAULT_EVENT_PREFIX, \" Link URL\");\nexport var FORM_ID = \"\".concat(DEFAULT_EVENT_PREFIX, \" Form ID\");\nexport var FORM_NAME = \"\".concat(DEFAULT_EVENT_PREFIX, \" Form Name\");\nexport var FORM_DESTINATION = \"\".concat(DEFAULT_EVENT_PREFIX, \" Form Destination\");\nexport var DEFAULT_IDENTITY_STORAGE = 'cookie';\nexport var DEFAULT_SERVER_ZONE = 'US';\n//# sourceMappingURL=constants.js.map","import { __assign, __awaiter, __extends, __generator } from \"tslib\";\nimport { LogLevel, } from '@amplitude/analytics-types';\nimport { Config, Logger, MemoryStorage, UUID } from '@amplitude/analytics-core';\nimport { CookieStorage, getCookieName, FetchTransport, getQueryParams } from '@amplitude/analytics-client-common';\nimport { LocalStorage } from './storage/local-storage';\nimport { SessionStorage } from './storage/session-storage';\nimport { XHRTransport } from './transports/xhr';\nimport { SendBeaconTransport } from './transports/send-beacon';\nimport { parseLegacyCookies } from './cookie-migration';\nimport { DEFAULT_IDENTITY_STORAGE, DEFAULT_SERVER_ZONE } from './constants';\n// Exported for testing purposes only. Do not expose to public interface.\nvar BrowserConfig = /** @class */ (function (_super) {\n    __extends(BrowserConfig, _super);\n    function BrowserConfig(apiKey, appVersion, cookieStorage, cookieOptions, defaultTracking, deviceId, flushIntervalMillis, flushMaxRetries, flushQueueSize, identityStorage, ingestionMetadata, instanceName, lastEventId, lastEventTime, loggerProvider, logLevel, minIdLength, optOut, partnerId, plan, serverUrl, serverZone, sessionId, sessionTimeout, storageProvider, trackingOptions, transport, useBatch, userId) {\n        if (cookieStorage === void 0) { cookieStorage = new MemoryStorage(); }\n        if (cookieOptions === void 0) { cookieOptions = {\n            domain: '',\n            expiration: 365,\n            sameSite: 'Lax',\n            secure: false,\n            upgrade: true,\n        }; }\n        if (defaultTracking === void 0) { defaultTracking = true; }\n        if (flushIntervalMillis === void 0) { flushIntervalMillis = 1000; }\n        if (flushMaxRetries === void 0) { flushMaxRetries = 5; }\n        if (flushQueueSize === void 0) { flushQueueSize = 30; }\n        if (identityStorage === void 0) { identityStorage = DEFAULT_IDENTITY_STORAGE; }\n        if (loggerProvider === void 0) { loggerProvider = new Logger(); }\n        if (logLevel === void 0) { logLevel = LogLevel.Warn; }\n        if (optOut === void 0) { optOut = false; }\n        if (serverUrl === void 0) { serverUrl = ''; }\n        if (serverZone === void 0) { serverZone = DEFAULT_SERVER_ZONE; }\n        if (sessionTimeout === void 0) { sessionTimeout = 30 * 60 * 1000; }\n        if (storageProvider === void 0) { storageProvider = new LocalStorage(); }\n        if (trackingOptions === void 0) { trackingOptions = {\n            ipAddress: true,\n            language: true,\n            platform: true,\n        }; }\n        if (transport === void 0) { transport = 'fetch'; }\n        if (useBatch === void 0) { useBatch = false; }\n        var _this = _super.call(this, { apiKey: apiKey, storageProvider: storageProvider, transportProvider: createTransport(transport) }) || this;\n        _this.apiKey = apiKey;\n        _this.appVersion = appVersion;\n        _this.cookieOptions = cookieOptions;\n        _this.defaultTracking = defaultTracking;\n        _this.flushIntervalMillis = flushIntervalMillis;\n        _this.flushMaxRetries = flushMaxRetries;\n        _this.flushQueueSize = flushQueueSize;\n        _this.identityStorage = identityStorage;\n        _this.ingestionMetadata = ingestionMetadata;\n        _this.instanceName = instanceName;\n        _this.loggerProvider = loggerProvider;\n        _this.logLevel = logLevel;\n        _this.minIdLength = minIdLength;\n        _this.partnerId = partnerId;\n        _this.plan = plan;\n        _this.serverUrl = serverUrl;\n        _this.serverZone = serverZone;\n        _this.sessionTimeout = sessionTimeout;\n        _this.storageProvider = storageProvider;\n        _this.trackingOptions = trackingOptions;\n        _this.transport = transport;\n        _this.useBatch = useBatch;\n        _this._optOut = false;\n        _this._cookieStorage = cookieStorage;\n        _this.deviceId = deviceId;\n        _this.lastEventId = lastEventId;\n        _this.lastEventTime = lastEventTime;\n        _this.optOut = optOut;\n        _this.sessionId = sessionId;\n        _this.userId = userId;\n        _this.loggerProvider.enable(_this.logLevel);\n        return _this;\n    }\n    Object.defineProperty(BrowserConfig.prototype, \"cookieStorage\", {\n        get: function () {\n            return this._cookieStorage;\n        },\n        set: function (cookieStorage) {\n            if (this._cookieStorage !== cookieStorage) {\n                this._cookieStorage = cookieStorage;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BrowserConfig.prototype, \"deviceId\", {\n        get: function () {\n            return this._deviceId;\n        },\n        set: function (deviceId) {\n            if (this._deviceId !== deviceId) {\n                this._deviceId = deviceId;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BrowserConfig.prototype, \"userId\", {\n        get: function () {\n            return this._userId;\n        },\n        set: function (userId) {\n            if (this._userId !== userId) {\n                this._userId = userId;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BrowserConfig.prototype, \"sessionId\", {\n        get: function () {\n            return this._sessionId;\n        },\n        set: function (sessionId) {\n            if (this._sessionId !== sessionId) {\n                this._sessionId = sessionId;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BrowserConfig.prototype, \"optOut\", {\n        get: function () {\n            return this._optOut;\n        },\n        set: function (optOut) {\n            if (this._optOut !== optOut) {\n                this._optOut = optOut;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BrowserConfig.prototype, \"lastEventTime\", {\n        get: function () {\n            return this._lastEventTime;\n        },\n        set: function (lastEventTime) {\n            if (this._lastEventTime !== lastEventTime) {\n                this._lastEventTime = lastEventTime;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BrowserConfig.prototype, \"lastEventId\", {\n        get: function () {\n            return this._lastEventId;\n        },\n        set: function (lastEventId) {\n            if (this._lastEventId !== lastEventId) {\n                this._lastEventId = lastEventId;\n                this.updateStorage();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    BrowserConfig.prototype.updateStorage = function () {\n        var cache = {\n            deviceId: this._deviceId,\n            userId: this._userId,\n            sessionId: this._sessionId,\n            optOut: this._optOut,\n            lastEventTime: this._lastEventTime,\n            lastEventId: this._lastEventId,\n        };\n        void this.cookieStorage.set(getCookieName(this.apiKey), cache);\n    };\n    return BrowserConfig;\n}(Config));\nexport { BrowserConfig };\nexport var useBrowserConfig = function (apiKey, options, amplitudeInstance) {\n    if (options === void 0) { options = {}; }\n    return __awaiter(void 0, void 0, void 0, function () {\n        var identityStorage, cookieOptions, _a, _b, _c, cookieStorage, legacyCookies, previousCookies, queryParams, deviceId, lastEventId, lastEventTime, optOut, sessionId, userId, trackingOptions;\n        var _d;\n        var _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w;\n        return __generator(this, function (_x) {\n            switch (_x.label) {\n                case 0:\n                    identityStorage = options.identityStorage || DEFAULT_IDENTITY_STORAGE;\n                    _a = [__assign({}, options.cookieOptions)];\n                    _d = {};\n                    if (!(identityStorage !== DEFAULT_IDENTITY_STORAGE)) return [3 /*break*/, 1];\n                    _b = '';\n                    return [3 /*break*/, 5];\n                case 1:\n                    if (!((_f = (_e = options.cookieOptions) === null || _e === void 0 ? void 0 : _e.domain) !== null && _f !== void 0)) return [3 /*break*/, 2];\n                    _c = _f;\n                    return [3 /*break*/, 4];\n                case 2: return [4 /*yield*/, getTopLevelDomain()];\n                case 3:\n                    _c = (_x.sent());\n                    _x.label = 4;\n                case 4:\n                    _b = _c;\n                    _x.label = 5;\n                case 5:\n                    cookieOptions = __assign.apply(void 0, _a.concat([(_d.domain = _b, _d.expiration = 365, _d.sameSite = 'Lax', _d.secure = false, _d.upgrade = true, _d)]));\n                    cookieStorage = createCookieStorage(options.identityStorage, cookieOptions);\n                    return [4 /*yield*/, parseLegacyCookies(apiKey, cookieStorage, (_h = (_g = options.cookieOptions) === null || _g === void 0 ? void 0 : _g.upgrade) !== null && _h !== void 0 ? _h : true)];\n                case 6:\n                    legacyCookies = _x.sent();\n                    return [4 /*yield*/, cookieStorage.get(getCookieName(apiKey))];\n                case 7:\n                    previousCookies = _x.sent();\n                    queryParams = getQueryParams();\n                    deviceId = (_m = (_l = (_k = (_j = options.deviceId) !== null && _j !== void 0 ? _j : queryParams.deviceId) !== null && _k !== void 0 ? _k : previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.deviceId) !== null && _l !== void 0 ? _l : legacyCookies.deviceId) !== null && _m !== void 0 ? _m : UUID();\n                    lastEventId = (_o = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.lastEventId) !== null && _o !== void 0 ? _o : legacyCookies.lastEventId;\n                    lastEventTime = (_p = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.lastEventTime) !== null && _p !== void 0 ? _p : legacyCookies.lastEventTime;\n                    optOut = (_r = (_q = options.optOut) !== null && _q !== void 0 ? _q : previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.optOut) !== null && _r !== void 0 ? _r : legacyCookies.optOut;\n                    sessionId = (_s = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.sessionId) !== null && _s !== void 0 ? _s : legacyCookies.sessionId;\n                    userId = (_u = (_t = options.userId) !== null && _t !== void 0 ? _t : previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.userId) !== null && _u !== void 0 ? _u : legacyCookies.userId;\n                    amplitudeInstance.previousSessionDeviceId = (_v = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.deviceId) !== null && _v !== void 0 ? _v : legacyCookies.deviceId;\n                    amplitudeInstance.previousSessionUserId = (_w = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.userId) !== null && _w !== void 0 ? _w : legacyCookies.userId;\n                    trackingOptions = __assign(__assign({}, options.trackingOptions), { ipAddress: true, language: true, platform: true });\n                    return [2 /*return*/, new BrowserConfig(apiKey, options.appVersion, cookieStorage, cookieOptions, options.defaultTracking, deviceId, options.flushIntervalMillis, options.flushMaxRetries, options.flushQueueSize, identityStorage, options.ingestionMetadata, options.instanceName, lastEventId, lastEventTime, options.loggerProvider, options.logLevel, options.minIdLength, optOut, options.partnerId, options.plan, options.serverUrl, options.serverZone, sessionId, options.sessionTimeout, options.storageProvider, trackingOptions, options.transport, options.useBatch, userId)];\n            }\n        });\n    });\n};\nexport var createCookieStorage = function (identityStorage, cookieOptions) {\n    if (identityStorage === void 0) { identityStorage = DEFAULT_IDENTITY_STORAGE; }\n    if (cookieOptions === void 0) { cookieOptions = {}; }\n    switch (identityStorage) {\n        case 'localStorage':\n            return new LocalStorage();\n        case 'sessionStorage':\n            return new SessionStorage();\n        case 'none':\n            return new MemoryStorage();\n        case 'cookie':\n        default:\n            return new CookieStorage(__assign(__assign({}, cookieOptions), { expirationDays: cookieOptions.expiration }));\n    }\n};\nexport var createTransport = function (transport) {\n    if (transport === 'xhr') {\n        return new XHRTransport();\n    }\n    if (transport === 'beacon') {\n        return new SendBeaconTransport();\n    }\n    return new FetchTransport();\n};\nexport var getTopLevelDomain = function (url) { return __awaiter(void 0, void 0, void 0, function () {\n    var host, parts, levels, storageKey, i, i, domain, options, storage, value;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0: return [4 /*yield*/, new CookieStorage().isEnabled()];\n            case 1:\n                if (!(_a.sent()) || (!url && typeof location === 'undefined')) {\n                    return [2 /*return*/, ''];\n                }\n                host = url !== null && url !== void 0 ? url : location.hostname;\n                parts = host.split('.');\n                levels = [];\n                storageKey = 'AMP_TLDTEST';\n                for (i = parts.length - 2; i >= 0; --i) {\n                    levels.push(parts.slice(i).join('.'));\n                }\n                i = 0;\n                _a.label = 2;\n            case 2:\n                if (!(i < levels.length)) return [3 /*break*/, 7];\n                domain = levels[i];\n                options = { domain: '.' + domain };\n                storage = new CookieStorage(options);\n                return [4 /*yield*/, storage.set(storageKey, 1)];\n            case 3:\n                _a.sent();\n                return [4 /*yield*/, storage.get(storageKey)];\n            case 4:\n                value = _a.sent();\n                if (!value) return [3 /*break*/, 6];\n                return [4 /*yield*/, storage.remove(storageKey)];\n            case 5:\n                _a.sent();\n                return [2 /*return*/, '.' + domain];\n            case 6:\n                i++;\n                return [3 /*break*/, 2];\n            case 7: return [2 /*return*/, ''];\n        }\n    });\n}); };\n//# sourceMappingURL=config.js.map","export var UTM_CAMPAIGN = 'utm_campaign';\nexport var UTM_CONTENT = 'utm_content';\nexport var UTM_ID = 'utm_id';\nexport var UTM_MEDIUM = 'utm_medium';\nexport var UTM_SOURCE = 'utm_source';\nexport var UTM_TERM = 'utm_term';\nexport var DCLID = 'dclid';\nexport var FBCLID = 'fbclid';\nexport var GBRAID = 'gbraid';\nexport var GCLID = 'gclid';\nexport var KO_CLICK_ID = 'ko_click_id';\nexport var LI_FAT_ID = 'li_fat_id';\nexport var MSCLKID = 'msclkid';\nexport var RDT_CID = 'rtd_cid';\nexport var TTCLID = 'ttclid';\nexport var TWCLID = 'twclid';\nexport var WBRAID = 'wbraid';\nexport var EMPTY_VALUE = 'EMPTY';\nexport var BASE_CAMPAIGN = {\n    utm_campaign: undefined,\n    utm_content: undefined,\n    utm_id: undefined,\n    utm_medium: undefined,\n    utm_source: undefined,\n    utm_term: undefined,\n    referrer: undefined,\n    referring_domain: undefined,\n    dclid: undefined,\n    gbraid: undefined,\n    gclid: undefined,\n    fbclid: undefined,\n    ko_click_id: undefined,\n    li_fat_id: undefined,\n    msclkid: undefined,\n    rtd_cid: undefined,\n    ttclid: undefined,\n    twclid: undefined,\n    wbraid: undefined,\n};\nexport var MKTG = 'MKTG';\n//# sourceMappingURL=constants.js.map","import { __assign, __awaiter, __generator } from \"tslib\";\nimport { getQueryParams } from '../query-params';\nimport { UTM_CAMPAIGN, UTM_CONTENT, UTM_MEDIUM, UTM_SOURCE, UTM_TERM, GCLID, FBCLID, BASE_CAMPAIGN, DCLID, MSCLKID, RDT_CID, TWCLID, TTCLID, KO_CLICK_ID, LI_FAT_ID, GBRAID, WBRAID, UTM_ID, } from './constants';\nvar CampaignParser = /** @class */ (function () {\n    function CampaignParser() {\n    }\n    CampaignParser.prototype.parse = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, __assign(__assign(__assign(__assign({}, BASE_CAMPAIGN), this.getUtmParam()), this.getReferrer()), this.getClickIds())];\n            });\n        });\n    };\n    CampaignParser.prototype.getUtmParam = function () {\n        var params = getQueryParams();\n        var utmCampaign = params[UTM_CAMPAIGN];\n        var utmContent = params[UTM_CONTENT];\n        var utmId = params[UTM_ID];\n        var utmMedium = params[UTM_MEDIUM];\n        var utmSource = params[UTM_SOURCE];\n        var utmTerm = params[UTM_TERM];\n        return {\n            utm_campaign: utmCampaign,\n            utm_content: utmContent,\n            utm_id: utmId,\n            utm_medium: utmMedium,\n            utm_source: utmSource,\n            utm_term: utmTerm,\n        };\n    };\n    CampaignParser.prototype.getReferrer = function () {\n        var _a, _b;\n        var data = {\n            referrer: undefined,\n            referring_domain: undefined,\n        };\n        try {\n            data.referrer = document.referrer || undefined;\n            data.referring_domain = (_b = (_a = data.referrer) === null || _a === void 0 ? void 0 : _a.split('/')[2]) !== null && _b !== void 0 ? _b : undefined;\n        }\n        catch (_c) {\n            // nothing to track\n        }\n        return data;\n    };\n    CampaignParser.prototype.getClickIds = function () {\n        var _a;\n        var params = getQueryParams();\n        return _a = {},\n            _a[DCLID] = params[DCLID],\n            _a[FBCLID] = params[FBCLID],\n            _a[GBRAID] = params[GBRAID],\n            _a[GCLID] = params[GCLID],\n            _a[KO_CLICK_ID] = params[KO_CLICK_ID],\n            _a[LI_FAT_ID] = params[LI_FAT_ID],\n            _a[MSCLKID] = params[MSCLKID],\n            _a[RDT_CID] = params[RDT_CID],\n            _a[TTCLID] = params[TTCLID],\n            _a[TWCLID] = params[TWCLID],\n            _a[WBRAID] = params[WBRAID],\n            _a;\n    };\n    return CampaignParser;\n}());\nexport { CampaignParser };\n//# sourceMappingURL=campaign-parser.js.map","import { __assign, __read, __rest } from \"tslib\";\nimport { BASE_CAMPAIGN } from '@amplitude/analytics-client-common';\nimport { AMPLITUDE_PREFIX, createIdentifyEvent, Identify } from '@amplitude/analytics-core';\nexport var getStorageKey = function (apiKey, postKey, limit) {\n    if (postKey === void 0) { postKey = ''; }\n    if (limit === void 0) { limit = 10; }\n    return [AMPLITUDE_PREFIX, postKey, apiKey.substring(0, limit)].filter(Boolean).join('_');\n};\nvar domainWithoutSubdomain = function (domain) {\n    var parts = domain.split('.');\n    if (parts.length <= 2) {\n        return domain;\n    }\n    return parts.slice(parts.length - 2, parts.length).join('.');\n};\nexport var isNewCampaign = function (current, previous, options) {\n    var referrer = current.referrer, referring_domain = current.referring_domain, currentCampaign = __rest(current, [\"referrer\", \"referring_domain\"]);\n    var _a = previous || {}, _previous_referrer = _a.referrer, prevReferringDomain = _a.referring_domain, previousCampaign = __rest(_a, [\"referrer\", \"referring_domain\"]);\n    if (isExcludedReferrer(options.excludeReferrers, current.referring_domain)) {\n        return false;\n    }\n    var hasNewCampaign = JSON.stringify(currentCampaign) !== JSON.stringify(previousCampaign);\n    var hasNewDomain = domainWithoutSubdomain(referring_domain || '') !== domainWithoutSubdomain(prevReferringDomain || '');\n    return !previous || hasNewCampaign || hasNewDomain;\n};\nexport var isExcludedReferrer = function (excludeReferrers, referringDomain) {\n    if (excludeReferrers === void 0) { excludeReferrers = []; }\n    if (referringDomain === void 0) { referringDomain = ''; }\n    return excludeReferrers.some(function (value) {\n        return value instanceof RegExp ? value.test(referringDomain) : value === referringDomain;\n    });\n};\nexport var createCampaignEvent = function (campaign, options) {\n    var campaignParameters = __assign(__assign({}, BASE_CAMPAIGN), campaign);\n    var identifyEvent = Object.entries(campaignParameters).reduce(function (identify, _a) {\n        var _b;\n        var _c = __read(_a, 2), key = _c[0], value = _c[1];\n        identify.setOnce(\"initial_\".concat(key), (_b = value !== null && value !== void 0 ? value : options.initialEmptyValue) !== null && _b !== void 0 ? _b : 'EMPTY');\n        if (value) {\n            return identify.set(key, value);\n        }\n        return identify.unset(key);\n    }, new Identify());\n    return createIdentifyEvent(identifyEvent);\n};\nexport var getDefaultExcludedReferrers = function (cookieDomain) {\n    var domain = cookieDomain;\n    if (domain) {\n        if (domain.startsWith('.')) {\n            domain = domain.substring(1);\n        }\n        return [new RegExp(\"\".concat(domain.replace('.', '\\\\.'), \"$\"))];\n    }\n    return [];\n};\n//# sourceMappingURL=helpers.js.map","import { __assign, __awaiter, __generator, __read } from \"tslib\";\nimport { CampaignParser } from '@amplitude/analytics-client-common';\nimport { createCampaignEvent, getDefaultExcludedReferrers, getStorageKey, isNewCampaign } from './helpers';\nexport var webAttributionPlugin = function (options) {\n    var _this = this;\n    if (options === void 0) { options = {}; }\n    var plugin = {\n        name: '@amplitude/plugin-web-attribution-browser',\n        type: 'before',\n        setup: function (config, amplitude) {\n            var _a;\n            return __awaiter(this, void 0, void 0, function () {\n                var pluginConfig, storage, storageKey, _b, currentCampaign, previousCampaign, campaignEvent;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            pluginConfig = __assign({ initialEmptyValue: 'EMPTY', resetSessionOnNewCampaign: false, excludeReferrers: getDefaultExcludedReferrers((_a = config.cookieOptions) === null || _a === void 0 ? void 0 : _a.domain) }, options);\n                            config.loggerProvider.log('Installing @amplitude/plugin-web-attribution-browser.');\n                            storage = config.cookieStorage;\n                            storageKey = getStorageKey(config.apiKey, 'MKTG');\n                            return [4 /*yield*/, Promise.all([\n                                    new CampaignParser().parse(),\n                                    storage.get(storageKey),\n                                ])];\n                        case 1:\n                            _b = __read.apply(void 0, [_c.sent(), 2]), currentCampaign = _b[0], previousCampaign = _b[1];\n                            if (isNewCampaign(currentCampaign, previousCampaign, pluginConfig)) {\n                                if (pluginConfig.resetSessionOnNewCampaign) {\n                                    amplitude.setSessionId(Date.now());\n                                    config.loggerProvider.log('Created a new session for new campaign.');\n                                }\n                                config.loggerProvider.log('Tracking attribution.');\n                                campaignEvent = createCampaignEvent(currentCampaign, pluginConfig);\n                                amplitude.track(campaignEvent);\n                                void storage.set(storageKey, currentCampaign);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        execute: function (event) { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\n            return [2 /*return*/, event];\n        }); }); },\n    };\n    return plugin;\n};\n//# sourceMappingURL=web-attribution.js.map","export var omitUndefined = function (input) {\n    var obj = {};\n    for (var key in input) {\n        var val = input[key];\n        if (val) {\n            obj[key] = val;\n        }\n    }\n    return obj;\n};\n//# sourceMappingURL=utils.js.map","import { __assign, __awaiter, __generator, __read, __spreadArray } from \"tslib\";\nimport { CampaignParser, getGlobalScope } from '@amplitude/analytics-client-common';\nimport { IdentifyOperation, } from '@amplitude/analytics-types';\nimport { BASE_CAMPAIGN } from '@amplitude/analytics-client-common';\nimport { omitUndefined } from './utils';\nexport var pageViewTrackingPlugin = function (options) {\n    if (options === void 0) { options = {}; }\n    var amplitude;\n    var globalScope = getGlobalScope();\n    var loggerProvider = undefined;\n    var pushState;\n    var createPageViewEvent = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var _a;\n        var _b;\n        var _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    _b = {\n                        event_type: (_c = options.eventType) !== null && _c !== void 0 ? _c : '[Amplitude] Page Viewed'\n                    };\n                    _a = [{}];\n                    return [4 /*yield*/, getCampaignParams()];\n                case 1: return [2 /*return*/, (_b.event_properties = __assign.apply(void 0, [__assign.apply(void 0, _a.concat([(_d.sent())])), { '[Amplitude] Page Domain': \n                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.hostname) || '', '[Amplitude] Page Location': \n                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.href) || '', '[Amplitude] Page Path': \n                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.pathname) || '', '[Amplitude] Page Title': /* istanbul ignore next */ (typeof document !== 'undefined' && document.title) || '', '[Amplitude] Page URL': \n                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.href.split('?')[0]) || '' }]),\n                        _b)];\n            }\n        });\n    }); };\n    var shouldTrackOnPageLoad = function () {\n        return typeof options.trackOn === 'undefined' || (typeof options.trackOn === 'function' && options.trackOn());\n    };\n    /* istanbul ignore next */\n    var previousURL = typeof location !== 'undefined' ? location.href : null;\n    var trackHistoryPageView = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var newURL, shouldTrackPageView, _a, _b, _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    newURL = location.href;\n                    shouldTrackPageView = shouldTrackHistoryPageView(options.trackHistoryChanges, newURL, previousURL || '') && shouldTrackOnPageLoad();\n                    // Note: Update `previousURL` in the same clock tick as `shouldTrackHistoryPageView()`\n                    // This was previously done after `amplitude?.track(await createPageViewEvent());` and\n                    // causes a concurrency issue where app triggers `pushState` twice with the same URL target\n                    // but `previousURL` is only updated after the second `pushState` producing two page viewed events\n                    previousURL = newURL;\n                    if (!shouldTrackPageView) return [3 /*break*/, 4];\n                    /* istanbul ignore next */\n                    loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.log('Tracking page view event');\n                    if (!(amplitude === null || amplitude === void 0)) return [3 /*break*/, 1];\n                    _a = void 0;\n                    return [3 /*break*/, 3];\n                case 1:\n                    _c = (_b = amplitude).track;\n                    return [4 /*yield*/, createPageViewEvent()];\n                case 2:\n                    _a = _c.apply(_b, [_d.sent()]);\n                    _d.label = 3;\n                case 3:\n                    _a;\n                    _d.label = 4;\n                case 4: return [2 /*return*/];\n            }\n        });\n    }); };\n    /* istanbul ignore next */\n    var trackHistoryPageViewWrapper = function () {\n        void trackHistoryPageView();\n    };\n    var plugin = {\n        name: '@amplitude/plugin-page-view-tracking-browser',\n        type: 'enrichment',\n        setup: function (config, client) { return __awaiter(void 0, void 0, void 0, function () {\n            var _a, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        amplitude = client;\n                        loggerProvider = config.loggerProvider;\n                        loggerProvider.log('Installing @amplitude/plugin-page-view-tracking-browser');\n                        if (globalScope) {\n                            globalScope.addEventListener('popstate', trackHistoryPageViewWrapper);\n                            // Save reference to original push state, to be used in teardown\n                            // eslint-disable-next-line @typescript-eslint/unbound-method\n                            pushState = globalScope.history.pushState;\n                            /* istanbul ignore next */\n                            // There is no global browser listener for changes to history, so we have\n                            // to modify pushState directly.\n                            // https://stackoverflow.com/a/64927639\n                            // eslint-disable-next-line @typescript-eslint/unbound-method\n                            globalScope.history.pushState = new Proxy(globalScope.history.pushState, {\n                                apply: function (target, thisArg, _a) {\n                                    var _b = __read(_a, 3), state = _b[0], unused = _b[1], url = _b[2];\n                                    target.apply(thisArg, [state, unused, url]);\n                                    void trackHistoryPageView();\n                                },\n                            });\n                        }\n                        if (!shouldTrackOnPageLoad()) return [3 /*break*/, 2];\n                        loggerProvider.log('Tracking page view event');\n                        _b = (_a = amplitude).track;\n                        return [4 /*yield*/, createPageViewEvent()];\n                    case 1:\n                        _b.apply(_a, [_c.sent()]);\n                        _c.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        }); },\n        execute: function (event) { return __awaiter(void 0, void 0, void 0, function () {\n            var pageViewEvent;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!(options.trackOn === 'attribution' && isCampaignEvent(event))) return [3 /*break*/, 2];\n                        /* istanbul ignore next */ // loggerProvider should be defined by the time execute is invoked\n                        loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.log('Enriching campaign event to page view event with campaign parameters');\n                        return [4 /*yield*/, createPageViewEvent()];\n                    case 1:\n                        pageViewEvent = _a.sent();\n                        event.event_type = pageViewEvent.event_type;\n                        event.event_properties = __assign(__assign({}, event.event_properties), pageViewEvent.event_properties);\n                        _a.label = 2;\n                    case 2: return [2 /*return*/, event];\n                }\n            });\n        }); },\n        teardown: function () { return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (globalScope) {\n                    globalScope.removeEventListener('popstate', trackHistoryPageViewWrapper);\n                    if (pushState) {\n                        globalScope.history.pushState = pushState;\n                    }\n                }\n                return [2 /*return*/];\n            });\n        }); },\n    };\n    return plugin;\n};\nvar getCampaignParams = function () { return __awaiter(void 0, void 0, void 0, function () { var _a; return __generator(this, function (_b) {\n    switch (_b.label) {\n        case 0:\n            _a = omitUndefined;\n            return [4 /*yield*/, new CampaignParser().parse()];\n        case 1: return [2 /*return*/, _a.apply(void 0, [_b.sent()])];\n    }\n}); }); };\nvar isCampaignEvent = function (event) {\n    if (event.event_type === '$identify' && event.user_properties) {\n        var properties = event.user_properties;\n        var $set = properties[IdentifyOperation.SET] || {};\n        var $unset = properties[IdentifyOperation.UNSET] || {};\n        var userProperties_1 = __spreadArray(__spreadArray([], __read(Object.keys($set)), false), __read(Object.keys($unset)), false);\n        return Object.keys(BASE_CAMPAIGN).every(function (value) { return userProperties_1.includes(value); });\n    }\n    return false;\n};\nexport var shouldTrackHistoryPageView = function (trackingOption, newURL, oldURL) {\n    switch (trackingOption) {\n        case 'pathOnly':\n            return newURL.split('?')[0] !== oldURL.split('?')[0];\n        default:\n            return newURL !== oldURL;\n    }\n};\n//# sourceMappingURL=page-view-tracking.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { DEFAULT_FORM_START_EVENT, DEFAULT_FORM_SUBMIT_EVENT, FORM_ID, FORM_NAME, FORM_DESTINATION, } from '../constants';\nexport var formInteractionTracking = function () {\n    var observer;\n    var eventListeners = [];\n    var addEventListener = function (element, type, handler) {\n        element.addEventListener(type, handler);\n        eventListeners.push({\n            element: element,\n            type: type,\n            handler: handler,\n        });\n    };\n    var removeClickListeners = function () {\n        eventListeners.forEach(function (_a) {\n            var element = _a.element, type = _a.type, handler = _a.handler;\n            /* istanbul ignore next */\n            element === null || element === void 0 ? void 0 : element.removeEventListener(type, handler);\n        });\n        eventListeners = [];\n    };\n    var name = '@amplitude/plugin-form-interaction-tracking-browser';\n    var type = 'enrichment';\n    var setup = function (config, amplitude) { return __awaiter(void 0, void 0, void 0, function () {\n        var addFormInteractionListener, forms;\n        return __generator(this, function (_a) {\n            /* istanbul ignore if */\n            if (!amplitude) {\n                // TODO: Add required minimum version of @amplitude/analytics-browser\n                config.loggerProvider.warn('Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.');\n                return [2 /*return*/];\n            }\n            /* istanbul ignore if */\n            if (typeof document === 'undefined') {\n                return [2 /*return*/];\n            }\n            addFormInteractionListener = function (form) {\n                var hasFormChanged = false;\n                addEventListener(form, 'change', function () {\n                    var _a;\n                    if (!hasFormChanged) {\n                        amplitude.track(DEFAULT_FORM_START_EVENT, (_a = {},\n                            _a[FORM_ID] = form.id,\n                            _a[FORM_NAME] = form.name,\n                            _a[FORM_DESTINATION] = form.action,\n                            _a));\n                    }\n                    hasFormChanged = true;\n                });\n                addEventListener(form, 'submit', function () {\n                    var _a, _b;\n                    if (!hasFormChanged) {\n                        amplitude.track(DEFAULT_FORM_START_EVENT, (_a = {},\n                            _a[FORM_ID] = form.id,\n                            _a[FORM_NAME] = form.name,\n                            _a[FORM_DESTINATION] = form.action,\n                            _a));\n                    }\n                    amplitude.track(DEFAULT_FORM_SUBMIT_EVENT, (_b = {},\n                        _b[FORM_ID] = form.id,\n                        _b[FORM_NAME] = form.name,\n                        _b[FORM_DESTINATION] = form.action,\n                        _b));\n                    hasFormChanged = false;\n                });\n            };\n            forms = Array.from(document.getElementsByTagName('form'));\n            forms.forEach(addFormInteractionListener);\n            // Adds listener to anchor tags added after initial load\n            /* istanbul ignore else */\n            if (typeof MutationObserver !== 'undefined') {\n                observer = new MutationObserver(function (mutations) {\n                    mutations.forEach(function (mutation) {\n                        mutation.addedNodes.forEach(function (node) {\n                            if (node.nodeName === 'FORM') {\n                                addFormInteractionListener(node);\n                            }\n                            if ('querySelectorAll' in node && typeof node.querySelectorAll === 'function') {\n                                Array.from(node.querySelectorAll('form')).map(addFormInteractionListener);\n                            }\n                        });\n                    });\n                });\n                observer.observe(document.body, {\n                    subtree: true,\n                    childList: true,\n                });\n            }\n            return [2 /*return*/];\n        });\n    }); };\n    var execute = function (event) { return __awaiter(void 0, void 0, void 0, function () { return __generator(this, function (_a) {\n        return [2 /*return*/, event];\n    }); }); };\n    var teardown = function () { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            observer === null || observer === void 0 ? void 0 : observer.disconnect();\n            removeClickListeners();\n            return [2 /*return*/];\n        });\n    }); };\n    return {\n        name: name,\n        type: type,\n        setup: setup,\n        execute: execute,\n        teardown: teardown,\n    };\n};\n//# sourceMappingURL=form-interaction-tracking.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { DEFAULT_FILE_DOWNLOAD_EVENT, FILE_EXTENSION, FILE_NAME, LINK_ID, LINK_TEXT, LINK_URL } from '../constants';\nexport var fileDownloadTracking = function () {\n    var observer;\n    var eventListeners = [];\n    var addEventListener = function (element, type, handler) {\n        element.addEventListener(type, handler);\n        eventListeners.push({\n            element: element,\n            type: type,\n            handler: handler,\n        });\n    };\n    var removeClickListeners = function () {\n        eventListeners.forEach(function (_a) {\n            var element = _a.element, type = _a.type, handler = _a.handler;\n            /* istanbul ignore next */\n            element === null || element === void 0 ? void 0 : element.removeEventListener(type, handler);\n        });\n        eventListeners = [];\n    };\n    var name = '@amplitude/plugin-file-download-tracking-browser';\n    var type = 'enrichment';\n    var setup = function (config, amplitude) { return __awaiter(void 0, void 0, void 0, function () {\n        var addFileDownloadListener, ext, links;\n        return __generator(this, function (_a) {\n            /* istanbul ignore if */\n            if (!amplitude) {\n                // TODO: Add required minimum version of @amplitude/analytics-browser\n                config.loggerProvider.warn('File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.');\n                return [2 /*return*/];\n            }\n            /* istanbul ignore if */\n            if (typeof document === 'undefined') {\n                return [2 /*return*/];\n            }\n            addFileDownloadListener = function (a) {\n                var url;\n                try {\n                    // eslint-disable-next-line no-restricted-globals\n                    url = new URL(a.href, window.location.href);\n                }\n                catch (_a) {\n                    /* istanbul ignore next */\n                    return;\n                }\n                var result = ext.exec(url.href);\n                var fileExtension = result === null || result === void 0 ? void 0 : result[1];\n                if (fileExtension) {\n                    addEventListener(a, 'click', function () {\n                        var _a;\n                        if (fileExtension) {\n                            amplitude.track(DEFAULT_FILE_DOWNLOAD_EVENT, (_a = {},\n                                _a[FILE_EXTENSION] = fileExtension,\n                                _a[FILE_NAME] = url.pathname,\n                                _a[LINK_ID] = a.id,\n                                _a[LINK_TEXT] = a.text,\n                                _a[LINK_URL] = a.href,\n                                _a));\n                        }\n                    });\n                }\n            };\n            ext = /\\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)$/;\n            links = Array.from(document.getElementsByTagName('a'));\n            links.forEach(addFileDownloadListener);\n            // Adds listener to anchor tags added after initial load\n            /* istanbul ignore else */\n            if (typeof MutationObserver !== 'undefined') {\n                observer = new MutationObserver(function (mutations) {\n                    mutations.forEach(function (mutation) {\n                        mutation.addedNodes.forEach(function (node) {\n                            if (node.nodeName === 'A') {\n                                addFileDownloadListener(node);\n                            }\n                            if ('querySelectorAll' in node && typeof node.querySelectorAll === 'function') {\n                                Array.from(node.querySelectorAll('a')).map(addFileDownloadListener);\n                            }\n                        });\n                    });\n                });\n                observer.observe(document.body, {\n                    subtree: true,\n                    childList: true,\n                });\n            }\n            return [2 /*return*/];\n        });\n    }); };\n    var execute = function (event) { return __awaiter(void 0, void 0, void 0, function () { return __generator(this, function (_a) {\n        return [2 /*return*/, event];\n    }); }); };\n    var teardown = function () { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            observer === null || observer === void 0 ? void 0 : observer.disconnect();\n            removeClickListeners();\n            return [2 /*return*/];\n        });\n    }); };\n    return {\n        name: name,\n        type: type,\n        setup: setup,\n        execute: execute,\n        teardown: teardown,\n    };\n};\n//# sourceMappingURL=file-download-tracking.js.map","import { isSessionTrackingEnabled, isFileDownloadTrackingEnabled, isFormInteractionTrackingEnabled, isPageViewTrackingEnabled, } from '@amplitude/analytics-client-common';\nimport { LogLevel } from '@amplitude/analytics-types';\nvar notified = false;\nexport var detNotify = function (config) {\n    if (notified) {\n        return;\n    }\n    var enabledTracking = [\n        isPageViewTrackingEnabled(config.defaultTracking) ? 'Page Views' : '',\n        isSessionTrackingEnabled(config.defaultTracking) ? 'Sessions' : '',\n        isFileDownloadTrackingEnabled(config.defaultTracking) ? 'File Downloads' : '',\n        isFormInteractionTrackingEnabled(config.defaultTracking) ? 'Form Interactions' : '',\n    ].filter(Boolean);\n    var enabledTrackingString = enabledTracking.join(', ');\n    if (enabledTracking.length) {\n        var message = \"Your Amplitude instance is configured to track \".concat(enabledTrackingString, \". Visit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.\");\n        config.loggerProvider.log(message);\n        /* istanbul ignore if */\n        if (config.logLevel < LogLevel.Verbose) {\n            console.log(message);\n        }\n    }\n    notified = true;\n};\n/**\n * @private\n * This function is meant for testing purposes only\n */\nexport var resetNotify = function () {\n    notified = false;\n};\n//# sourceMappingURL=det-notification.js.map","import { __assign, __awaiter, __extends, __generator } from \"tslib\";\nimport { AmplitudeCore, Destination, Identify, returnWrapper, Revenue, UUID } from '@amplitude/analytics-core';\nimport { getAnalyticsConnector, getAttributionTrackingConfig, getPageViewTrackingConfig, IdentityEventSender, isAttributionTrackingEnabled, isSessionTrackingEnabled, isFileDownloadTrackingEnabled, isFormInteractionTrackingEnabled, setConnectorDeviceId, setConnectorUserId, } from '@amplitude/analytics-client-common';\nimport { convertProxyObjectToRealObject, isInstanceProxy } from './utils/snippet-helper';\nimport { Context } from './plugins/context';\nimport { useBrowserConfig, createTransport } from './config';\nimport { webAttributionPlugin } from '@amplitude/plugin-web-attribution-browser';\nimport { pageViewTrackingPlugin } from '@amplitude/plugin-page-view-tracking-browser';\nimport { formInteractionTracking } from './plugins/form-interaction-tracking';\nimport { fileDownloadTracking } from './plugins/file-download-tracking';\nimport { DEFAULT_SESSION_END_EVENT, DEFAULT_SESSION_START_EVENT } from './constants';\nimport { detNotify } from './det-notification';\nvar AmplitudeBrowser = /** @class */ (function (_super) {\n    __extends(AmplitudeBrowser, _super);\n    function AmplitudeBrowser() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AmplitudeBrowser.prototype.init = function (apiKey, userIdOrOptions, maybeOptions) {\n        if (apiKey === void 0) { apiKey = ''; }\n        var userId;\n        var options;\n        if (arguments.length > 2) {\n            userId = userIdOrOptions;\n            options = maybeOptions;\n        }\n        else {\n            if (typeof userIdOrOptions === 'string') {\n                userId = userIdOrOptions;\n                options = undefined;\n            }\n            else {\n                userId = userIdOrOptions === null || userIdOrOptions === void 0 ? void 0 : userIdOrOptions.userId;\n                options = userIdOrOptions;\n            }\n        }\n        return returnWrapper(this._init(__assign(__assign({}, options), { userId: userId, apiKey: apiKey })));\n    };\n    AmplitudeBrowser.prototype._init = function (options) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var browserOptions, connector, attributionTrackingOptions, webAttribution;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        // Step 1: Block concurrent initialization\n                        if (this.initializing) {\n                            return [2 /*return*/];\n                        }\n                        this.initializing = true;\n                        return [4 /*yield*/, useBrowserConfig(options.apiKey, options, this)];\n                    case 1:\n                        browserOptions = _c.sent();\n                        return [4 /*yield*/, _super.prototype._init.call(this, browserOptions)];\n                    case 2:\n                        _c.sent();\n                        // Step 3: Set session ID\n                        // Priority 1: `options.sessionId`\n                        // Priority 2: last known sessionId from user identity storage\n                        // Default: `Date.now()`\n                        // Session ID is handled differently than device ID and user ID due to session events\n                        this.setSessionId((_b = (_a = options.sessionId) !== null && _a !== void 0 ? _a : this.config.sessionId) !== null && _b !== void 0 ? _b : Date.now());\n                        connector = getAnalyticsConnector(options.instanceName);\n                        connector.identityStore.setIdentity({\n                            userId: this.config.userId,\n                            deviceId: this.config.deviceId,\n                        });\n                        // Step 4: Install plugins\n                        // Do not track any events before this\n                        return [4 /*yield*/, this.add(new Destination()).promise];\n                    case 3:\n                        // Step 4: Install plugins\n                        // Do not track any events before this\n                        _c.sent();\n                        return [4 /*yield*/, this.add(new Context()).promise];\n                    case 4:\n                        _c.sent();\n                        return [4 /*yield*/, this.add(new IdentityEventSender()).promise];\n                    case 5:\n                        _c.sent();\n                        // Notify if DET is enabled\n                        detNotify(this.config);\n                        if (!isFileDownloadTrackingEnabled(this.config.defaultTracking)) return [3 /*break*/, 7];\n                        return [4 /*yield*/, this.add(fileDownloadTracking()).promise];\n                    case 6:\n                        _c.sent();\n                        _c.label = 7;\n                    case 7:\n                        if (!isFormInteractionTrackingEnabled(this.config.defaultTracking)) return [3 /*break*/, 9];\n                        return [4 /*yield*/, this.add(formInteractionTracking()).promise];\n                    case 8:\n                        _c.sent();\n                        _c.label = 9;\n                    case 9:\n                        if (!isAttributionTrackingEnabled(this.config.defaultTracking)) return [3 /*break*/, 11];\n                        attributionTrackingOptions = getAttributionTrackingConfig(this.config);\n                        webAttribution = webAttributionPlugin(attributionTrackingOptions);\n                        return [4 /*yield*/, this.add(webAttribution).promise];\n                    case 10:\n                        _c.sent();\n                        _c.label = 11;\n                    case 11: \n                    // Add page view plugin\n                    return [4 /*yield*/, this.add(pageViewTrackingPlugin(getPageViewTrackingConfig(this.config))).promise];\n                    case 12:\n                        // Add page view plugin\n                        _c.sent();\n                        this.initializing = false;\n                        // Step 6: Run queued dispatch functions\n                        return [4 /*yield*/, this.runQueuedFunctions('dispatchQ')];\n                    case 13:\n                        // Step 6: Run queued dispatch functions\n                        _c.sent();\n                        // Step 7: Add the event receiver after running remaining queued functions.\n                        connector.eventBridge.setEventReceiver(function (event) {\n                            void _this.track(event.eventType, event.eventProperties);\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AmplitudeBrowser.prototype.getUserId = function () {\n        var _a;\n        return (_a = this.config) === null || _a === void 0 ? void 0 : _a.userId;\n    };\n    AmplitudeBrowser.prototype.setUserId = function (userId) {\n        if (!this.config) {\n            this.q.push(this.setUserId.bind(this, userId));\n            return;\n        }\n        if (userId !== this.config.userId || userId === undefined) {\n            this.config.userId = userId;\n            setConnectorUserId(userId, this.config.instanceName);\n        }\n    };\n    AmplitudeBrowser.prototype.getDeviceId = function () {\n        var _a;\n        return (_a = this.config) === null || _a === void 0 ? void 0 : _a.deviceId;\n    };\n    AmplitudeBrowser.prototype.setDeviceId = function (deviceId) {\n        if (!this.config) {\n            this.q.push(this.setDeviceId.bind(this, deviceId));\n            return;\n        }\n        this.config.deviceId = deviceId;\n        setConnectorDeviceId(deviceId, this.config.instanceName);\n    };\n    AmplitudeBrowser.prototype.reset = function () {\n        this.setDeviceId(UUID());\n        this.setUserId(undefined);\n    };\n    AmplitudeBrowser.prototype.getSessionId = function () {\n        var _a;\n        return (_a = this.config) === null || _a === void 0 ? void 0 : _a.sessionId;\n    };\n    AmplitudeBrowser.prototype.setSessionId = function (sessionId) {\n        var _a;\n        if (!this.config) {\n            this.q.push(this.setSessionId.bind(this, sessionId));\n            return;\n        }\n        // Prevents starting a new session with the same session ID\n        if (sessionId === this.config.sessionId) {\n            return;\n        }\n        var previousSessionId = this.getSessionId();\n        var lastEventTime = this.config.lastEventTime;\n        var lastEventId = (_a = this.config.lastEventId) !== null && _a !== void 0 ? _a : -1;\n        this.config.sessionId = sessionId;\n        this.config.lastEventTime = undefined;\n        if (isSessionTrackingEnabled(this.config.defaultTracking)) {\n            if (previousSessionId && lastEventTime) {\n                this.track(DEFAULT_SESSION_END_EVENT, undefined, {\n                    device_id: this.previousSessionDeviceId,\n                    event_id: ++lastEventId,\n                    session_id: previousSessionId,\n                    time: lastEventTime + 1,\n                    user_id: this.previousSessionUserId,\n                });\n            }\n            this.config.lastEventTime = this.config.sessionId;\n            this.track(DEFAULT_SESSION_START_EVENT, undefined, {\n                event_id: ++lastEventId,\n                session_id: this.config.sessionId,\n                time: this.config.lastEventTime,\n            });\n        }\n        this.previousSessionDeviceId = this.config.deviceId;\n        this.previousSessionUserId = this.config.userId;\n    };\n    AmplitudeBrowser.prototype.extendSession = function () {\n        if (!this.config) {\n            this.q.push(this.extendSession.bind(this));\n            return;\n        }\n        this.config.lastEventTime = Date.now();\n    };\n    AmplitudeBrowser.prototype.setTransport = function (transport) {\n        if (!this.config) {\n            this.q.push(this.setTransport.bind(this, transport));\n            return;\n        }\n        this.config.transportProvider = createTransport(transport);\n    };\n    AmplitudeBrowser.prototype.identify = function (identify, eventOptions) {\n        if (isInstanceProxy(identify)) {\n            var queue = identify._q;\n            identify._q = [];\n            identify = convertProxyObjectToRealObject(new Identify(), queue);\n        }\n        if (eventOptions === null || eventOptions === void 0 ? void 0 : eventOptions.user_id) {\n            this.setUserId(eventOptions.user_id);\n        }\n        if (eventOptions === null || eventOptions === void 0 ? void 0 : eventOptions.device_id) {\n            this.setDeviceId(eventOptions.device_id);\n        }\n        return _super.prototype.identify.call(this, identify, eventOptions);\n    };\n    AmplitudeBrowser.prototype.groupIdentify = function (groupType, groupName, identify, eventOptions) {\n        if (isInstanceProxy(identify)) {\n            var queue = identify._q;\n            identify._q = [];\n            identify = convertProxyObjectToRealObject(new Identify(), queue);\n        }\n        return _super.prototype.groupIdentify.call(this, groupType, groupName, identify, eventOptions);\n    };\n    AmplitudeBrowser.prototype.revenue = function (revenue, eventOptions) {\n        if (isInstanceProxy(revenue)) {\n            var queue = revenue._q;\n            revenue._q = [];\n            revenue = convertProxyObjectToRealObject(new Revenue(), queue);\n        }\n        return _super.prototype.revenue.call(this, revenue, eventOptions);\n    };\n    AmplitudeBrowser.prototype.process = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var currentTime, lastEventTime, timeSinceLastEvent;\n            return __generator(this, function (_a) {\n                currentTime = Date.now();\n                lastEventTime = this.config.lastEventTime || Date.now();\n                timeSinceLastEvent = currentTime - lastEventTime;\n                if (event.event_type !== DEFAULT_SESSION_START_EVENT &&\n                    event.event_type !== DEFAULT_SESSION_END_EVENT &&\n                    (!event.session_id || event.session_id === this.getSessionId()) &&\n                    timeSinceLastEvent > this.config.sessionTimeout) {\n                    this.setSessionId(currentTime);\n                }\n                return [2 /*return*/, _super.prototype.process.call(this, event)];\n            });\n        });\n    };\n    return AmplitudeBrowser;\n}(AmplitudeCore));\nexport { AmplitudeBrowser };\n//# sourceMappingURL=browser-client.js.map","/* eslint-disable @typescript-eslint/unbound-method */\nimport client from './browser-client-factory';\nexport { createInstance } from './browser-client-factory';\nexport var add = client.add, extendSession = client.extendSession, flush = client.flush, getDeviceId = client.getDeviceId, getSessionId = client.getSessionId, getUserId = client.getUserId, groupIdentify = client.groupIdentify, identify = client.identify, init = client.init, logEvent = client.logEvent, remove = client.remove, reset = client.reset, revenue = client.revenue, setDeviceId = client.setDeviceId, setGroup = client.setGroup, setOptOut = client.setOptOut, setSessionId = client.setSessionId, setTransport = client.setTransport, setUserId = client.setUserId, track = client.track;\nexport { runQueuedFunctions } from './utils/snippet-helper';\nexport { Revenue, Identify } from '@amplitude/analytics-core';\nimport * as Types_1 from '@amplitude/analytics-types';\nexport { Types_1 as Types };\n//# sourceMappingURL=index.js.map","import * as amplitude from '@amplitude/analytics-browser';\nimport Tracker from \"./Tracker\";\n\nexport default class Amplitude extends Tracker {\n    constructor(apiKey) {\n        amplitude.init(apiKey, null, {\n            serverZone: 'EU',\n            defaultTracking: {\n                fileDownloads: false,\n                pageViews: true,\n                sessions: true,\n                // disabling form interaction since its not working well with our forms currently.\n                // Need to investigate further.\n                formInteractions: false,\n            },\n        });\n        super();\n    }\n\n    /**\n     * @returns {Promise<unknown>}\n     */\n    track(eventName, properties = {}) {\n        return amplitude.track(eventName, properties).promise;\n    }\n}\n","export default class Tracker {\n    constructor() {}\n\n    /**\n     * @returns {Promise<unknown>}\n     */\n    track(eventName, properties = {}) {}\n}","import Amplitude from './Amplitude.js';\nimport Analytics from \"./Analytics\";\n\n(function () {\n    const apiKey = document.currentScript.getAttribute('data-api-key');\n\n    document.addEventListener(\"DOMContentLoaded\", () => {\n        document.tracker = new Analytics(document, new Amplitude(apiKey))\n    });\n})()\n","class Analytics {\n\n    eventNameAttribute = 'data-event-name';\n    eventNameAttributeOnchange = 'data-event-name-onchange';\n    DOM;\n\n    /**\n     * @var {Tracker}\n     */\n    tracker;\n\n    /**\n     * @param el\n     * @param {Tracker} tracker\n     */\n    constructor(el, tracker) {\n        this.DOM = { el: el };\n        this.tracker = tracker;\n\n        this.init();\n    }\n\n    init() {\n        this.DOM.clickableElements = this.DOM.el.querySelectorAll(`[${this.eventNameAttribute}]`);\n        this.DOM.changeableElements = this.DOM.el.querySelectorAll(`[${this.eventNameAttributeOnchange}]`);\n\n        const urlParams = new URLSearchParams(window.location.search);\n\n        if (urlParams.has('action-ref')) {\n            this.track(urlParams.get('action-ref'));\n\n            // To prevent duplicate tracking, we remove the action-ref from the URL.\n            urlParams.delete('action-ref');\n\n            const urlParamsString = urlParams.toString().trim();\n            window.history.replaceState(null, '',\n              window.location.pathname.concat(urlParamsString.length ? '?'.concat(urlParams.toString()) : '')\n            );\n        }\n\n        this.DOM.clickableElements.forEach((element) => {\n            this.attachClickEvents(element);\n        });\n        this.DOM.changeableElements.forEach((element) => {\n            this.attachChangeEvents(element);\n        });\n    }\n\n    track(eventName, properties = {}) {\n        return this.tracker.track(eventName, properties);\n    }\n\n    handleClick(event, element) {\n        const dataEventName = element.getAttribute(this.eventNameAttribute);\n        const target = element.getAttribute('target');\n        const href = element.getAttribute('href');\n\n        // If redirect is made to different page, we need to wait for the event to be sent.\n        if (target === null && href && href.includes('.')) {\n            event.preventDefault();\n\n            this.track(dataEventName)\n                .then(() => {\n                    document.location.href = href;\n                });\n\n            // Failsafe, in case promise is not resolved.\n            setTimeout(() => {document.location.href = href}, 100);\n        } else {\n            this.track(dataEventName);\n        }\n    }\n\n    handleChange(event, element) {\n        const dataEventName = element.getAttribute(this.eventNameAttributeOnchange);\n        this.track(dataEventName);\n    }\n\n    attachClickEvents(element) {\n        element.addEventListener('click', (event) => {\n            this.handleClick(event, element);\n        });\n    }\n\n    attachChangeEvents(element) {\n        element.addEventListener('change', (event) => {\n            this.handleChange(event, element);\n        });\n    }\n}\n\nexport default Analytics;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}